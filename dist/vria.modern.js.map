{"version":3,"file":"vria.modern.js","sources":["../src/lib/super-hands/super-hands.js","../src/functions/applyFilters.js","../src/actions/core/visConfigCompiled.js","../src/utils/log.js","../src/actions/core/filterData.js","../src/actions/core/setCallbacks.js","../src/actions/core/markSelected.js","../src/actions/core/setSelection.js","../src/actions/core/setFilters.js","../src/actions/core/setAdditionalFilters.js","../src/actions/core/setOptions.js","../src/actions/actionTypes.js","../src/actions/index.js","../src/reducer/reducer.js","../src/reducer/initialState.js","../src/reducer/DispatchContext.js","../src/grammar/parseDataset.js","../src/grammar/validateVisConfig.js","../src/grammar/compileVisConfig.js","../src/components/core/Legend/GradientLegend.js","../src/components/core/Legend/SymbolLegend.js","../src/components/core/Legend/index.js","../src/components/core/Axes/axes.js","../src/components/core/Axes/index.js","../src/components/core/AxisFilters/index.js","../src/components/core/Marks/index.js","../src/components/core/View/index.js","../src/components/core/index.js","../src/components/scene/Camera.js","../src/components/scene/Controllers.js","../src/components/scene/setSceneAttributes.js","../src/index.js"],"sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"===typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"===typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\r\n\r\n/* global AFRAME */\r\n/* global THREE */\r\n\r\nif (typeof AFRAME === 'undefined') {\r\n  throw new Error('Component attempted to register before AFRAME was available.');\r\n}\r\n\r\nrequire('./systems/super-hands-system.js');\r\nrequire('./reaction_components/hoverable.js');\r\nrequire('./reaction_components/grabbable.js');\r\nrequire('./reaction_components/stretchable.js');\r\nrequire('./reaction_components/drag-droppable.js');\r\nrequire('./reaction_components/draggable.js');\r\nrequire('./reaction_components/droppable.js');\r\nrequire('./reaction_components/clickable.js');\r\n\r\n/**\r\n * Super Hands component for A-Frame.\r\n */\r\nAFRAME.registerComponent('super-hands', {\r\n  schema: {\r\n    colliderEvent: { default: 'hit' },\r\n    colliderEventProperty: { default: 'el' },\r\n    colliderEndEvent: { default: 'hitend' },\r\n    colliderEndEventProperty: { default: 'el' },\r\n    grabStartButtons: {\r\n      default: ['gripdown', 'trackpaddown', 'triggerdown', 'gripclose', 'abuttondown', 'bbuttondown', 'xbuttondown', 'ybuttondown', 'pointup', 'thumbup', 'pointingstart', 'pistolstart', 'thumbstickdown', 'mousedown', 'touchstart']\r\n    },\r\n    grabEndButtons: {\r\n      default: ['gripup', 'trackpadup', 'triggerup', 'gripopen', 'abuttonup', 'bbuttonup', 'xbuttonup', 'ybuttonup', 'pointdown', 'thumbdown', 'pointingend', 'pistolend', 'thumbstickup', 'mouseup', 'touchend']\r\n    },\r\n    stretchStartButtons: {\r\n      default: ['gripdown', 'trackpaddown', 'triggerdown', 'gripclose', 'abuttondown', 'bbuttondown', 'xbuttondown', 'ybuttondown', 'pointup', 'thumbup', 'pointingstart', 'pistolstart', 'thumbstickdown', 'mousedown', 'touchstart']\r\n    },\r\n    stretchEndButtons: {\r\n      default: ['gripup', 'trackpadup', 'triggerup', 'gripopen', 'abuttonup', 'bbuttonup', 'xbuttonup', 'ybuttonup', 'pointdown', 'thumbdown', 'pointingend', 'pistolend', 'thumbstickup', 'mouseup', 'touchend']\r\n    },\r\n    dragDropStartButtons: {\r\n      default: ['gripdown', 'trackpaddown', 'triggerdown', 'gripclose', 'abuttondown', 'bbuttondown', 'xbuttondown', 'ybuttondown', 'pointup', 'thumbup', 'pointingstart', 'pistolstart', 'thumbstickdown', 'mousedown', 'touchstart']\r\n    },\r\n    dragDropEndButtons: {\r\n      default: ['gripup', 'trackpadup', 'triggerup', 'gripopen', 'abuttonup', 'bbuttonup', 'xbuttonup', 'ybuttonup', 'pointdown', 'thumbdown', 'pointingend', 'pistolend', 'thumbstickup', 'mouseup', 'touchend']\r\n    },\r\n    interval: { default: 0 }\r\n  },\r\n\r\n  /**\r\n   * Set if component needs multiple instancing.\r\n   */\r\n  multiple: false,\r\n\r\n  /**\r\n   * Called once when component is attached. Generally for initial setup.\r\n   */\r\n  init: function () {\r\n    // constants\r\n    this.HOVER_EVENT = 'hover-start';\r\n    this.UNHOVER_EVENT = 'hover-end';\r\n    this.GRAB_EVENT = 'grab-start';\r\n    this.UNGRAB_EVENT = 'grab-end';\r\n    this.STRETCH_EVENT = 'stretch-start';\r\n    this.UNSTRETCH_EVENT = 'stretch-end';\r\n    this.DRAG_EVENT = 'drag-start';\r\n    this.UNDRAG_EVENT = 'drag-end';\r\n    this.DRAGOVER_EVENT = 'dragover-start';\r\n    this.UNDRAGOVER_EVENT = 'dragover-end';\r\n    this.DRAGDROP_EVENT = 'drag-drop';\r\n\r\n    // links to other systems/components\r\n    this.otherSuperHand = null;\r\n\r\n    // state tracking - global event handlers (GEH)\r\n    this.gehDragged = new Set();\r\n    this.gehClicking = new Set();\r\n\r\n    // state tracking - reaction components\r\n    this.hoverEls = [];\r\n    this.hoverElsIntersections = [];\r\n    this.prevCheckTime = null;\r\n    this.state = new Map();\r\n    this.dragging = false;\r\n\r\n    this.unHover = this.unHover.bind(this);\r\n    this.unWatch = this.unWatch.bind(this);\r\n    this.onHit = this.onHit.bind(this);\r\n    this.onGrabStartButton = this.onGrabStartButton.bind(this);\r\n    this.onGrabEndButton = this.onGrabEndButton.bind(this);\r\n    this.onStretchStartButton = this.onStretchStartButton.bind(this);\r\n    this.onStretchEndButton = this.onStretchEndButton.bind(this);\r\n    this.onDragDropStartButton = this.onDragDropStartButton.bind(this);\r\n    this.onDragDropEndButton = this.onDragDropEndButton.bind(this);\r\n    this.system.registerMe(this);\r\n  },\r\n\r\n  /**\r\n   * Called when component is attached and when component data changes.\r\n   * Generally modifies the entity based on the data.\r\n   */\r\n  update: function (oldData) {\r\n    this.unRegisterListeners(oldData);\r\n    this.registerListeners();\r\n  },\r\n\r\n  /**\r\n   * Called when a component is removed (e.g., via removeAttribute).\r\n   * Generally undoes all modifications to the entity.\r\n   */\r\n  remove: function () {\r\n    this.system.unregisterMe(this);\r\n    this.unRegisterListeners();\r\n    this.hoverEls.length = 0;\r\n    if (this.state.get(this.HOVER_EVENT)) {\r\n      this._unHover(this.state.get(this.HOVER_EVENT));\r\n    }\r\n    this.onGrabEndButton();\r\n    this.onStretchEndButton();\r\n    this.onDragDropEndButton();\r\n  },\r\n  tick: function () {\r\n    // closer objects and objects with no distance come later in list\r\n    function sorter(a, b) {\r\n      const aDist = a.distance === null ? -1 : a.distance;\r\n      const bDist = b.distance === null ? -1 : b.distance;\r\n      if (aDist < bDist) {\r\n        return 1;\r\n      }\r\n      if (bDist < aDist) {\r\n        return -1;\r\n      }\r\n      return 0;\r\n    }\r\n    return function (time) {\r\n      const data = this.data;\r\n      const prevCheckTime = this.prevCheckTime;\r\n      if (prevCheckTime && time - prevCheckTime < data.interval) {\r\n        return;\r\n      }\r\n      this.prevCheckTime = time;\r\n\r\n      let orderChanged = false;\r\n      this.hoverElsIntersections.sort(sorter);\r\n      for (let i = 0; i < this.hoverElsIntersections.length; i++) {\r\n        if (this.hoverEls[i] !== this.hoverElsIntersections[i].object.el) {\r\n          orderChanged = true;\r\n          this.hoverEls[i] = this.hoverElsIntersections[i].object.el;\r\n        }\r\n      }\r\n      if (orderChanged) {\r\n        this.hover();\r\n      }\r\n    };\r\n  }(),\r\n  onGrabStartButton: function (evt) {\r\n    let carried = this.state.get(this.GRAB_EVENT);\r\n    this.dispatchMouseEventAll('mousedown', this.el);\r\n    this.gehClicking = new Set(this.hoverEls);\r\n    if (!carried) {\r\n      carried = this.findTarget(this.GRAB_EVENT, {\r\n        hand: this.el,\r\n        buttonEvent: evt\r\n      });\r\n      if (carried) {\r\n        this.state.set(this.GRAB_EVENT, carried);\r\n        this._unHover(carried);\r\n      }\r\n    }\r\n  },\r\n  onGrabEndButton: function (evt) {\r\n    const clickables = this.hoverEls.filter(h => this.gehClicking.has(h));\r\n    const grabbed = this.state.get(this.GRAB_EVENT);\r\n    const endEvt = { hand: this.el, buttonEvent: evt };\r\n    this.dispatchMouseEventAll('mouseup', this.el);\r\n    for (let i = 0; i < clickables.length; i++) {\r\n      this.dispatchMouseEvent(clickables[i], 'click', this.el);\r\n    }\r\n    this.gehClicking.clear();\r\n    // check if grabbed entity accepts ungrab event\r\n    if (grabbed && !this.emitCancelable(grabbed, this.UNGRAB_EVENT, endEvt)) {\r\n      /* push to top of stack so a drop followed by re-grab gets the same\r\n         target */\r\n      this.promoteHoveredEl(this.state.get(this.GRAB_EVENT));\r\n      this.state.delete(this.GRAB_EVENT);\r\n      this.hover();\r\n    }\r\n  },\r\n  onStretchStartButton: function (evt) {\r\n    let stretched = this.state.get(this.STRETCH_EVENT);\r\n    if (!stretched) {\r\n      stretched = this.findTarget(this.STRETCH_EVENT, {\r\n        hand: this.el,\r\n        buttonEvent: evt\r\n      });\r\n      if (stretched) {\r\n        this.state.set(this.STRETCH_EVENT, stretched);\r\n        this._unHover(stretched);\r\n      }\r\n    }\r\n  },\r\n  onStretchEndButton: function (evt) {\r\n    const stretched = this.state.get(this.STRETCH_EVENT);\r\n    const endEvt = { hand: this.el, buttonEvent: evt\r\n      // check if end event accepted\r\n    };if (stretched && !this.emitCancelable(stretched, this.UNSTRETCH_EVENT, endEvt)) {\r\n      this.promoteHoveredEl(stretched);\r\n      this.state.delete(this.STRETCH_EVENT);\r\n      this.hover();\r\n    }\r\n  },\r\n  onDragDropStartButton: function (evt) {\r\n    let dragged = this.state.get(this.DRAG_EVENT);\r\n    this.dragging = true;\r\n    if (this.hoverEls.length) {\r\n      this.gehDragged = new Set(this.hoverEls);\r\n      this.dispatchMouseEventAll('dragstart', this.el);\r\n    }\r\n    if (!dragged) {\r\n      /* prefer carried so that a drag started after a grab will work\r\n       with carried element rather than a currently intersected drop target.\r\n       fall back to queue in case a drag is initiated independent\r\n       of a grab */\r\n      if (this.state.get(this.GRAB_EVENT) && !this.emitCancelable(this.state.get(this.GRAB_EVENT), this.DRAG_EVENT, { hand: this.el, buttonEvent: evt })) {\r\n        dragged = this.state.get(this.GRAB_EVENT);\r\n      } else {\r\n        dragged = this.findTarget(this.DRAG_EVENT, {\r\n          hand: this.el,\r\n          buttonEvent: evt\r\n        });\r\n      }\r\n      if (dragged) {\r\n        this.state.set(this.DRAG_EVENT, dragged);\r\n        this._unHover(dragged);\r\n      }\r\n    }\r\n  },\r\n  onDragDropEndButton: function (evt) {\r\n    const carried = this.state.get(this.DRAG_EVENT);\r\n    this.dragging = false; // keep _unHover() from activating another droptarget\r\n    this.gehDragged.forEach(carried => {\r\n      this.dispatchMouseEvent(carried, 'dragend', this.el);\r\n      // fire event both ways for all intersected targets\r\n      this.dispatchMouseEventAll('drop', carried, true, true);\r\n      this.dispatchMouseEventAll('dragleave', carried, true, true);\r\n    });\r\n    this.gehDragged.clear();\r\n    if (carried) {\r\n      const ddEvt = {\r\n        hand: this.el,\r\n        dropped: carried,\r\n        on: null,\r\n        buttonEvent: evt\r\n      };\r\n      const endEvt = { hand: this.el, buttonEvent: evt };\r\n      const dropTarget = this.findTarget(this.DRAGDROP_EVENT, ddEvt, true);\r\n      if (dropTarget) {\r\n        ddEvt.on = dropTarget;\r\n        this.emitCancelable(carried, this.DRAGDROP_EVENT, ddEvt);\r\n        this._unHover(dropTarget);\r\n      }\r\n      // check if end event accepted\r\n      if (!this.emitCancelable(carried, this.UNDRAG_EVENT, endEvt)) {\r\n        this.promoteHoveredEl(carried);\r\n        this.state.delete(this.DRAG_EVENT);\r\n        this.hover();\r\n      }\r\n    }\r\n  },\r\n  processHitEl: function (hitEl, intersection) {\r\n    const dist = intersection && intersection.distance;\r\n    const sects = this.hoverElsIntersections;\r\n    const hoverEls = this.hoverEls;\r\n    const hitElIndex = this.hoverEls.indexOf(hitEl);\r\n    let hoverNeedsUpdate = false;\r\n    if (hitElIndex === -1) {\r\n      hoverNeedsUpdate = true;\r\n      // insert in order of distance when available\r\n      if (dist != null) {\r\n        let i = 0;\r\n        while (i < sects.length && dist < sects[i].distance) {\r\n          i++;\r\n        }\r\n        hoverEls.splice(i, 0, hitEl);\r\n        sects.splice(i, 0, intersection);\r\n      } else {\r\n        hoverEls.push(hitEl);\r\n        sects.push({ object: { el: hitEl } });\r\n      }\r\n      this.dispatchMouseEvent(hitEl, 'mouseover', this.el);\r\n      if (this.dragging && this.gehDragged.size) {\r\n        // events on targets and on dragged\r\n        this.gehDragged.forEach(dragged => {\r\n          this.dispatchMouseEventAll('dragenter', dragged, true, true);\r\n        });\r\n      }\r\n    }\r\n    return hoverNeedsUpdate;\r\n  },\r\n  onHit: function (evt) {\r\n    const hitEl = evt.detail[this.data.colliderEventProperty];\r\n    let hoverNeedsUpdate = 0;\r\n    if (!hitEl) {\r\n      return;\r\n    }\r\n    if (Array.isArray(hitEl)) {\r\n      for (let i = 0, sect; i < hitEl.length; i++) {\r\n        sect = evt.detail.intersections && evt.detail.intersections[i];\r\n        hoverNeedsUpdate += this.processHitEl(hitEl[i], sect);\r\n      }\r\n    } else {\r\n      hoverNeedsUpdate += this.processHitEl(hitEl, null);\r\n    }\r\n    if (hoverNeedsUpdate) {\r\n      this.hover();\r\n    }\r\n  },\r\n  /* search collided entities for target to hover/dragover */\r\n  hover: function () {\r\n    var hvrevt, hoverEl;\r\n    // end previous hover\r\n    if (this.state.has(this.HOVER_EVENT)) {\r\n      this._unHover(this.state.get(this.HOVER_EVENT), true);\r\n    }\r\n    if (this.state.has(this.DRAGOVER_EVENT)) {\r\n      this._unHover(this.state.get(this.DRAGOVER_EVENT), true);\r\n    }\r\n    if (this.dragging && this.state.get(this.DRAG_EVENT)) {\r\n      hvrevt = {\r\n        hand: this.el,\r\n        hovered: hoverEl,\r\n        carried: this.state.get(this.DRAG_EVENT)\r\n      };\r\n      hoverEl = this.findTarget(this.DRAGOVER_EVENT, hvrevt, true);\r\n      if (hoverEl) {\r\n        this.emitCancelable(this.state.get(this.DRAG_EVENT), this.DRAGOVER_EVENT, hvrevt);\r\n        this.state.set(this.DRAGOVER_EVENT, hoverEl);\r\n      }\r\n    }\r\n    // fallback to hover if not dragging or dragover wasn't successful\r\n    if (!this.state.has(this.DRAGOVER_EVENT)) {\r\n      hoverEl = this.findTarget(this.HOVER_EVENT, { hand: this.el }, true);\r\n      if (hoverEl) {\r\n        this.state.set(this.HOVER_EVENT, hoverEl);\r\n      }\r\n    }\r\n  },\r\n  /* called when controller moves out of collision range of entity */\r\n  unHover: function (evt) {\r\n    const clearedEls = evt.detail[this.data.colliderEndEventProperty];\r\n    if (clearedEls) {\r\n      if (Array.isArray(clearedEls)) {\r\n        clearedEls.forEach(el => this._unHover(el));\r\n      } else {\r\n        this._unHover(clearedEls);\r\n      }\r\n    }\r\n  },\r\n  /* inner unHover steps needed regardless of cause of unHover */\r\n  _unHover: function (el, skipNextHover) {\r\n    let unHovered = false;\r\n    let evt;\r\n    if (el === this.state.get(this.DRAGOVER_EVENT)) {\r\n      this.state.delete(this.DRAGOVER_EVENT);\r\n      unHovered = true;\r\n      evt = {\r\n        hand: this.el,\r\n        hovered: el,\r\n        carried: this.state.get(this.DRAG_EVENT)\r\n      };\r\n      this.emitCancelable(el, this.UNDRAGOVER_EVENT, evt);\r\n      if (this.state.has(this.DRAG_EVENT)) {\r\n        this.emitCancelable(this.state.get(this.DRAG_EVENT), this.UNDRAGOVER_EVENT, evt);\r\n      }\r\n    }\r\n    if (el === this.state.get(this.HOVER_EVENT)) {\r\n      this.state.delete(this.HOVER_EVENT);\r\n      unHovered = true;\r\n      this.emitCancelable(el, this.UNHOVER_EVENT, { hand: this.el });\r\n    }\r\n    // activate next target, if present\r\n    if (unHovered && !skipNextHover) {\r\n      this.hover();\r\n    }\r\n  },\r\n  unWatch: function (evt) {\r\n    const clearedEls = evt.detail[this.data.colliderEndEventProperty];\r\n    if (clearedEls) {\r\n      if (Array.isArray(clearedEls)) {\r\n        clearedEls.forEach(el => this._unWatch(el));\r\n      } else {\r\n        // deprecation path: sphere-collider\r\n        this._unWatch(clearedEls);\r\n      }\r\n    }\r\n  },\r\n  _unWatch: function (target) {\r\n    var hoverIndex = this.hoverEls.indexOf(target);\r\n    if (hoverIndex !== -1) {\r\n      this.hoverEls.splice(hoverIndex, 1);\r\n      this.hoverElsIntersections.splice(hoverIndex, 1);\r\n    }\r\n    this.gehDragged.forEach(dragged => {\r\n      this.dispatchMouseEvent(target, 'dragleave', dragged);\r\n      this.dispatchMouseEvent(dragged, 'dragleave', target);\r\n    });\r\n    this.dispatchMouseEvent(target, 'mouseout', this.el);\r\n  },\r\n  registerListeners: function () {\r\n    this.el.addEventListener(this.data.colliderEvent, this.onHit);\r\n    this.el.addEventListener(this.data.colliderEndEvent, this.unWatch);\r\n    this.el.addEventListener(this.data.colliderEndEvent, this.unHover);\r\n\r\n    // binding order to keep grabEnd from triggering dragover\r\n    // again before dragDropEnd can delete its carried state\r\n    this.data.grabStartButtons.forEach(b => {\r\n      this.el.addEventListener(b, this.onGrabStartButton);\r\n    });\r\n    this.data.stretchStartButtons.forEach(b => {\r\n      this.el.addEventListener(b, this.onStretchStartButton);\r\n    });\r\n    this.data.dragDropStartButtons.forEach(b => {\r\n      this.el.addEventListener(b, this.onDragDropStartButton);\r\n    });\r\n    this.data.dragDropEndButtons.forEach(b => {\r\n      this.el.addEventListener(b, this.onDragDropEndButton);\r\n    });\r\n    this.data.stretchEndButtons.forEach(b => {\r\n      this.el.addEventListener(b, this.onStretchEndButton);\r\n    });\r\n    this.data.grabEndButtons.forEach(b => {\r\n      this.el.addEventListener(b, this.onGrabEndButton);\r\n    });\r\n  },\r\n  unRegisterListeners: function (data) {\r\n    data = data || this.data;\r\n    if (Object.keys(data).length === 0) {\r\n      // Empty object passed on initalization\r\n      return;\r\n    }\r\n    this.el.removeEventListener(data.colliderEvent, this.onHit);\r\n    this.el.removeEventListener(data.colliderEndEvent, this.unHover);\r\n    this.el.removeEventListener(data.colliderEndEvent, this.unWatch);\r\n\r\n    data.grabStartButtons.forEach(b => {\r\n      this.el.removeEventListener(b, this.onGrabStartButton);\r\n    });\r\n    data.grabEndButtons.forEach(b => {\r\n      this.el.removeEventListener(b, this.onGrabEndButton);\r\n    });\r\n    data.stretchStartButtons.forEach(b => {\r\n      this.el.removeEventListener(b, this.onStretchStartButton);\r\n    });\r\n    data.stretchEndButtons.forEach(b => {\r\n      this.el.removeEventListener(b, this.onStretchEndButton);\r\n    });\r\n    data.dragDropStartButtons.forEach(b => {\r\n      this.el.removeEventListener(b, this.onDragDropStartButton);\r\n    });\r\n    data.dragDropEndButtons.forEach(b => {\r\n      this.el.removeEventListener(b, this.onDragDropEndButton);\r\n    });\r\n  },\r\n  emitCancelable: function (target, name, detail) {\r\n    var data, evt;\r\n    detail = detail || {};\r\n    data = { bubbles: true, cancelable: true, detail: detail };\r\n    data.detail.target = data.detail.target || target;\r\n    evt = new window.CustomEvent(name, data);\r\n    return target.dispatchEvent(evt);\r\n  },\r\n  dispatchMouseEvent: function (target, name, relatedTarget) {\r\n    var mEvt = new window.MouseEvent(name, { relatedTarget: relatedTarget });\r\n    target.dispatchEvent(mEvt);\r\n  },\r\n  dispatchMouseEventAll: function (name, relatedTarget, filterUsed, alsoReverse) {\r\n    let els = this.hoverEls;\r\n    if (filterUsed) {\r\n      els = els.filter(el => el !== this.state.get(this.GRAB_EVENT) && el !== this.state.get(this.DRAG_EVENT) && el !== this.state.get(this.STRETCH_EVENT) && !this.gehDragged.has(el));\r\n    }\r\n    if (alsoReverse) {\r\n      for (let i = 0; i < els.length; i++) {\r\n        this.dispatchMouseEvent(els[i], name, relatedTarget);\r\n        this.dispatchMouseEvent(relatedTarget, name, els[i]);\r\n      }\r\n    } else {\r\n      for (let i = 0; i < els.length; i++) {\r\n        this.dispatchMouseEvent(els[i], name, relatedTarget);\r\n      }\r\n    }\r\n  },\r\n  findTarget: function (evType, detail, filterUsed) {\r\n    var elIndex;\r\n    var eligibleEls = this.hoverEls;\r\n    if (filterUsed) {\r\n      eligibleEls = eligibleEls.filter(el => el !== this.state.get(this.GRAB_EVENT) && el !== this.state.get(this.DRAG_EVENT) && el !== this.state.get(this.STRETCH_EVENT));\r\n    }\r\n    for (elIndex = eligibleEls.length - 1; elIndex >= 0; elIndex--) {\r\n      if (!this.emitCancelable(eligibleEls[elIndex], evType, detail)) {\r\n        return eligibleEls[elIndex];\r\n      }\r\n    }\r\n    return null;\r\n  },\r\n  // Helper to ensure dropping and regrabbing finds the same target for\r\n  // for order-sorted hoverEls (grabbing; no-op for distance-sorted (pointing)\r\n  promoteHoveredEl: function (el) {\r\n    var hoverIndex = this.hoverEls.indexOf(el);\r\n    if (hoverIndex !== -1 && this.hoverElsIntersections[hoverIndex].distance === null) {\r\n      this.hoverEls.splice(hoverIndex, 1);\r\n      const sect = this.hoverElsIntersections.splice(hoverIndex, 1);\r\n      this.hoverEls.push(el);\r\n      this.hoverElsIntersections.push(sect[0]);\r\n    }\r\n  }\r\n});\r\n\r\n},{\"./reaction_components/clickable.js\":2,\"./reaction_components/drag-droppable.js\":3,\"./reaction_components/draggable.js\":4,\"./reaction_components/droppable.js\":5,\"./reaction_components/grabbable.js\":6,\"./reaction_components/hoverable.js\":7,\"./reaction_components/stretchable.js\":10,\"./systems/super-hands-system.js\":11}],2:[function(require,module,exports){\r\n\r\n/* global AFRAME */\r\nconst buttonCore = require('./prototypes/buttons-proto.js');\r\nAFRAME.registerComponent('clickable', AFRAME.utils.extendDeep({}, buttonCore, {\r\n  schema: {\r\n    onclick: { type: 'string' }\r\n  },\r\n  init: function () {\r\n    this.CLICKED_STATE = 'clicked';\r\n    this.CLICK_EVENT = 'grab-start';\r\n    this.UNCLICK_EVENT = 'grab-end';\r\n    this.clickers = [];\r\n\r\n    this.start = this.start.bind(this);\r\n    this.end = this.end.bind(this);\r\n    this.el.addEventListener(this.CLICK_EVENT, this.start);\r\n    this.el.addEventListener(this.UNCLICK_EVENT, this.end);\r\n  },\r\n  remove: function () {\r\n    this.el.removeEventListener(this.CLICK_EVENT, this.start);\r\n    this.el.removeEventListener(this.UNCLICK_EVENT, this.end);\r\n  },\r\n  start: function (evt) {\r\n    if (evt.defaultPrevented || !this.startButtonOk(evt)) {\r\n      return;\r\n    }\r\n    this.el.addState(this.CLICKED_STATE);\r\n    if (this.clickers.indexOf(evt.detail.hand) === -1) {\r\n      this.clickers.push(evt.detail.hand);\r\n      if (evt.preventDefault) {\r\n        evt.preventDefault();\r\n      }\r\n    }\r\n  },\r\n  end: function (evt) {\r\n    const handIndex = this.clickers.indexOf(evt.detail.hand);\r\n    if (evt.defaultPrevented || !this.endButtonOk(evt)) {\r\n      return;\r\n    }\r\n    if (handIndex !== -1) {\r\n      this.clickers.splice(handIndex, 1);\r\n    }\r\n    if (this.clickers.length < 1) {\r\n      this.el.removeState(this.CLICKED_STATE);\r\n    }\r\n    if (evt.preventDefault) {\r\n      evt.preventDefault();\r\n    }\r\n  }\r\n}));\r\n\r\n},{\"./prototypes/buttons-proto.js\":8}],3:[function(require,module,exports){\r\n\r\n/* global AFRAME */\r\nconst inherit = AFRAME.utils.extendDeep;\r\nconst buttonCore = require('./prototypes/buttons-proto.js');\r\n\r\nAFRAME.registerComponent('drag-droppable', inherit({}, buttonCore, {\r\n  init: function () {\r\n    console.warn('Warning: drag-droppable is deprecated. Use draggable and droppable components instead');\r\n    this.HOVERED_STATE = 'dragover';\r\n    this.DRAGGED_STATE = 'dragged';\r\n    this.HOVER_EVENT = 'dragover-start';\r\n    this.UNHOVER_EVENT = 'dragover-end';\r\n    this.DRAG_EVENT = 'drag-start';\r\n    this.UNDRAG_EVENT = 'drag-end';\r\n    this.DRAGDROP_EVENT = 'drag-drop';\r\n\r\n    this.hoverStart = this.hoverStart.bind(this);\r\n    this.dragStart = this.dragStart.bind(this);\r\n    this.hoverEnd = this.hoverEnd.bind(this);\r\n    this.dragEnd = this.dragEnd.bind(this);\r\n    this.dragDrop = this.dragDrop.bind(this);\r\n\r\n    this.el.addEventListener(this.HOVER_EVENT, this.hoverStart);\r\n    this.el.addEventListener(this.DRAG_EVENT, this.dragStart);\r\n    this.el.addEventListener(this.UNHOVER_EVENT, this.hoverEnd);\r\n    this.el.addEventListener(this.UNDRAG_EVENT, this.dragEnd);\r\n    this.el.addEventListener(this.DRAGDROP_EVENT, this.dragDrop);\r\n  },\r\n  remove: function () {\r\n    this.el.removeEventListener(this.HOVER_EVENT, this.hoverStart);\r\n    this.el.removeEventListener(this.DRAG_EVENT, this.dragStart);\r\n    this.el.removeEventListener(this.UNHOVER_EVENT, this.hoverEnd);\r\n    this.el.removeEventListener(this.UNDRAG_EVENT, this.dragEnd);\r\n    this.el.removeEventListener(this.DRAGDROP_EVENT, this.dragDrop);\r\n  },\r\n  hoverStart: function (evt) {\r\n    this.el.addState(this.HOVERED_STATE);\r\n    if (evt.preventDefault) {\r\n      evt.preventDefault();\r\n    }\r\n  },\r\n  dragStart: function (evt) {\r\n    if (!this.startButtonOk(evt)) {\r\n      return;\r\n    }\r\n    this.el.addState(this.DRAGGED_STATE);\r\n    if (evt.preventDefault) {\r\n      evt.preventDefault();\r\n    }\r\n  },\r\n  hoverEnd: function (evt) {\r\n    this.el.removeState(this.HOVERED_STATE);\r\n  },\r\n  dragEnd: function (evt) {\r\n    if (!this.endButtonOk(evt)) {\r\n      return;\r\n    }\r\n    this.el.removeState(this.DRAGGED_STATE);\r\n    if (evt.preventDefault) {\r\n      evt.preventDefault();\r\n    }\r\n  },\r\n  dragDrop: function (evt) {\r\n    if (!this.endButtonOk(evt)) {\r\n      return;\r\n    }\r\n    if (evt.preventDefault) {\r\n      evt.preventDefault();\r\n    }\r\n  }\r\n}));\r\n\r\n},{\"./prototypes/buttons-proto.js\":8}],4:[function(require,module,exports){\r\n\r\n/* global AFRAME */\r\nconst inherit = AFRAME.utils.extendDeep;\r\nconst buttonCore = require('./prototypes/buttons-proto.js');\r\n\r\nAFRAME.registerComponent('draggable', inherit({}, buttonCore, {\r\n  init: function () {\r\n    this.DRAGGED_STATE = 'dragged';\r\n    this.DRAG_EVENT = 'drag-start';\r\n    this.UNDRAG_EVENT = 'drag-end';\r\n\r\n    this.dragStartBound = this.dragStart.bind(this);\r\n    this.dragEndBound = this.dragEnd.bind(this);\r\n\r\n    this.el.addEventListener(this.DRAG_EVENT, this.dragStartBound);\r\n    this.el.addEventListener(this.UNDRAG_EVENT, this.dragEndBound);\r\n  },\r\n  remove: function () {\r\n    this.el.removeEventListener(this.DRAG_EVENT, this.dragStart);\r\n    this.el.removeEventListener(this.UNDRAG_EVENT, this.dragEnd);\r\n  },\r\n  dragStart: function (evt) {\r\n    if (evt.defaultPrevented || !this.startButtonOk(evt)) {\r\n      return;\r\n    }\r\n    this.el.addState(this.DRAGGED_STATE);\r\n    if (evt.preventDefault) {\r\n      evt.preventDefault();\r\n    }\r\n  },\r\n  dragEnd: function (evt) {\r\n    if (evt.defaultPrevented || !this.endButtonOk(evt)) {\r\n      return;\r\n    }\r\n    this.el.removeState(this.DRAGGED_STATE);\r\n    if (evt.preventDefault) {\r\n      evt.preventDefault();\r\n    }\r\n  }\r\n}));\r\n\r\n},{\"./prototypes/buttons-proto.js\":8}],5:[function(require,module,exports){\r\n\r\n/* global AFRAME */\r\nfunction elementMatches(el, selector) {\r\n  if (el.matches) {\r\n    return el.matches(selector);\r\n  }\r\n  if (el.msMatchesSelector) {\r\n    return el.msMatchesSelector(selector);\r\n  }\r\n  if (el.webkitMatchesSelector) {\r\n    return el.webkitMatchesSelector(selector);\r\n  }\r\n}\r\nAFRAME.registerComponent('droppable', {\r\n  schema: {\r\n    accepts: { default: '' },\r\n    autoUpdate: { default: true },\r\n    acceptEvent: { default: '' },\r\n    rejectEvent: { default: '' }\r\n  },\r\n  multiple: true,\r\n  init: function () {\r\n    this.HOVERED_STATE = 'dragover';\r\n    this.HOVER_EVENT = 'dragover-start';\r\n    this.UNHOVER_EVENT = 'dragover-end';\r\n    this.DRAGDROP_EVENT = 'drag-drop';\r\n\r\n    // better for Sinon spying if original method not overwritten\r\n    this.hoverStartBound = this.hoverStart.bind(this);\r\n    this.hoverEndBound = this.hoverEnd.bind(this);\r\n    this.dragDropBound = this.dragDrop.bind(this);\r\n    this.mutateAcceptsBound = this.mutateAccepts.bind(this);\r\n\r\n    this.acceptableEntities = [];\r\n    this.observer = new window.MutationObserver(this.mutateAcceptsBound);\r\n    this.observerOpts = { childList: true, subtree: true };\r\n\r\n    this.el.addEventListener(this.HOVER_EVENT, this.hoverStartBound);\r\n    this.el.addEventListener(this.UNHOVER_EVENT, this.hoverEndBound);\r\n    this.el.addEventListener(this.DRAGDROP_EVENT, this.dragDropBound);\r\n  },\r\n  update: function () {\r\n    if (this.data.accepts.length) {\r\n      this.acceptableEntities = Array.prototype.slice.call(this.el.sceneEl.querySelectorAll(this.data.accepts));\r\n    } else {\r\n      this.acceptableEntities = null;\r\n    }\r\n    if (this.data.autoUpdate && this.acceptableEntities != null) {\r\n      this.observer.observe(this.el.sceneEl, this.observerOpts);\r\n    } else {\r\n      this.observer.disconnect();\r\n    }\r\n  },\r\n  remove: function () {\r\n    this.el.removeEventListener(this.HOVER_EVENT, this.hoverStartBound);\r\n    this.el.removeEventListener(this.UNHOVER_EVENT, this.hoverEndBound);\r\n    this.el.removeEventListener(this.DRAGDROP_EVENT, this.dragDropBound);\r\n    this.observer.disconnect();\r\n  },\r\n  mutateAccepts: function (mutations) {\r\n    const query = this.data.accepts;\r\n    mutations.forEach(mutation => {\r\n      mutation.addedNodes.forEach(added => {\r\n        if (elementMatches(added, query)) {\r\n          this.acceptableEntities.push(added);\r\n        }\r\n      });\r\n    });\r\n  },\r\n  entityAcceptable: function (entity) {\r\n    const acceptableEntities = this.acceptableEntities;\r\n    if (acceptableEntities === null) {\r\n      return true;\r\n    }\r\n    for (let item of acceptableEntities) {\r\n      if (item === entity) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  },\r\n  hoverStart: function (evt) {\r\n    if (evt.defaultPrevented || !this.entityAcceptable(evt.detail.carried)) {\r\n      return;\r\n    }\r\n    this.el.addState(this.HOVERED_STATE);\r\n    if (evt.preventDefault) {\r\n      evt.preventDefault();\r\n    }\r\n  },\r\n  hoverEnd: function (evt) {\r\n    if (evt.defaultPrevented) {\r\n      return;\r\n    }\r\n    this.el.removeState(this.HOVERED_STATE);\r\n  },\r\n  dragDrop: function (evt) {\r\n    if (evt.defaultPrevented) {\r\n      return;\r\n    }\r\n    const dropped = evt.detail.dropped;\r\n    if (!this.entityAcceptable(dropped)) {\r\n      if (this.data.rejectEvent.length) {\r\n        this.el.emit(this.data.rejectEvent, { el: dropped });\r\n      }\r\n      return;\r\n    }\r\n    if (this.data.acceptEvent.length) {\r\n      this.el.emit(this.data.acceptEvent, { el: dropped });\r\n    }\r\n    if (evt.preventDefault) {\r\n      evt.preventDefault();\r\n    }\r\n  }\r\n});\r\n\r\n},{}],6:[function(require,module,exports){\r\n\r\n/* global AFRAME, THREE */\r\nconst inherit = AFRAME.utils.extendDeep;\r\nconst physicsCore = require('./prototypes/physics-grab-proto.js');\r\nconst buttonsCore = require('./prototypes/buttons-proto.js');\r\n// new object with all core modules\r\nconst base = inherit({}, physicsCore, buttonsCore);\r\nAFRAME.registerComponent('grabbable', inherit(base, {\r\n  schema: {\r\n    maxGrabbers: { type: 'int', default: NaN },\r\n    invert: { default: false },\r\n    suppressX: { default: false },\r\n    suppressY: { default: false },\r\n    suppressZ: { default: false }\r\n  },\r\n  init: function () {\r\n    this.GRABBED_STATE = 'grabbed';\r\n    this.GRAB_EVENT = 'grab-start';\r\n    this.UNGRAB_EVENT = 'grab-end';\r\n    this.grabbed = false;\r\n    this.grabbers = [];\r\n    this.constraints = new Map();\r\n    this.deltaPositionIsValid = false;\r\n    this.grabDistance = undefined;\r\n    this.grabDirection = { x: 0, y: 0, z: -1 };\r\n    this.grabOffset = { x: 0, y: 0, z: 0\r\n      // persistent object speeds up repeat setAttribute calls\r\n    };this.destPosition = { x: 0, y: 0, z: 0 };\r\n    this.deltaPosition = new THREE.Vector3();\r\n    this.targetPosition = new THREE.Vector3();\r\n    this.physicsInit();\r\n\r\n    this.el.addEventListener(this.GRAB_EVENT, e => this.start(e));\r\n    this.el.addEventListener(this.UNGRAB_EVENT, e => this.end(e));\r\n    this.el.addEventListener('mouseout', e => this.lostGrabber(e));\r\n  },\r\n  update: function () {\r\n    this.physicsUpdate();\r\n    this.xFactor = (this.data.invert ? -1 : 1) * !this.data.suppressX;\r\n    this.yFactor = (this.data.invert ? -1 : 1) * !this.data.suppressY;\r\n    this.zFactor = (this.data.invert ? -1 : 1) * !this.data.suppressZ;\r\n  },\r\n  tick: function () {\r\n    var q = new THREE.Quaternion();\r\n    var v = new THREE.Vector3();\r\n\r\n    return function () {\r\n      var entityPosition;\r\n      if (this.grabber) {\r\n        // reflect on z-axis to point in same direction as the laser\r\n        this.targetPosition.copy(this.grabDirection);\r\n        this.targetPosition.applyQuaternion(this.grabber.object3D.getWorldQuaternion(q)).setLength(this.grabDistance).add(this.grabber.object3D.getWorldPosition(v)).add(this.grabOffset);\r\n        if (this.deltaPositionIsValid) {\r\n          // relative position changes work better with nested entities\r\n          this.deltaPosition.sub(this.targetPosition);\r\n          entityPosition = this.el.getAttribute('position');\r\n          this.destPosition.x = entityPosition.x - this.deltaPosition.x * this.xFactor;\r\n          this.destPosition.y = entityPosition.y - this.deltaPosition.y * this.yFactor;\r\n          this.destPosition.z = entityPosition.z - this.deltaPosition.z * this.zFactor;\r\n          this.el.setAttribute('position', this.destPosition);\r\n        } else {\r\n          this.deltaPositionIsValid = true;\r\n        }\r\n        this.deltaPosition.copy(this.targetPosition);\r\n      }\r\n    };\r\n  }(),\r\n  remove: function () {\r\n    this.el.removeEventListener(this.GRAB_EVENT, this.start);\r\n    this.el.removeEventListener(this.UNGRAB_EVENT, this.end);\r\n    this.physicsRemove();\r\n  },\r\n  start: function (evt) {\r\n    if (evt.defaultPrevented || !this.startButtonOk(evt)) {\r\n      return;\r\n    }\r\n    // room for more grabbers?\r\n    const grabAvailable = !Number.isFinite(this.data.maxGrabbers) || this.grabbers.length < this.data.maxGrabbers;\r\n\r\n    if (this.grabbers.indexOf(evt.detail.hand) === -1 && grabAvailable) {\r\n      if (!evt.detail.hand.object3D) {\r\n        console.warn('grabbable entities must have an object3D');\r\n        return;\r\n      }\r\n      this.grabbers.push(evt.detail.hand);\r\n      // initiate physics if available, otherwise manual\r\n      if (!this.physicsStart(evt) && !this.grabber) {\r\n        this.grabber = evt.detail.hand;\r\n        this.resetGrabber();\r\n      }\r\n      // notify super-hands that the gesture was accepted\r\n      if (evt.preventDefault) {\r\n        evt.preventDefault();\r\n      }\r\n      this.grabbed = true;\r\n      this.el.addState(this.GRABBED_STATE);\r\n    }\r\n  },\r\n  end: function (evt) {\r\n    const handIndex = this.grabbers.indexOf(evt.detail.hand);\r\n    if (evt.defaultPrevented || !this.endButtonOk(evt)) {\r\n      return;\r\n    }\r\n    if (handIndex !== -1) {\r\n      this.grabbers.splice(handIndex, 1);\r\n      this.grabber = this.grabbers[0];\r\n    }\r\n    this.physicsEnd(evt);\r\n    if (!this.resetGrabber()) {\r\n      this.grabbed = false;\r\n      this.el.removeState(this.GRABBED_STATE);\r\n    }\r\n    if (evt.preventDefault) {\r\n      evt.preventDefault();\r\n    }\r\n  },\r\n  resetGrabber: function () {\r\n    var objPos = new THREE.Vector3();\r\n    var grabPos = new THREE.Vector3();\r\n    return function () {\r\n      let raycaster;\r\n      if (!this.grabber) {\r\n        return false;\r\n      }\r\n      raycaster = this.grabber.getAttribute('raycaster');\r\n      this.deltaPositionIsValid = false;\r\n      this.grabDistance = this.el.object3D.getWorldPosition(objPos).distanceTo(this.grabber.object3D.getWorldPosition(grabPos));\r\n      if (raycaster) {\r\n        this.grabDirection = raycaster.direction;\r\n        this.grabOffset = raycaster.origin;\r\n      }\r\n      return true;\r\n    };\r\n  }(),\r\n  lostGrabber: function (evt) {\r\n    let i = this.grabbers.indexOf(evt.relatedTarget);\r\n    // if a queued, non-physics grabber leaves the collision zone, forget it\r\n    if (i !== -1 && evt.relatedTarget !== this.grabber && !this.physicsIsConstrained(evt.relatedTarget)) {\r\n      this.grabbers.splice(i, 1);\r\n    }\r\n  }\r\n}));\r\n\r\n},{\"./prototypes/buttons-proto.js\":8,\"./prototypes/physics-grab-proto.js\":9}],7:[function(require,module,exports){\r\n\r\n/* global AFRAME */\r\nAFRAME.registerComponent('hoverable', {\r\n  init: function () {\r\n    this.HOVERED_STATE = 'hovered';\r\n    this.HOVER_EVENT = 'hover-start';\r\n    this.UNHOVER_EVENT = 'hover-end';\r\n\r\n    this.hoverers = [];\r\n\r\n    this.start = this.start.bind(this);\r\n    this.end = this.end.bind(this);\r\n\r\n    this.el.addEventListener(this.HOVER_EVENT, this.start);\r\n    this.el.addEventListener(this.UNHOVER_EVENT, this.end);\r\n  },\r\n  remove: function () {\r\n    this.el.removeEventListener(this.HOVER_EVENT, this.start);\r\n    this.el.removeEventListener(this.UNHOVER_EVENT, this.end);\r\n  },\r\n  start: function (evt) {\r\n    if (evt.defaultPrevented) {\r\n      return;\r\n    }\r\n    this.el.addState(this.HOVERED_STATE);\r\n    if (this.hoverers.indexOf(evt.detail.hand) === -1) {\r\n      this.hoverers.push(evt.detail.hand);\r\n    }\r\n    if (evt.preventDefault) {\r\n      evt.preventDefault();\r\n    }\r\n  },\r\n  end: function (evt) {\r\n    if (evt.defaultPrevented) {\r\n      return;\r\n    }\r\n    var handIndex = this.hoverers.indexOf(evt.detail.hand);\r\n    if (handIndex !== -1) {\r\n      this.hoverers.splice(handIndex, 1);\r\n    }\r\n    if (this.hoverers.length < 1) {\r\n      this.el.removeState(this.HOVERED_STATE);\r\n    }\r\n  }\r\n});\r\n\r\n},{}],8:[function(require,module,exports){\r\n\r\n// common code used in customizing reaction components by button\r\nmodule.exports = function () {\r\n  function buttonIsValid(evt, buttonList) {\r\n    return buttonList.length === 0 || buttonList.indexOf(evt.detail.buttonEvent.type) !== -1;\r\n  }\r\n  return {\r\n    schema: {\r\n      startButtons: { default: [] },\r\n      endButtons: { default: [] }\r\n    },\r\n    startButtonOk: function (evt) {\r\n      return buttonIsValid(evt, this.data['startButtons']);\r\n    },\r\n    endButtonOk: function (evt) {\r\n      return buttonIsValid(evt, this.data['endButtons']);\r\n    }\r\n  };\r\n}();\r\n\r\n},{}],9:[function(require,module,exports){\r\n\r\n// base code used by grabbable for physics interactions\r\nmodule.exports = {\r\n  schema: {\r\n    usePhysics: { default: 'ifavailable' }\r\n  },\r\n  physicsInit: function () {\r\n    this.constraints = new Map();\r\n  },\r\n  physicsUpdate: function () {\r\n    if (this.data.usePhysics === 'never' && this.constraints.size) {\r\n      this.physicsClear();\r\n    }\r\n  },\r\n  physicsRemove: function () {\r\n    this.physicsClear();\r\n  },\r\n  physicsStart: function (evt) {\r\n    // initiate physics constraint if available and not already existing\r\n    if (this.data.usePhysics !== 'never' && this.el.body && evt.detail.hand.body && !this.constraints.has(evt.detail.hand)) {\r\n      const newConId = Math.random().toString(36).substr(2, 9);\r\n      this.el.setAttribute('constraint__' + newConId, {\r\n        target: evt.detail.hand\r\n      });\r\n      this.constraints.set(evt.detail.hand, newConId);\r\n      return true;\r\n    }\r\n    // Prevent manual grab by returning true\r\n    if (this.data.usePhysics === 'only') {\r\n      return true;\r\n    }\r\n    return false;\r\n  },\r\n  physicsEnd: function (evt) {\r\n    let constraintId = this.constraints.get(evt.detail.hand);\r\n    if (constraintId) {\r\n      this.el.removeAttribute('constraint__' + constraintId);\r\n      this.constraints.delete(evt.detail.hand);\r\n    }\r\n  },\r\n  physicsClear: function () {\r\n    if (this.el.body) {\r\n      for (let c of this.constraints.values()) {\r\n        this.el.body.world.removeConstraint(c);\r\n      }\r\n    }\r\n    this.constraints.clear();\r\n  },\r\n  physicsIsConstrained: function (el) {\r\n    return this.constraints.has(el);\r\n  },\r\n  physicsIsGrabbing() {\r\n    return this.constraints.size > 0;\r\n  }\r\n};\r\n\r\n},{}],10:[function(require,module,exports){\r\n\r\n/* global AFRAME, THREE */\r\nconst inherit = AFRAME.utils.extendDeep;\r\nconst buttonsCore = require('./prototypes/buttons-proto.js');\r\n// new object with all core modules\r\nconst base = inherit({}, buttonsCore);\r\nAFRAME.registerComponent('stretchable', inherit(base, {\r\n  schema: {\r\n    usePhysics: { default: 'ifavailable' },\r\n    invert: { default: false },\r\n    physicsUpdateRate: { default: 100 }\r\n  },\r\n  init: function () {\r\n    this.STRETCHED_STATE = 'stretched';\r\n    this.STRETCH_EVENT = 'stretch-start';\r\n    this.UNSTRETCH_EVENT = 'stretch-end';\r\n    this.stretched = false;\r\n    this.stretchers = [];\r\n\r\n    this.scale = new THREE.Vector3();\r\n    this.handPos = new THREE.Vector3();\r\n    this.otherHandPos = new THREE.Vector3();\r\n\r\n    this.start = this.start.bind(this);\r\n    this.end = this.end.bind(this);\r\n\r\n    this.el.addEventListener(this.STRETCH_EVENT, this.start);\r\n    this.el.addEventListener(this.UNSTRETCH_EVENT, this.end);\r\n  },\r\n  update: function (oldDat) {\r\n    this.updateBodies = AFRAME.utils.throttleTick(this._updateBodies, this.data.physicsUpdateRate, this);\r\n  },\r\n  tick: function (time, timeDelta) {\r\n    if (!this.stretched) {\r\n      return;\r\n    }\r\n    this.scale.copy(this.el.getAttribute('scale'));\r\n    this.stretchers[0].object3D.getWorldPosition(this.handPos);\r\n    this.stretchers[1].object3D.getWorldPosition(this.otherHandPos);\r\n    const currentStretch = this.handPos.distanceTo(this.otherHandPos);\r\n    let deltaStretch = 1;\r\n    if (this.previousStretch !== null && currentStretch !== 0) {\r\n      deltaStretch = Math.pow(currentStretch / this.previousStretch, this.data.invert ? -1 : 1);\r\n    }\r\n    this.previousStretch = currentStretch;\r\n    if (this.previousPhysicsStretch === null) {\r\n      // establish correct baseline even if throttled function isn't called\r\n      this.previousPhysicsStretch = currentStretch;\r\n    }\r\n    this.scale.multiplyScalar(deltaStretch);\r\n    this.el.setAttribute('scale', this.scale);\r\n    // scale update for all nested physics bodies (throttled)\r\n    this.updateBodies(time, timeDelta);\r\n  },\r\n  remove: function () {\r\n    this.el.removeEventListener(this.STRETCH_EVENT, this.start);\r\n    this.el.removeEventListener(this.UNSTRETCH_EVENT, this.end);\r\n  },\r\n  start: function (evt) {\r\n    if (this.stretched || this.stretchers.includes(evt.detail.hand) || !this.startButtonOk(evt) || evt.defaultPrevented) {\r\n      return;\r\n    } // already stretched or already captured this hand or wrong button\r\n    this.stretchers.push(evt.detail.hand);\r\n    if (this.stretchers.length === 2) {\r\n      this.stretched = true;\r\n      this.previousStretch = null;\r\n      this.previousPhysicsStretch = null;\r\n      this.el.addState(this.STRETCHED_STATE);\r\n    }\r\n    if (evt.preventDefault) {\r\n      evt.preventDefault();\r\n    } // gesture accepted\r\n  },\r\n  end: function (evt) {\r\n    var stretcherIndex = this.stretchers.indexOf(evt.detail.hand);\r\n    if (evt.defaultPrevented || !this.endButtonOk(evt)) {\r\n      return;\r\n    }\r\n    if (stretcherIndex !== -1) {\r\n      this.stretchers.splice(stretcherIndex, 1);\r\n      this.stretched = false;\r\n      this.el.removeState(this.STRETCHED_STATE);\r\n      // override throttle to push last stretch to physics bodies\r\n      this._updateBodies();\r\n    }\r\n    if (evt.preventDefault) {\r\n      evt.preventDefault();\r\n    }\r\n  },\r\n  _updateBodies: function () {\r\n    if (!this.el.body || this.data.usePhysics === 'never') {\r\n      return;\r\n    }\r\n    const currentStretch = this.previousStretch; // last visible geometry stretch\r\n    let deltaStretch = 1;\r\n    if (this.previousPhysicsStretch !== null && currentStretch > 0) {\r\n      deltaStretch = Math.pow(currentStretch / this.previousPhysicsStretch, this.data.invert ? -1 : 1);\r\n    }\r\n    this.previousPhysicsStretch = currentStretch;\r\n    if (deltaStretch === 1) {\r\n      return;\r\n    }\r\n    for (let c of this.el.childNodes) {\r\n      this.stretchBody(c, deltaStretch);\r\n    }\r\n    this.stretchBody(this.el, deltaStretch);\r\n  },\r\n  stretchBody: function (el, deltaStretch) {\r\n    if (!el.body) {\r\n      return;\r\n    }\r\n    let physicsShape;\r\n    let offset;\r\n    for (let i = 0; i < el.body.shapes.length; i++) {\r\n      physicsShape = el.body.shapes[i];\r\n      if (physicsShape.halfExtents) {\r\n        physicsShape.halfExtents.scale(deltaStretch, physicsShape.halfExtents);\r\n        physicsShape.updateConvexPolyhedronRepresentation();\r\n      } else if (physicsShape.radius) {\r\n        physicsShape.radius *= deltaStretch;\r\n        physicsShape.updateBoundingSphereRadius();\r\n      } else if (!this.shapeWarned) {\r\n        console.warn('Unable to stretch physics body: unsupported shape');\r\n        this.shapeWarned = true;\r\n      }\r\n      // also move offset to match scale change\r\n      offset = el.body.shapeOffsets[i];\r\n      offset.scale(deltaStretch, offset);\r\n    }\r\n    el.body.updateBoundingRadius();\r\n  }\r\n}));\r\n\r\n},{\"./prototypes/buttons-proto.js\":8}],11:[function(require,module,exports){\r\n\r\n/* global AFRAME */\r\nAFRAME.registerSystem('super-hands', {\r\n  init: function () {\r\n    this.superHands = [];\r\n  },\r\n  registerMe: function (comp) {\r\n    // when second hand registers, store links\r\n    if (this.superHands.length === 1) {\r\n      this.superHands[0].otherSuperHand = comp;\r\n      comp.otherSuperHand = this.superHands[0];\r\n    }\r\n    this.superHands.push(comp);\r\n  },\r\n  unregisterMe: function (comp) {\r\n    var index = this.superHands.indexOf(comp);\r\n    if (index !== -1) {\r\n      this.superHands.splice(index, 1);\r\n    }\r\n    this.superHands.forEach(x => {\r\n      if (x.otherSuperHand === comp) {\r\n        x.otherSuperHand = null;\r\n      }\r\n    });\r\n  }\r\n});\r\n\r\n},{}]},{},[1]);\r\n","/**\r\n * @name applyFilters\r\n * @description Applies domain filters to a dataset\r\n * @author Peter Butcher <pete@pbutcher.uk>\r\n * @param {object} dataset - Dataset to filter\r\n * @param {object} domainMap - All domains in this vis-config\r\n * @returns {object} Filtered dataset\r\n */\r\nfunction applyFilters(dataset, domainMap) {\r\n  const filteredDataset = [];\r\n\r\n  const marks = document.querySelectorAll('.vria-mark');\r\n\r\n  // Hide all marks\r\n  marks.forEach((el) => {\r\n    el.setAttribute('visible', false);\r\n    el.classList.remove('interactive');\r\n  });\r\n\r\n  // Loop over every row in the dataset\r\n  dataset.forEach((row) => {\r\n    let filtersSatisfied = true;\r\n\r\n    // For every field...\r\n    Object.keys(row).forEach((field) => {\r\n      // If a field has a filter associated with it...\r\n      if (domainMap.has(field)) {\r\n        // A domainMap domain is empty...\r\n        if (domainMap.get(field).length === 0) {\r\n          filtersSatisfied = false;\r\n        } else if (typeof domainMap.get(field)[0] === 'string') {\r\n          // For filters containing strings\r\n          // If the value of this field isn't in the filter array...\r\n          if (!domainMap.get(field).includes(row[field])) {\r\n            // Discard this row\r\n            filtersSatisfied = false;\r\n          }\r\n          // For filters containing numbers\r\n        } else {\r\n          if (\r\n            row[field] < domainMap.get(field)[0] ||\r\n            row[field] > domainMap.get(field)[1]\r\n          ) {\r\n            filtersSatisfied = false;\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    if (filtersSatisfied) {\r\n      filteredDataset.push(row);\r\n      document.querySelectorAll(`.vria-${row.vriaid}`).forEach((el) => {\r\n        el.setAttribute('visible', true);\r\n        el.classList.add('interactive');\r\n      });\r\n    }\r\n  });\r\n\r\n  return filteredDataset;\r\n}\r\n\r\nexport default applyFilters;\r\n","import cloneDeep from 'lodash/cloneDeep';\r\nimport { applyFilters } from '../../functions';\r\n\r\nconst visConfigCompiled = (state, payload) => {\r\n  return {\r\n    ...state,\r\n    compiledConfig: payload.compiledConfig,\r\n    parsedDataset: payload.dataset,\r\n    filteredDataset: applyFilters(payload.dataset, payload.domainMap),\r\n    initialDomainMap: cloneDeep(payload.domainMap),\r\n    domainMap: payload.domainMap,\r\n    scales: payload.scales\r\n  };\r\n};\r\n\r\nexport default visConfigCompiled;\r\n","function debug(msg, ...rest) {\r\n  if (process.env.NODE_ENV === 'development') {\r\n    console.log(`VRIA Debug:`, msg, ...rest);\r\n  }\r\n}\r\n\r\nfunction warn(msg) {\r\n  console.warn(`VRIA Warning: ${msg}`);\r\n}\r\n\r\nfunction error(msg, ...rest) {\r\n  console.error(`VRIA Error: ${msg}`, ...rest);\r\n  throw new Error(`VRIA Error: ${msg}`, msg);\r\n}\r\n\r\nfunction mode() {\r\n  if (process.env.NODE_ENV === 'development') {\r\n    console.log(`VRIA in development mode...`);\r\n  }\r\n}\r\n\r\nexport default {\r\n  debug,\r\n  warn,\r\n  error,\r\n  mode\r\n};\r\n","import { applyFilters } from '../../functions';\r\nimport { log } from '../../utils';\r\n\r\nconst filterData = (state, payload) => {\r\n  const { value, field, bound, type } = payload;\r\n\r\n  let filteredDomain;\r\n\r\n  switch (type) {\r\n    case 'legend':\r\n      if (state.domainMap.get(field).includes(value)) {\r\n        filteredDomain = state.domainMap.get(field).filter((v) => v !== value);\r\n      } else {\r\n        // Check if this value was in the original domain\r\n        if (state.initialDomainMap.get(field).includes(value)) {\r\n          filteredDomain = state.domainMap.get(field);\r\n          filteredDomain.push(value);\r\n        } else {\r\n          log.error(\r\n            `filterData - Value not added, ${value} was not in original domain`\r\n          );\r\n        }\r\n      }\r\n      break;\r\n    case 'axis':\r\n      // TODO: Make available for non-quantitative axes?\r\n      filteredDomain = state.domainMap.get(field);\r\n      // Only update the filter if the new value is within the bounds of the original domain\r\n      if (bound === 0) {\r\n        if (value > state.initialDomainMap.get(field)[0]) {\r\n          filteredDomain[bound] = value;\r\n        } else {\r\n          filteredDomain[bound] = state.initialDomainMap.get(field)[0];\r\n        }\r\n      } else {\r\n        if (value < state.initialDomainMap.get(field)[1]) {\r\n          filteredDomain[bound] = value;\r\n        } else {\r\n          filteredDomain[bound] = state.initialDomainMap.get(field)[1];\r\n        }\r\n      }\r\n      break;\r\n  }\r\n\r\n  const newDomainMap = new Map(state.domainMap).set(field, filteredDomain);\r\n\r\n  return {\r\n    ...state,\r\n    filteredDataset: applyFilters(state.parsedDataset, newDomainMap),\r\n    domainMap: newDomainMap\r\n  };\r\n};\r\n\r\nexport default filterData;\r\n","const setCallbacks = (state, payload) => {\r\n  return {\r\n    ...state,\r\n    appCallback: payload.appCallback\r\n  };\r\n};\r\n\r\nexport default setCallbacks;\r\n","import cloneDeep from 'lodash/cloneDeep';\r\n\r\nconst markSelected = (state, payload) => {\r\n  const selection = {\r\n    dataMap: new Map(state.selection.dataMap),\r\n    data: [],\r\n    marks: []\r\n  };\r\n\r\n  const setMarkData = () => {\r\n    // Remove vriaid and add to selection map\r\n    const selectedRow = cloneDeep(\r\n      state.filteredDataset.filter((el) => el.vriaid === payload.id)\r\n    );\r\n    delete selectedRow[0].vriaid;\r\n    selection.dataMap.set(payload.vriaid, ...selectedRow);\r\n  };\r\n\r\n  if (state.selection.dataMap.has(payload.vriaid)) {\r\n    // Update selection map if mark was deselected\r\n    selection.dataMap.delete(payload.vriaid);\r\n  } else if (\r\n    state.options.multiSelect === true ||\r\n    selection.dataMap.size === 0\r\n  ) {\r\n    setMarkData();\r\n  } else if (\r\n    state.options.multiSelect === false &&\r\n    selection.dataMap.size === 1\r\n  ) {\r\n    // Switch selected to another mark\r\n    selection.dataMap.delete(selection.dataMap.keys().next().value);\r\n    setMarkData();\r\n  }\r\n\r\n  // Add raw data values to selection data array\r\n  selection.data = [...selection.dataMap.values()];\r\n\r\n  // Add mark classnames to marks array\r\n  selection.marks = [...selection.dataMap.keys()];\r\n\r\n  // Reset colour on all marks\r\n  document.querySelectorAll('[selected]').forEach((el) => {\r\n    el.setAttribute('color', el.getAttribute('initialColor'));\r\n    el.removeAttribute('selected');\r\n    el.removeAttribute('vria-only-selected-mark');\r\n    if (el.getAttribute('wireframe')) {\r\n      el.setAttribute('opacity', 0);\r\n    }\r\n  });\r\n\r\n  // Set selected colour on selected marks\r\n  if (selection.dataMap.size !== 0) {\r\n    selection.dataMap.forEach((value, key) => {\r\n      document.querySelectorAll(`.${key}`).forEach((el) => {\r\n        el.setAttribute('selected', true);\r\n        el.setAttribute('color', state.options.selectColor);\r\n        if (selection.dataMap.size === 1) {\r\n          el.setAttribute('vria-only-selected-mark', true);\r\n        }\r\n        if (el.getAttribute('wireframe')) {\r\n          el.setAttribute('opacity', 1);\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  // Set tooltip if a single mark is selected\r\n  if (selection.dataMap.size === 1) {\r\n    if (payload.showTooltip !== null && payload.showTooltip !== undefined) {\r\n      const tooltip = payload.cursor;\r\n      tooltip.setAttribute('height', payload.tooltipHeight);\r\n      tooltip.setAttribute('visible', true);\r\n      tooltip.setAttribute('text', {\r\n        ...tooltip.getAttribute('text'),\r\n        value: payload.tooltipContent\r\n      });\r\n    }\r\n  }\r\n\r\n  return {\r\n    ...state,\r\n    selection\r\n  };\r\n};\r\n\r\nexport default markSelected;\r\n","import cloneDeep from 'lodash/cloneDeep';\r\n\r\nconst setSelection = (state, payload) => {\r\n  const clearSelection = {\r\n    dataMap: new Map(),\r\n    data: [],\r\n    marks: []\r\n  };\r\n  let selection;\r\n  if (\r\n    Object.hasOwnProperty.call(payload, 'dataMap') &&\r\n    Object.hasOwnProperty.call(payload, 'data') &&\r\n    Object.hasOwnProperty.call(payload, 'marks')\r\n  ) {\r\n    selection = cloneDeep(payload);\r\n  } else {\r\n    selection = clearSelection;\r\n  }\r\n\r\n  // Reset selection state and colour on all marks\r\n  document.querySelectorAll('[selected]').forEach((el) => {\r\n    el.setAttribute('color', el.getAttribute('initialColor'));\r\n    el.removeAttribute('selected');\r\n    el.removeAttribute('vria-only-selected-mark');\r\n  });\r\n\r\n  // Set selected colour on selected marks\r\n  if (selection.dataMap.size !== 0) {\r\n    selection.dataMap.forEach((value, key) => {\r\n      document.querySelectorAll(`.${key}`).forEach((el) => {\r\n        el.setAttribute('selected', true);\r\n        el.setAttribute('color', state.options.selectColor);\r\n        if (selection.dataMap.size === 1) {\r\n          el.setAttribute('vria-only-selected-mark', true);\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  return {\r\n    ...state,\r\n    selection\r\n  };\r\n};\r\n\r\nexport default setSelection;\r\n","import { applyFilters } from '../../functions';\r\nimport cloneDeep from 'lodash/cloneDeep';\r\n\r\nconst setFilters = (state, payload) => {\r\n  return {\r\n    ...state,\r\n    filteredDataset: applyFilters(state.parsedDataset, payload),\r\n    domainMap: cloneDeep(payload)\r\n  };\r\n};\r\n\r\nexport default setFilters;\r\n","const setAdditionalFilters = (state, payload) => {\r\n  return {\r\n    ...state,\r\n    additionalFilters: payload\r\n  };\r\n};\r\n\r\nexport default setAdditionalFilters;\r\n","const setOptions = (state, payload) => {\r\n  return {\r\n    ...state,\r\n    options: {\r\n      ...state.options,\r\n      ...payload\r\n    }\r\n  };\r\n};\r\n\r\nexport default setOptions;\r\n","// Core Actions\r\nconst coreActions = {\r\n  VIS_CONFIG_COMPILED: 'VIS_CONFIG_COMPILED',\r\n  FILTER_DATA: 'FILTER_DATA',\r\n  SET_CALLBACKS: 'SET_CALLBACKS',\r\n  MARK_SELECTED: 'MARK_SELECTED',\r\n  SET_SELECTION: 'SET_SELECTION',\r\n  SET_FILTERS: 'SET_FILTERS',\r\n  SET_ADDITIONAL_FILTERS: 'SET_ADDITIONAL_FILTERS',\r\n  SET_OPTIONS: 'SET_OPTIONS'\r\n};\r\n\r\nexport default {\r\n  ...coreActions\r\n};\r\n","import visConfigCompiled from './core/visConfigCompiled';\r\nimport filterData from './core/filterData';\r\nimport setCallbacks from './core/setCallbacks';\r\nimport markSelected from './core/markSelected';\r\nimport setSelection from './core/setSelection';\r\nimport setFilters from './core/setFilters';\r\nimport setAdditionalFilters from './core/setAdditionalFilters';\r\nimport setOptions from './core/setOptions';\r\n\r\nexport { default as actionTypes } from './actionTypes';\r\n\r\nexport default {\r\n  visConfigCompiled,\r\n  filterData,\r\n  setCallbacks,\r\n  markSelected,\r\n  setSelection,\r\n  setFilters,\r\n  setAdditionalFilters,\r\n  setOptions\r\n};\r\n","import actions, { actionTypes } from '../actions';\r\nimport { log } from '../utils';\r\n\r\nconst reducer = (state, { type, payload }) => {\r\n  log.debug('reducer', type, payload);\r\n  switch (type) {\r\n    // VIS_CONFIG_COMPILED\r\n    case actionTypes.VIS_CONFIG_COMPILED:\r\n      return actions.visConfigCompiled(state, payload);\r\n    // FILTER_DATA\r\n    case actionTypes.FILTER_DATA:\r\n      return actions.filterData(state, payload);\r\n    // SET_CALLBACKS\r\n    case actionTypes.SET_CALLBACKS:\r\n      return actions.setCallbacks(state, payload);\r\n    // MARK_SELECTED\r\n    case actionTypes.MARK_SELECTED:\r\n      return actions.markSelected(state, payload);\r\n    // SET_SELECTION\r\n    case actionTypes.SET_SELECTION:\r\n      return actions.setSelection(state, payload);\r\n    // SET_FILTERS\r\n    case actionTypes.SET_FILTERS:\r\n      return actions.setFilters(state, payload);\r\n    // SET_ADDITIONAL_FILTERS\r\n    case actionTypes.SET_ADDITIONAL_FILTERS:\r\n      return actions.setAdditionalFilters(state, payload);\r\n    // SET_OPTIONS\r\n    case actionTypes.SET_OPTIONS:\r\n      return actions.setOptions(state, payload);\r\n    default:\r\n      log.debug(`reducer - Unknown action type: ${type}`);\r\n      break;\r\n  }\r\n};\r\n\r\nexport default reducer;\r\n","export default {\r\n  compiledConfig: null,\r\n  parsedDataset: null,\r\n  filteredDataset: null,\r\n  domainMap: null,\r\n  scales: null,\r\n  selection: { dataMap: new Map(), values: [], marks: [] }\r\n};\r\n","import React from 'react';\r\n\r\nconst DispatchContext = React.createContext(null);\r\n\r\nexport default DispatchContext;\r\n","import * as d3 from 'd3';\r\nimport * as moment from 'moment';\r\n\r\nimport { defaults } from './defaults';\r\nimport { log } from '../utils';\r\n\r\n// Moment default export\r\nconst _moment = moment.default;\r\n\r\n/**\r\n * @name parseDataset\r\n * @description VRIA Dataset parser\r\n * @author Peter Butcher <pete@pbutcher.uk>\r\n * @param {object} config - VRIA vis-config file as JSON\r\n * @returns {object}\r\n */\r\nfunction parseDataset(config) {\r\n  // Get data and views objects from vis-config\r\n  const { data, views } = config;\r\n\r\n  // Only perform dataset transforms on fields used in this vis-config\r\n  const uniqueFields = new Set();\r\n  const encodingMap = new Map();\r\n  views.forEach((view) => {\r\n    Object.keys(view.encoding).forEach((channel) => {\r\n      if (!uniqueFields.has(view.encoding[channel].field)) {\r\n        uniqueFields.add(view.encoding[channel].field);\r\n        encodingMap.set(view.encoding[channel].field, view.encoding[channel]);\r\n      }\r\n    });\r\n  });\r\n\r\n  // Supported dataset file types\r\n  const SUPPORTED_FILE_TYPES = ['csv', 'json', 'txt', 'text'];\r\n\r\n  // Get file type of dataset\r\n  const FILE_TYPE =\r\n    typeof data.url === 'string'\r\n      ? data.url.split('.').pop().toLowerCase()\r\n      : 'json';\r\n\r\n  // Transformed dataset\r\n  let transformedDataset;\r\n\r\n  // Load datasets with d3\r\n  if (SUPPORTED_FILE_TYPES.includes(FILE_TYPE)) {\r\n    switch (FILE_TYPE) {\r\n      case 'txt':\r\n      case 'text':\r\n      case 'csv':\r\n        try {\r\n          transformedDataset = d3.csv(data.url, (row) =>\r\n            _transformRow(row, encodingMap)\r\n          );\r\n        } catch (err) {\r\n          log.error(\r\n            `parseDataset - Error parsing dataset as ${FILE_TYPE}`,\r\n            err\r\n          );\r\n        }\r\n        break;\r\n      case 'json':\r\n      default:\r\n        try {\r\n          if (typeof data.url === 'string') {\r\n            transformedDataset = d3\r\n              .json(data.url)\r\n              .then((d) => d.map((row) => _transformRow(row, encodingMap)));\r\n          } else if (typeof data.values === 'object') {\r\n            transformedDataset = Promise.resolve(\r\n              data.values.map((row) => _transformRow(row, encodingMap))\r\n            );\r\n          }\r\n        } catch (err) {\r\n          log.error('parseDataset - Error parsing dataset as JSON', err);\r\n        }\r\n        break;\r\n    }\r\n  } else {\r\n    log.error(\r\n      `parseDataset - Error parsing dataset. Unsupported file type: ${FILE_TYPE}`\r\n    );\r\n  }\r\n\r\n  return {\r\n    dataset: transformedDataset,\r\n    uniqueFields\r\n  };\r\n}\r\n\r\n/**\r\n * @name _transformRow\r\n * @private\r\n * @description Perform data transformations on each row of a dataset\r\n * @author Peter Butcher <pete@pbutcher.uk>\r\n * @param {object} row - A row of a parsed dataset\r\n * @param {object} encodingMap - All encodings used in this vis-config\r\n * @returns {object} A transformed row\r\n */\r\nfunction _transformRow(row, encodingMap) {\r\n  encodingMap.forEach((encoding) => {\r\n    switch (encoding.type) {\r\n      // Transform quantitative fields\r\n      case 'quantitative':\r\n        if (typeof row[encoding.field] === 'string') {\r\n          // Parsed as string\r\n          if (row[encoding.field] === '') {\r\n            // Set missing data to 0\r\n            // TODO: Remove, flag or otherwise process missing values somehow?\r\n            row[encoding.field] = 0;\r\n          } else {\r\n            // Ensure radix character is period and not comma (, => .)\r\n            // Also parse as float...\r\n            row[encoding.field] = +parseFloat(\r\n              row[encoding.field].replace(',', '.')\r\n            );\r\n          }\r\n        } else {\r\n          // Parsed as number...\r\n          row[encoding.field] = +row[encoding.field];\r\n        }\r\n        break;\r\n      // Transform temporal fields\r\n      case 'temporal':\r\n        // Transform date if timeUnit is supplied\r\n        // TODO: Consider insisting on moment formats rather than Vega-Lite?\r\n        // TODO: Consider not altering the original dataset?\r\n        if (encoding.timeUnit) {\r\n          // Default timeUnits can be set in (grammar/defaults)\r\n          const { timeUnit: dfTimeUnit } = defaults.view.encoding;\r\n          const timeUnits = new Map([\r\n            ['year', dfTimeUnit.year],\r\n            ['quarter', dfTimeUnit.quarter],\r\n            ['month', dfTimeUnit.month],\r\n            ['date', dfTimeUnit.date],\r\n            ['week', dfTimeUnit.week],\r\n            ['day', dfTimeUnit.day],\r\n            ['dayofyear', dfTimeUnit.dayofyear],\r\n            ['hours', dfTimeUnit.hours],\r\n            ['minutes', dfTimeUnit.minutes],\r\n            ['seconds', dfTimeUnit.seconds],\r\n            ['milliseconds', dfTimeUnit.milliseconds]\r\n          ]);\r\n          const timeUnit = timeUnits.get(encoding.timeUnit);\r\n          row[encoding.field] = _moment(\r\n            new Date(row[encoding.field].toString())\r\n          ).format(timeUnit);\r\n        } else {\r\n          if (typeof row[encoding.field] !== 'string')\r\n            row[encoding.field] = row[encoding.field].toString();\r\n        }\r\n        break;\r\n      // Transform nominal fields\r\n      case 'nominal':\r\n        if (typeof row[encoding.field] !== 'string')\r\n          row[encoding.field] = row[encoding.field].toString();\r\n        break;\r\n      // Transform ordinal fields\r\n      case 'ordinal':\r\n        if (typeof row[encoding.field] !== 'string')\r\n          row[encoding.field] = row[encoding.field].toString();\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  });\r\n  return row;\r\n}\r\n\r\nexport default parseDataset;\r\n","import Ajv from 'ajv';\r\n\r\nimport { log } from '../utils';\r\nimport schema from './schema';\r\n\r\n/**\r\n * @name validateVisConfig\r\n * @description VRIA vis-config JSON Schema validator\r\n * @author Peter Butcher <pete@pbutcher.uk>\r\n * @param {object} config - VRIA vis-config file as JSON\r\n */\r\nfunction validateVisConfig(config) {\r\n  // config must be an object\r\n  if (typeof config !== 'object') {\r\n    log.error(\r\n      `ValidateVisConfig - Malformed vis-config passed to validator. Expected type: 'object', got '${typeof config}'.`\r\n    );\r\n  }\r\n\r\n  // Validate vis-config against VRIA JSON Schema\r\n  // - VRIA JSON Schemas are filed under src/grammar/schema/\r\n  // - VRIA vis-config validation uses the Ajv JSON Schema Validator.\r\n  // - Defaults are not applied to nested properties or $refs in Ajv and therefore no defaults should be specified in the schema.\r\n  // - - This is a noted limitation of Ajv, so defaults for all properties are added after schema validation.\r\n\r\n  const ajv = new Ajv({ useDefaults: false, jsonPointers: true });\r\n  const validate = ajv.compile(schema);\r\n  const valid = validate(config);\r\n\r\n  if (valid) {\r\n    log.debug(`ValidateVisConfig - vis-config successfully validated`, config);\r\n  } else {\r\n    log.error(\r\n      `ValidateVisConfig - vis-config validation failed`,\r\n      ajv.errorsText(validate.errors),\r\n      validate.errors\r\n    );\r\n  }\r\n\r\n  return valid;\r\n}\r\n\r\nexport default validateVisConfig;\r\n","import cloneDeep from 'lodash/cloneDeep';\r\nimport * as d3 from 'd3';\r\n\r\nimport validateVisConfig from './validateVisConfig';\r\nimport parseDataset from './parseDataset';\r\nimport { defaults } from './defaults';\r\nimport { log } from '../utils';\r\n\r\n/**\r\n * @name compileVisConfig\r\n * @description VRIA vis-config compiler\r\n * @author Peter Butcher <pete@pbutcher.uk>\r\n * @param {object} config - VRIA vis-config file as JSON\r\n * @param {boolean} validated - true if the vis-config has already been validated\r\n * @returns {object} Promise containing compiled vis-config, dataset, scales and encodings\r\n */\r\nfunction compileVisConfig(config, additionalFilters = [], validated = false) {\r\n  // vis-config must be an object\r\n  if (typeof config !== 'object') {\r\n    log.error(\r\n      `compileVisConfig - Malformed vis-config passed to compiler. Expected type: 'object', got '${typeof config}'.`\r\n    );\r\n  }\r\n\r\n  // Validate config if it has not already been\r\n  let valid = false;\r\n  if (validated) {\r\n    valid = true;\r\n  } else {\r\n    try {\r\n      valid = validateVisConfig(config);\r\n    } catch (error) {\r\n      log.error(error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // This will contain the compiled vis-config\r\n  let compiledConfig;\r\n\r\n  // This will contain the domain of active fields in this vis-config\r\n  const domainMap = new Map();\r\n\r\n  // The original vis-config must pass validation before it can be compiled\r\n  if (valid) {\r\n    // The remainder of this function creates a complete VRIA vis-config\r\n    // Missing values are inferred from defaults (grammar/defaults), the dataset\r\n    // and the vis-config itself.\r\n\r\n    // Views (config.views)\r\n    // - If a view does not exist, create one and move properties inside\r\n    if (config.views === undefined) {\r\n      compiledConfig = {\r\n        data: cloneDeep(config.data),\r\n        title: config.title,\r\n        views: [cloneDeep(config)]\r\n      };\r\n      delete compiledConfig.views[0].data;\r\n    } else {\r\n      // If views object exists, clone the original config\r\n      compiledConfig = cloneDeep(config);\r\n    }\r\n\r\n    // Parse dataset\r\n    // - The dataset is parsed after the vis-config views are normalised\r\n    // - Parsing includes loading the dataset and returning a Set() of unique fields\r\n    // - Once parsed, defaults can be inferred\r\n    const { dataset } = parseDataset(compiledConfig);\r\n    return dataset.then((d) => {\r\n      // Resulting domains, ranges and scales\r\n      const allScales = [];\r\n\r\n      // Infer defaults for each view\r\n      compiledConfig.views.forEach((view, i) => {\r\n        // --------------------\r\n        // Top level view properties\r\n        // - Copy over top level properties and assign defaults\r\n        ['x', 'y', 'z', 'width', 'height', 'depth', 'titlePadding'].forEach(\r\n          (el) => {\r\n            if (view[el] === undefined) {\r\n              compiledConfig.views[i][el] = defaults.view[el];\r\n            }\r\n          }\r\n        );\r\n\r\n        // Top level shorthand view properties\r\n        // - Replace shorthands with full property names\r\n        [\r\n          ['xrot', 'xrotation'],\r\n          ['yrot', 'yrotation'],\r\n          ['zrot', 'zrotation']\r\n        ].forEach((el) => {\r\n          if (view[el[0]] !== undefined) {\r\n            compiledConfig.views[i][el[1]] = cloneDeep(view[el[0]]);\r\n            delete compiledConfig.views[i][el[0]];\r\n          } else if (view[el[0]] === undefined && view[el[1]] === undefined) {\r\n            compiledConfig.views[i][el[1]] = defaults.view[el[1]];\r\n          }\r\n        });\r\n\r\n        // --------------------\r\n        // Mark (views[].mark)\r\n        // - Get the mark type from mark object or string\r\n        // - VRIA currently supports 2 mark types: bar and point\r\n        // - These types are assigned shape primitives\r\n\r\n        // Mark Type (views[].mark | views[].mark.type)\r\n        const markType = view.mark.type ?? view.mark;\r\n\r\n        // Mark Shape (views[].mark.shape)\r\n        // - Default shapes are based on the mark type\r\n        let markShape;\r\n        switch (markType) {\r\n          case 'bar':\r\n            markShape = view.mark.shape ?? defaults.view.mark.bar.shape;\r\n            break;\r\n          case 'point':\r\n          default:\r\n            markShape = view.mark.shape ?? defaults.view.mark.point.shape;\r\n            break;\r\n        }\r\n\r\n        // Mark Tooltip (views[].mark.tooltip)\r\n        // - Set the mark tooltip\r\n        let markTooltip;\r\n        if (typeof view.mark.tooltip === 'object') {\r\n          markTooltip = view.mark.tooltip;\r\n        } else if (view.mark.tooltip === true) {\r\n          markTooltip = defaults.view.mark.tooltip.on;\r\n        } else {\r\n          markTooltip = false;\r\n        }\r\n\r\n        // Replace existing mark config with compiled mark object\r\n        compiledConfig.views[i].mark = {\r\n          type: markType,\r\n          shape: markShape,\r\n          tooltip: markTooltip\r\n        };\r\n\r\n        // --------------------\r\n        // Encoding (views[].encoding[channel])\r\n        // - View encoding channels\r\n        // - NOTE: timeUnit and numberFormat are optional and are not compiled\r\n\r\n        // --------------------\r\n        // Scale range (views[].encoding[channel].scale.range)\r\n        // - Get the range from each encoding channel\r\n        const ranges = _getRanges(compiledConfig.views[i], d);\r\n\r\n        // Add channel properties\r\n        Object.keys(view.encoding).forEach((el) => {\r\n          // Add scale object if one does not exist\r\n          if (view.encoding[el].scale === undefined) {\r\n            compiledConfig.views[i].encoding[el].scale = {};\r\n          }\r\n\r\n          // Only add range if this encoding channel is not a constant\r\n          if (view.encoding[el].value === undefined) {\r\n            // Add range\r\n            compiledConfig.views[i].encoding[el].scale.range = ranges[el];\r\n          }\r\n\r\n          // --------------------\r\n          // Scheme (views[].encoding[channel].scale.scheme)\r\n          // - If this is a colour scale, it should have a scheme\r\n          // - The scheme contains a named scale range or an array of colours\r\n          if (el === 'color') {\r\n            // If a scheme is provided, validate it\r\n            if (\r\n              view.encoding[el].scale.scheme === 'string' &&\r\n              d3[view.encoding[el].scale.scheme] === undefined\r\n            ) {\r\n              log.error(\r\n                `compileVisConfig - Invalid scheme: ${view.encoding[el].scale.scheme} - VRIA accepts schemes from d3-scale-chromatic: https://github.com/d3/d3-scale-chromatic, or an array of colours`\r\n              );\r\n            }\r\n\r\n            // If the range is a string, it is a colour scale, do a lookup\r\n            // If the range is a string but the scheme is already set, ignore range\r\n            if (\r\n              typeof view.encoding[el].scale.range === 'string' &&\r\n              view.encoding[el].scale.scheme === undefined\r\n            ) {\r\n              compiledConfig.views[i].encoding[el].scale.scheme =\r\n                defaults.view.encoding.scale.scheme[\r\n                  defaults.view.encoding.scale.range.color[\r\n                    view.encoding[el].type\r\n                  ]\r\n                ];\r\n            }\r\n          }\r\n\r\n          // --------------------\r\n          // Nice (views[].encoding[channel].scale.nice)\r\n          // - Nice the scale, never nice non-quantitative scales\r\n          if (\r\n            view.encoding[el].type === 'quantitative' &&\r\n            view.encoding[el].scale.nice === undefined\r\n          ) {\r\n            compiledConfig.views[i].encoding[el].scale.nice =\r\n              defaults.view.encoding.scale.nice;\r\n          }\r\n\r\n          // --------------------\r\n          // Zero (views[].encoding[channel].scale.zero)\r\n          // - Scale starts from zero, never zero non-quantitative scales\r\n          if (\r\n            view.encoding[el].type === 'quantitative' &&\r\n            view.encoding[el].scale.zero === undefined\r\n          ) {\r\n            compiledConfig.views[i].encoding[el].scale.zero =\r\n              defaults.view.encoding.scale.zero;\r\n          }\r\n\r\n          // Scale padding (only x, y, or z and non-quantitative fields)\r\n          if (\r\n            ['x', 'y', 'z'].includes(el) &&\r\n            view.encoding[el].type !== 'quantitative'\r\n          ) {\r\n            // --------------------\r\n            // Padding inner (views[].encoding[channel].scale.paddingInner)\r\n            // - Sets padding inner to band scales\r\n            if (view.encoding[el].scale.paddingInner === undefined) {\r\n              compiledConfig.views[i].encoding[el].scale.paddingInner =\r\n                defaults.view.encoding.scale.paddingInner;\r\n            }\r\n            // --------------------\r\n            // Padding outer (views[].encoding[channel].scale.paddingOuter)\r\n            // - Sets padding outer to band scales, sets padding to point scales\r\n            if (view.encoding[el].scale.paddingOuter === undefined) {\r\n              compiledConfig.views[i].encoding[el].scale.paddingOuter =\r\n                defaults.view.encoding.scale.paddingOuter;\r\n            }\r\n          }\r\n\r\n          // --------------------\r\n          // Axis (views[].encoding[channel].axis)\r\n          // - Set axis properties\r\n\r\n          // Only applies to x, y and z channels\r\n          // TODO: Instead of using if statements, use object spread instead?\r\n          if (\r\n            ['x', 'y', 'z'].includes(el) &&\r\n            view.encoding[el]?.axis !== false\r\n          ) {\r\n            // Add axis object if one does not exist\r\n            if (view.encoding[el].axis === undefined) {\r\n              compiledConfig.views[i].encoding[el].axis = {};\r\n            }\r\n\r\n            // --------------------\r\n            // Axis title (views[].encoding[channel].axis.title)\r\n            // - Set axis title to field name if not specified\r\n            if (view.encoding[el].axis.title === undefined) {\r\n              compiledConfig.views[i].encoding[el].axis.title =\r\n                view.encoding[el].field;\r\n            }\r\n\r\n            // --------------------\r\n            // Axis title padding (views[].encoding[channel].axis.titlePadding)\r\n            // - Set axis title padding if not specified\r\n            if (view.encoding[el].axis.titlePadding === undefined) {\r\n              compiledConfig.views[i].encoding[el].axis.titlePadding =\r\n                defaults.view.encoding.axis.titlePadding;\r\n            }\r\n\r\n            // --------------------\r\n            // Axis filter (views[].encoding[channel].axis.filter)\r\n            // - Set axis filter on or off\r\n            if (view.encoding[el].axis.filter === undefined) {\r\n              compiledConfig.views[i].encoding[el].axis.filter =\r\n                defaults.view.encoding.axis.filter;\r\n            }\r\n\r\n            // --------------------\r\n            // Axis face (views[].encoding[channel].axis.face)\r\n            // - Set axis face\r\n            if (view.encoding[el].axis.face === undefined) {\r\n              compiledConfig.views[i].encoding[el].axis.face =\r\n                defaults.view.encoding.axis.face[el];\r\n            }\r\n\r\n            // --------------------\r\n            // Axis orient (views[].encoding[channel].axis.orient)\r\n            // - Set axis orient\r\n            if (view.encoding[el].axis.orient === undefined) {\r\n              compiledConfig.views[i].encoding[el].axis.orient =\r\n                defaults.view.encoding.axis.orient[el];\r\n            }\r\n\r\n            // --------------------\r\n            // Axis ticks (views[].encoding[channel].axis.ticks)\r\n            // - Set axis tick visibility\r\n            if (view.encoding[el].axis.ticks === undefined) {\r\n              compiledConfig.views[i].encoding[el].axis.ticks =\r\n                defaults.view.encoding.axis.ticks;\r\n            }\r\n\r\n            // --------------------\r\n            // Axis tick count (views[].encoding[channel].axis.tickCount)\r\n            // - Set axis tick count\r\n            if (view.encoding[el].axis.tickCount === undefined) {\r\n              compiledConfig.views[i].encoding[el].axis.tickCount =\r\n                defaults.view.encoding.axis.tickCount;\r\n            }\r\n\r\n            // --------------------\r\n            // Axis labels (views[].encoding[channel].axis.labels)\r\n            // - Set axis label visability\r\n            if (view.encoding[el].axis.labels === undefined) {\r\n              compiledConfig.views[i].encoding[el].axis.labels =\r\n                defaults.view.encoding.axis.labels;\r\n            }\r\n          }\r\n\r\n          // --------------------\r\n          // Legend (views[].encoding[channel].legend)\r\n          // - Set legend properties\r\n          // - By default, legends are added\r\n\r\n          // TODO: Instead of using if statements, use object spread instead?\r\n          if (\r\n            [\r\n              'width',\r\n              'height',\r\n              'depth',\r\n              'xoffset',\r\n              'yoffset',\r\n              'zoffset',\r\n              'xrotation',\r\n              'yrotation',\r\n              'zrotation',\r\n              'size',\r\n              'color',\r\n              'opacity',\r\n              'length',\r\n              'shape'\r\n            ].includes(el) &&\r\n            view.encoding[el].legend !== false &&\r\n            view.encoding[el].value === undefined\r\n          ) {\r\n            // Add axis object if one does not exist or is set to true\r\n            if (\r\n              view.encoding[el].legend === undefined ||\r\n              view.encoding[el].legend === true\r\n            ) {\r\n              compiledConfig.views[i].encoding[el].legend = {};\r\n            }\r\n\r\n            // --------------------\r\n            // Legend title (views[].encoding[channel].legend.title)\r\n            // - Set legend title to field name if not specified\r\n            if (view.encoding[el].legend === undefined) {\r\n              compiledConfig.views[i].encoding[el].legend =\r\n                view.encoding[el].field;\r\n            }\r\n\r\n            // --------------------\r\n            // Legend filter (views[].encoding[channel].legend.filter)\r\n            // - Set legend filter on or off\r\n            if (view.encoding[el].legend.filter === undefined) {\r\n              compiledConfig.views[i].encoding[el].legend.filter =\r\n                defaults.view.encoding.legend.filter;\r\n            }\r\n\r\n            // --------------------\r\n            // Legend face (views[].encoding[channel].legend.face)\r\n            // - Set legend face\r\n            if (view.encoding[el].legend.face === undefined) {\r\n              if (view.encoding[el].type === 'quantitative' && el === 'color') {\r\n                compiledConfig.views[i].encoding[el].legend.face =\r\n                  defaults.view.encoding.legend.type.gradient.face;\r\n              } else {\r\n                compiledConfig.views[i].encoding[el].legend.face =\r\n                  defaults.view.encoding.legend.type.symbol.face;\r\n              }\r\n            }\r\n\r\n            // --------------------\r\n            // Legend orient (views[].encoding[channel].legend.orient)\r\n            // - Set legend orient\r\n            if (view.encoding[el].legend.orient === undefined) {\r\n              if (view.encoding[el].type === 'quantitative' && el === 'color') {\r\n                compiledConfig.views[i].encoding[el].legend.orient =\r\n                  defaults.view.encoding.legend.type.gradient.orient;\r\n              } else {\r\n                compiledConfig.views[i].encoding[el].legend.orient =\r\n                  defaults.view.encoding.legend.type.symbol.orient;\r\n              }\r\n            }\r\n\r\n            // --------------------\r\n            // Legend ticks (views[].encoding[channel].legend.ticks)\r\n            // - Set legend tick visibility\r\n            if (view.encoding[el].legend.ticks === undefined) {\r\n              compiledConfig.views[i].encoding[el].legend.ticks =\r\n                defaults.view.encoding.legend.ticks;\r\n            }\r\n\r\n            // --------------------\r\n            // Legend tick count (views[].encoding[channel].legend.tickCount)\r\n            // - Set legend tick count\r\n            if (view.encoding[el].legend.tickCount === undefined) {\r\n              compiledConfig.views[i].encoding[el].legend.tickCount =\r\n                defaults.view.encoding.legend.tickCount;\r\n            }\r\n\r\n            // --------------------\r\n            // Legend x position\r\n            // - Set legend x position\r\n            if (view.encoding[el].legend.x === undefined) {\r\n              compiledConfig.views[i].encoding[el].legend.x =\r\n                defaults.view.encoding.legend.x;\r\n            }\r\n\r\n            // --------------------\r\n            // Legend y position\r\n            // - Set legend y position\r\n            if (view.encoding[el].legend.y === undefined) {\r\n              compiledConfig.views[i].encoding[el].legend.y =\r\n                defaults.view.encoding.legend.y;\r\n            }\r\n\r\n            // --------------------\r\n            // Legend z position\r\n            // - Set legend z position\r\n            if (view.encoding[el].legend.z === undefined) {\r\n              compiledConfig.views[i].encoding[el].legend.z =\r\n                defaults.view.encoding.legend.z;\r\n            }\r\n\r\n            // --------------------\r\n            // Legend x rotation\r\n            // - Set legend x rotation\r\n            if (view.encoding[el].legend.xrotation === undefined) {\r\n              compiledConfig.views[i].encoding[el].legend.xrotation =\r\n                defaults.view.encoding.legend.xrotation;\r\n            }\r\n\r\n            // --------------------\r\n            // Legend y rotation\r\n            // - Set legend y rotation\r\n            if (view.encoding[el].legend.yrotation === undefined) {\r\n              compiledConfig.views[i].encoding[el].legend.yrotation =\r\n                defaults.view.encoding.legend.yrotation;\r\n            }\r\n\r\n            // --------------------\r\n            // Legend z rotation\r\n            // - Set legend z rotation\r\n            if (view.encoding[el].legend.zrotation === undefined) {\r\n              compiledConfig.views[i].encoding[el].legend.zrotation =\r\n                defaults.view.encoding.legend.zrotation;\r\n            }\r\n          }\r\n        });\r\n\r\n        // --------------------\r\n        // Scale domain (views[].encoding[channel].scale.domain)\r\n        // - Get the domain from each encoding channel in this view\r\n        // - This function also returns a Map() of field:domain for filtering and API use\r\n        const { domains } = _getDomains(compiledConfig.views[i], d);\r\n\r\n        // Scales\r\n        // - Using domains and ranges to produce scale functions\r\n        // - These scale functions are for mapping data and are not added to the config\r\n        const scales = _getScales(compiledConfig.views[i], domains, ranges);\r\n        allScales.push(scales);\r\n\r\n        // Add domain to compiled config\r\n        // This also stores the domain of each field used in this view in a Map()\r\n        // This is necessary because some domains will have been niced or zeroed\r\n        Object.keys(view.encoding).forEach((el) => {\r\n          // If this encoding has a field (excluding constant channels)\r\n          if (view.encoding[el].value === undefined) {\r\n            // Add domain to compiled config\r\n            // compiledConfig.views[i].encoding[el].scale.domain = domains[el];\r\n            compiledConfig.views[i].encoding[el].scale.domain = allScales[i][\r\n              el\r\n            ].domain();\r\n            // Add domain to domain map\r\n            domainMap.set(view.encoding[el].field, allScales[i][el].domain());\r\n          }\r\n        });\r\n      });\r\n\r\n      // Set additional filters to domain map\r\n      if (additionalFilters) {\r\n        additionalFilters.forEach((f) => {\r\n          const values = d.map((row) => row[f.field]);\r\n          domainMap.set(\r\n            f.field,\r\n            f.domain ||\r\n              (f.type === 'quantitative'\r\n                ? f.zero\r\n                  ? [0, d3.max(values)]\r\n                  : d3.extent(values)\r\n                : [...new Set(values)])\r\n          );\r\n        });\r\n      }\r\n\r\n      return {\r\n        dataset: d,\r\n        compiledConfig,\r\n        domainMap,\r\n        scales: allScales\r\n      };\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * @name _getDomains\r\n * @private\r\n * @description Get the domains of each encoding channel in a view\r\n * @author Peter Butcher <pete@pbutcher.uk>\r\n * @param {object} view - Set domains for each encoding channel in this view\r\n * @param {object} dataset - Dataset from which to retrieve domains\r\n * @returns {object} Domains\r\n */\r\nfunction _getDomains(view, dataset) {\r\n  const { encoding } = view;\r\n  const domains = {};\r\n  const domainsWithFields = {};\r\n  const channelFields = {};\r\n  Object.keys(encoding).forEach((channel) => {\r\n    // This channel's domain;\r\n    let domain;\r\n    // If a domain is specified in the vis-config\r\n    if (encoding[channel].scale?.domain) {\r\n      domain = encoding[channel].scale.domain;\r\n    } else if (encoding[channel]?.value) {\r\n      domain = encoding[channel]?.value;\r\n    } else {\r\n      const values = dataset.map((row) => row[encoding[channel].field]);\r\n      switch (encoding[channel].type) {\r\n        case 'quantitative':\r\n          // Should the domain start from zero?\r\n          if (encoding[channel].scale?.zero === true) {\r\n            domain = [0, d3.max(values)];\r\n          } else {\r\n            domain = d3.extent(values);\r\n          }\r\n          break;\r\n        case 'temporal':\r\n        case 'nominal':\r\n        case 'ordinal':\r\n        default:\r\n          domain = [...new Set(values)];\r\n          break;\r\n      }\r\n    }\r\n    domains[channel] = domain;\r\n    domainsWithFields[encoding[channel].field] = domain;\r\n    channelFields[channel] = encoding[channel].field;\r\n  });\r\n  return { domains, domainsWithFields, channelFields };\r\n}\r\n\r\n/**\r\n * @name _getRanges\r\n * @private\r\n * @description Get the ranges of each encoding channel in a view\r\n * @author Peter Butcher <pete@pbutcher.uk>\r\n * @param {object} view - Set range for each encoding channel in this view\r\n * @returns {object} Ranges\r\n */\r\nfunction _getRanges(view) {\r\n  const { encoding } = view;\r\n  const ranges = {};\r\n  Object.keys(encoding).forEach((channel) => {\r\n    // This channel's range\r\n    let range;\r\n    // If a range is specified in the vis-config\r\n    if (encoding[channel].scale?.range) {\r\n      // Use this range\r\n      range = encoding[channel].scale.range;\r\n    } else {\r\n      // If the range is not specified, do a lookup\r\n      switch (channel) {\r\n        case 'x':\r\n        case 'width':\r\n          range = [0, view.width];\r\n          break;\r\n        case 'y':\r\n        case 'height':\r\n          range = [0, view.height];\r\n          break;\r\n        case 'z':\r\n        case 'depth':\r\n          range = [0, view.depth];\r\n          break;\r\n        case 'size':\r\n          range = defaults.view.encoding.scale.range.size;\r\n          break;\r\n        case 'opacity':\r\n          range = [0, 1];\r\n          break;\r\n        case 'length':\r\n          range = defaults.view.encoding.scale.range.length;\r\n          break;\r\n        case 'color':\r\n          range =\r\n            defaults.view.encoding.scale.range.color[encoding[channel].type];\r\n          break;\r\n        case 'shape':\r\n          range = defaults.view.encoding.scale.range.shape;\r\n          break;\r\n        case 'xrotation':\r\n        case 'yrotation':\r\n        case 'zrotation':\r\n          range = defaults.view.encoding.scale.range.rotation;\r\n          break;\r\n        case 'xoffset':\r\n        case 'yoffset':\r\n        case 'zoffset':\r\n          range = defaults.view.encoding.scale.range.offset;\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n    ranges[channel] = range;\r\n  });\r\n  return ranges;\r\n}\r\n\r\n/**\r\n * @name _getScales\r\n * @private\r\n * @description Generate scale functions of each encoding channel in each view\r\n * @author Peter Butcher <pete@pbutcher.uk>\r\n * @param {object} view - Generate scale functions for encoding channels in this view\r\n * @param {object} domains - Data domaisn\r\n * @param {object} ranges - Data ranges\r\n * @returns {object} Scales\r\n */\r\nfunction _getScales(view, domains, ranges) {\r\n  const { encoding } = view;\r\n  const scales = {};\r\n  Object.keys(encoding).forEach((channel) => {\r\n    // This channel's scale\r\n    let scale;\r\n    // Create scales for each channel based on encoding type\r\n    if (encoding[channel].value) {\r\n      scale = () => encoding[channel].value;\r\n    } else {\r\n      switch (encoding[channel].type) {\r\n        case 'quantitative':\r\n          switch (channel) {\r\n            case 'color':\r\n              // If a scheme is defined, use that scheme\r\n              if (encoding[channel]?.scale?.scheme !== undefined) {\r\n                if (typeof encoding[channel].scale?.scheme === 'string') {\r\n                  // Scheme is a string\r\n                  scale = d3\r\n                    .scaleSequential()\r\n                    .domain(domains[channel])\r\n                    .interpolator(d3[encoding[channel].scale?.scheme]);\r\n                } else {\r\n                  // Scheme is an array\r\n                  scale = d3\r\n                    .scaleLinear()\r\n                    .domain(domains[channel])\r\n                    .range(encoding[channel].scale?.scheme);\r\n                }\r\n              }\r\n              break;\r\n            default:\r\n              // Default scale\r\n              scale = d3\r\n                .scaleLinear()\r\n                .domain(domains[channel])\r\n                .range(ranges[channel]);\r\n              break;\r\n          }\r\n          break;\r\n        case 'temporal':\r\n        case 'nominal':\r\n        case 'ordinal':\r\n        default: {\r\n          // Set padding inner and outer from config or defaults\r\n          // Padding outer acts as padding for scalePoint\r\n          const paddingInner = encoding[channel].scale.paddingInner;\r\n          const paddingOuter = encoding[channel].scale.paddingOuter;\r\n\r\n          switch (channel) {\r\n            case 'x':\r\n            case 'y':\r\n            case 'z':\r\n              switch (view.mark.type) {\r\n                case 'bar':\r\n                  scale = d3\r\n                    .scaleBand()\r\n                    .domain(domains[channel])\r\n                    .paddingInner(paddingInner)\r\n                    .paddingOuter(paddingOuter)\r\n                    .range(ranges[channel]);\r\n                  break;\r\n                case 'point':\r\n                  scale = d3\r\n                    .scalePoint()\r\n                    .domain(domains[channel])\r\n                    .padding(paddingOuter)\r\n                    .range(ranges[channel]);\r\n                  break;\r\n                default:\r\n                  break;\r\n              }\r\n              break;\r\n            case 'color':\r\n              if (encoding[channel].scale?.scheme !== undefined) {\r\n                if (typeof encoding[channel].scale?.scheme === 'string') {\r\n                  // Scheme is a string\r\n                  scale = d3\r\n                    .scaleOrdinal()\r\n                    .domain(domains[channel])\r\n                    .range(d3[encoding[channel].scale?.scheme]);\r\n                } else {\r\n                  // Scheme is an array\r\n                  scale = d3\r\n                    .scaleOrdinal()\r\n                    .domain(domains[channel])\r\n                    .range(encoding[channel].scale?.scheme);\r\n                }\r\n              }\r\n              break;\r\n            case 'shape':\r\n              scale = d3\r\n                .scaleOrdinal()\r\n                .domain(domains[channel])\r\n                .range(encoding[channel].scale.range);\r\n              break;\r\n            default:\r\n              scale = d3\r\n                .scaleOrdinal()\r\n                .domain(domains[channel])\r\n                .range(ranges[channel]);\r\n              break;\r\n          }\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Nice the scale\r\n    if (encoding[channel].scale?.nice === true) {\r\n      scale = scale.nice();\r\n    }\r\n\r\n    scales[channel] = scale;\r\n  });\r\n  return scales;\r\n}\r\n\r\nexport default compileVisConfig;\r\n","import React from 'react';\r\nimport { Entity } from 'aframe-react';\r\nimport * as d3 from 'd3';\r\n\r\nconst GradientLegend = ({\r\n  options,\r\n  channel,\r\n  scales,\r\n  color,\r\n  legendTitle,\r\n  posrot\r\n}) => {\r\n  if (channel !== 'color') return null;\r\n\r\n  const { xpos, ypos, zpos, xrot, yrot, zrot } = posrot;\r\n\r\n  const background = (\r\n    <Entity\r\n      primitive='a-plane'\r\n      width='0.3'\r\n      height='0.2'\r\n      color={options.chartColor}\r\n      opacity='0.2'\r\n      position='0 0 0'\r\n    />\r\n  );\r\n\r\n  let minValue = scales.color.domain()[0];\r\n  if (color.numberFormat !== undefined)\r\n    minValue = d3.format(color.numberFormat)(minValue);\r\n\r\n  const min = (\r\n    <Entity\r\n      primitive='a-text'\r\n      width='0.5'\r\n      value={minValue}\r\n      color={options.chartColor}\r\n      side='front'\r\n      anchor='align'\r\n      align='left'\r\n      position='-0.125 0.01 0.002'\r\n    />\r\n  );\r\n\r\n  let maxValue = scales.color.domain()[1];\r\n  if (color.numberFormat !== undefined)\r\n    maxValue = d3.format(color.numberFormat)(maxValue);\r\n\r\n  const max = (\r\n    <Entity\r\n      primitive='a-text'\r\n      width='0.5'\r\n      value={maxValue}\r\n      color={options.chartColor}\r\n      side='front'\r\n      anchor='align'\r\n      align='right'\r\n      position='0.125 0.01 0.002'\r\n    />\r\n  );\r\n\r\n  const label = (\r\n    <Entity\r\n      primitive='a-text'\r\n      width='0.5'\r\n      value={legendTitle}\r\n      color={options.chartColor}\r\n      side='front'\r\n      anchor='align'\r\n      align='center'\r\n      position='0 0.06 0.002'\r\n    />\r\n  );\r\n\r\n  const gradient = [];\r\n\r\n  let scheme;\r\n\r\n  if (typeof color?.scale?.scheme === 'string') {\r\n    scheme = d3\r\n      .scaleSequential()\r\n      .domain([0, 1])\r\n      .interpolator(d3[color.scale.scheme]);\r\n  } else {\r\n    scheme = d3.scaleLinear().domain([0, 1]).range(color.scale.scheme);\r\n  }\r\n\r\n  for (var i = 0; i < 50; i++) {\r\n    gradient.push(\r\n      <Entity\r\n        key={`gradient${i}`}\r\n        primitive='a-plane'\r\n        width='0.005'\r\n        height='0.05'\r\n        color={scheme(i / 50)}\r\n        position={`${-0.12 + 0.005 * i} -0.04 0.001`}\r\n      />\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Entity\r\n      rotation={{ x: xrot, y: yrot, z: zrot }}\r\n      position={{ x: xpos, y: ypos, z: zpos }}\r\n      className='legend'>\r\n      {background}\r\n      {label}\r\n      {min}\r\n      {max}\r\n      {gradient}\r\n    </Entity>\r\n  );\r\n};\r\n\r\nexport default GradientLegend;\r\n","import React, { useContext } from 'react';\r\nimport { Entity } from 'aframe-react';\r\nimport * as d3 from 'd3';\r\n\r\nimport { DispatchContext } from '../../../reducer';\r\nimport { actionTypes } from '../../../actions';\r\n\r\nconst SymbolLegend = ({\r\n  view,\r\n  channel,\r\n  domainMap,\r\n  customMarks,\r\n  options,\r\n  legendTitle,\r\n  scales,\r\n  posrot\r\n}) => {\r\n  if (view.encoding.color && view.encoding.shape) {\r\n    if (view.encoding.color.field === view.encoding.shape.field) {\r\n      if (channel !== 'color') return null;\r\n    }\r\n  }\r\n\r\n  const dispatch = useContext(DispatchContext);\r\n  const { xpos, ypos, zpos, xrot, yrot, zrot } = posrot;\r\n\r\n  const legendWidth = 0.25;\r\n  const legendHeight = 0.09 + scales[channel].domain().length * 0.04;\r\n  const legendYPos = legendHeight / 2 - 0.05;\r\n\r\n  const labels = scales[channel].domain().map((v, i) => {\r\n    let opacity = 1;\r\n    let isChecked = true;\r\n    const color = scales.color ? scales.color(v) : d3.schemeCategory10[0];\r\n    const shape = scales.shape ? scales.shape(v) : view.mark.shape;\r\n    const topOffset = 0.015 + legendYPos - 0.055;\r\n    const step = i * -0.04;\r\n\r\n    if (\r\n      domainMap.get(view.encoding[channel].field) &&\r\n      !domainMap\r\n        .get(view.encoding[channel].field)\r\n        .includes(scales[channel].domain()[i])\r\n    ) {\r\n      opacity = 0.5;\r\n      isChecked = false;\r\n    }\r\n\r\n    const checked = (\r\n      <Entity>\r\n        <Entity\r\n          primitive='a-plane'\r\n          width='0.004'\r\n          height='0.01'\r\n          color='#333333'\r\n          position={{\r\n            x: -0.0864,\r\n            y: topOffset - 0.003 + step,\r\n            z: 0.002\r\n          }}\r\n          rotation='0 0 45'\r\n        />\r\n        <Entity\r\n          primitive='a-plane'\r\n          width='0.004'\r\n          height='0.02'\r\n          color='#333333'\r\n          position={{\r\n            x: -0.078,\r\n            y: topOffset + step,\r\n            z: 0.002\r\n          }}\r\n          rotation='0 0 -45'\r\n        />\r\n      </Entity>\r\n    );\r\n\r\n    const checkbox = (\r\n      <Entity>\r\n        {isChecked ? checked : null}\r\n        <Entity\r\n          className='interactive'\r\n          primitive='a-plane'\r\n          width='0.025'\r\n          height='0.025'\r\n          color='#FFFFFF'\r\n          opacity='1'\r\n          position={{\r\n            x: -0.08,\r\n            y: topOffset + step,\r\n            z: 0.001\r\n          }}\r\n          events={{\r\n            mouseenter: (e) => {\r\n              e.target.setAttribute('opacity', 0.5);\r\n            },\r\n            mouseleave: (e) => {\r\n              e.target.setAttribute('opacity', 1);\r\n            },\r\n            click: (e) => {\r\n              if (e.detail !== 0) {\r\n                dispatch({\r\n                  type: actionTypes.FILTER_DATA,\r\n                  payload: {\r\n                    value: scales[channel].domain()[i],\r\n                    field: view.encoding[channel].field,\r\n                    bound: null,\r\n                    type: 'legend'\r\n                  }\r\n                });\r\n              }\r\n            }\r\n          }}\r\n        />\r\n      </Entity>\r\n    );\r\n\r\n    let mark;\r\n\r\n    switch (shape) {\r\n      case 'box': {\r\n        mark = (\r\n          <Entity\r\n            primitive='a-plane'\r\n            width='0.025'\r\n            height='0.025'\r\n            color={color}\r\n            position={{\r\n              x:\r\n                view.encoding[channel].legend?.filter !== false ? -0.04 : -0.08,\r\n              y: topOffset + step,\r\n              z: 0.001\r\n            }}\r\n            opacity={opacity}\r\n          />\r\n        );\r\n\r\n        break;\r\n      }\r\n      case 'sphere':\r\n        mark = (\r\n          <Entity\r\n            radius='0.0125'\r\n            primitive='a-circle'\r\n            color={color}\r\n            position={{\r\n              x:\r\n                view.encoding[channel].legend?.filter !== false ? -0.04 : -0.08,\r\n              y: topOffset + step,\r\n              z: 0.001\r\n            }}\r\n          />\r\n        );\r\n        break;\r\n      case 'cone':\r\n        mark = (\r\n          <Entity\r\n            primitive='a-cone'\r\n            height='0.02'\r\n            radius-top='0'\r\n            radius-bottom='0.01'\r\n            color={color}\r\n            position={{\r\n              x:\r\n                view.encoding[channel].legend?.filter !== false ? -0.04 : -0.08,\r\n              y: topOffset + step,\r\n              z: 0.001\r\n            }}\r\n          />\r\n        );\r\n        break;\r\n      case 'tetrahedron':\r\n        mark = (\r\n          <Entity\r\n            primitive='a-triangle'\r\n            scale='0.025 0.025 0.025'\r\n            color={color}\r\n            position={{\r\n              x:\r\n                view.encoding[channel].legend?.filter !== false ? -0.04 : -0.08,\r\n              y: topOffset + step,\r\n              z: 0.001\r\n            }}\r\n          />\r\n        );\r\n        break;\r\n      case 'torus':\r\n        mark = (\r\n          <Entity\r\n            primitive='a-torus'\r\n            radius='0.01'\r\n            radius-tubular='0.001'\r\n            segments-radial='18'\r\n            segments-tubular='16'\r\n            color={color}\r\n            position={{\r\n              x:\r\n                view.encoding[channel].legend?.filter !== false ? -0.04 : -0.08,\r\n              y: topOffset + step,\r\n              z: 0.001\r\n            }}\r\n          />\r\n        );\r\n        break;\r\n      case 'cylinder':\r\n        mark = (\r\n          <Entity\r\n            radius={0.01}\r\n            primitive='a-circle'\r\n            color={color}\r\n            position={{\r\n              x:\r\n                view.encoding[channel].legend?.filter !== false ? -0.04 : -0.08,\r\n              y: topOffset + step,\r\n              z: 0.001\r\n            }}\r\n          />\r\n        );\r\n        break;\r\n      default:\r\n        mark = (\r\n          <Entity\r\n            width='0.025'\r\n            height='0.025'\r\n            depth='0.025'\r\n            position={{\r\n              x:\r\n                view.encoding[channel].legend?.filter !== false ? -0.04 : -0.08,\r\n              y: topOffset + step,\r\n              z: 0.001\r\n            }}>\r\n            {customMarks[view.mark.shape]({\r\n              width: 0.025,\r\n              height: 0.025,\r\n              depth: 0.025,\r\n              size: 0.025,\r\n              radius: 0.0125,\r\n              color\r\n            })}\r\n          </Entity>\r\n        );\r\n        break;\r\n    }\r\n\r\n    return (\r\n      <Entity key={`lC${i}`}>\r\n        {mark}\r\n        {view.encoding[channel].legend?.filter !== false ? checkbox : null}\r\n        <Entity\r\n          primitive='a-text'\r\n          width='0.5'\r\n          value={scales[channel].domain()[i]}\r\n          color={options.chartColor}\r\n          side='front'\r\n          anchor='align'\r\n          align='left'\r\n          opacity={opacity}\r\n          position={{\r\n            x: view.encoding[channel].legend?.filter !== false ? -0.02 : -0.06,\r\n            y: topOffset + step,\r\n            z: 0.001\r\n          }}\r\n        />\r\n      </Entity>\r\n    );\r\n  });\r\n\r\n  return (\r\n    <Entity\r\n      primitive='a-plane'\r\n      width={legendWidth}\r\n      height={legendHeight}\r\n      color={options.chartColor}\r\n      opacity='0.2'\r\n      rotation={{ x: xrot, y: yrot, z: zrot }}\r\n      position={{ x: xpos, y: ypos, z: zpos }}>\r\n      <Entity\r\n        primitive='a-text'\r\n        width='0.5'\r\n        value={`${legendTitle}`}\r\n        color={options.chartColor}\r\n        side='front'\r\n        anchor='align'\r\n        align='left'\r\n        position={`-0.09 ${legendYPos + 0.01} 0.001`}\r\n      />\r\n      {labels}\r\n    </Entity>\r\n  );\r\n};\r\n\r\nexport default SymbolLegend;\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { Entity } from 'aframe-react';\r\n\r\nimport { log } from '../../../utils';\r\n\r\nimport GradientLegend from './GradientLegend';\r\nimport SymbolLegend from './SymbolLegend';\r\n\r\nconst Legend = (props) => {\r\n  log.debug('Legend Rendering');\r\n  // log.debug('test Rendering')\r\n  const {\r\n    view,\r\n    channel,\r\n    index,\r\n    options,\r\n    scales,\r\n    domainMap,\r\n    customMarks,\r\n    rangesMax\r\n  } = props;\r\n\r\n  // Channel encoding\r\n  const c = view.encoding[channel];\r\n\r\n  // Position\r\n  let xpos = c.legend.x || 0;\r\n  let ypos = c.legend.y || 0;\r\n  let zpos = c.legend.z || 0;\r\n\r\n  // Rotation\r\n  const xrot = c.legend.xrot || c.legend.xrotation || 0;\r\n  const yrot = c.legend.yrot || c.legend.yrotation || 0;\r\n  const zrot = c.legend.zrot || c.legend.zrotation || 0;\r\n\r\n  // Face and orientation\r\n  const { face, orient } = c.legend;\r\n\r\n  // Offsets\r\n  const xoffsetLeft = 0.2 + (view.encoding?.x?.axis?.titlePadding || 0);\r\n  const xoffsetRight = 0.2;\r\n\r\n  // Face and orient\r\n  switch (face) {\r\n    case 'front':\r\n      zpos += rangesMax.z;\r\n    // eslint-disable-next-line no-fallthrough\r\n    case 'back':\r\n      if (orient === 'bottom-left') {\r\n        xpos -= xoffsetLeft;\r\n      }\r\n      if (orient === 'left') {\r\n        ypos += rangesMax.y / 2;\r\n        xpos -= xoffsetLeft;\r\n      }\r\n      if (orient === 'top-left') {\r\n        ypos += rangesMax.y;\r\n        xpos -= xoffsetLeft;\r\n      }\r\n      if (orient === 'top') {\r\n        ypos += rangesMax.y;\r\n        xpos += rangesMax.x / 2;\r\n      }\r\n      if (orient === 'top-right') {\r\n        ypos += rangesMax.y;\r\n        xpos += rangesMax.x + xoffsetRight;\r\n      }\r\n      if (orient === 'right') {\r\n        ypos += rangesMax.y / 2;\r\n        xpos += rangesMax.x + xoffsetRight;\r\n      }\r\n      if (orient === 'bottom-right') {\r\n        xpos += rangesMax.x + xoffsetRight;\r\n      }\r\n      if (orient === 'bottom') {\r\n        xpos += rangesMax.x / 2;\r\n      }\r\n      if (orient === 'middle') {\r\n        xpos += rangesMax.x / 2;\r\n        ypos += rangesMax.y / 2;\r\n      }\r\n      break;\r\n    case 'left':\r\n      break;\r\n    case 'right':\r\n      break;\r\n    default:\r\n      break;\r\n  }\r\n\r\n  // Pos Rot\r\n  const posrot = { xpos, ypos, zpos, xrot, yrot, zrot };\r\n\r\n  // Title\r\n  const legendTitle = c.legend?.title || c.field;\r\n\r\n  // print the legend data\r\n  log.debug(posrot);\r\n  log.debug(props);\r\n  log.debug(legendTitle);\r\n\r\n\r\n  // Return legend type\r\n  return c.type === 'quantitative' ? (\r\n    <GradientLegend\r\n      options={options}\r\n      scales={scales}\r\n      color={c}\r\n      legendTitle={legendTitle}\r\n      posrot={posrot}\r\n      channel={channel}\r\n    />\r\n  ) : (\r\n    <SymbolLegend\r\n      view={view}\r\n      domainMap={domainMap}\r\n      customMarks={customMarks}\r\n      options={options}\r\n      legendTitle={legendTitle}\r\n      scales={scales}\r\n      posrot={posrot}\r\n      channel={channel}\r\n    />\r\n  );\r\n\r\n  // return <Entity rotation='0 0 0'>{generateLegend()}</Entity>;\r\n};\r\n\r\nLegend.propTypes = {\r\n  view: PropTypes.object.isRequired,\r\n  options: PropTypes.object.isRequired,\r\n  dataset: PropTypes.array.isRequired,\r\n  scales: PropTypes.object.isRequired,\r\n  domainMap: PropTypes.object.isRequired\r\n};\r\n\r\nexport default React.memo(\r\n  Legend,\r\n  (prev, next) => prev.domainMap === next.domainMap\r\n);\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { Entity } from 'aframe-react';\r\nimport * as d3 from 'd3';\r\nimport { log } from '../../../utils';\r\nimport { defaults } from '../../../grammar/defaults';\r\nimport { chartData } from '../index';\r\n\r\nconst Axis = (props) => {\r\n  const AxisLine = () => (\r\n    <Entity\r\n      opacity={props.opacity}\r\n      line={{\r\n        start: props.start,\r\n        end: props.end,\r\n        color: props.color\r\n      }}\r\n    />\r\n  );\r\n\r\n  return (\r\n    <Entity position={props.position}>\r\n      <AxisLine />\r\n      {props.ticks}\r\n      {props.tickText}\r\n      {props.title}\r\n    </Entity>\r\n  );\r\n};\r\n\r\nAxis.propTypes = {\r\n  start: PropTypes.string.isRequired,\r\n  end: PropTypes.string.isRequired,\r\n  color: PropTypes.string.isRequired,\r\n  position: PropTypes.string,\r\n  rotation: PropTypes.string\r\n};\r\n\r\nexport const XAxis = (props) => {\r\n  const {\r\n    scales,\r\n    tickOffset,\r\n    color,\r\n    tickValues,\r\n    rangesMax,\r\n    numberFormat,\r\n    title,\r\n    titlePadding,\r\n    labels,\r\n    ticks\r\n  } = props;\r\n\r\n\r\n  const axisTicks = () =>\r\n    tickValues.map((tick, i) => (\r\n      <Entity\r\n        key={`xTicks${i}`}\r\n        line={{\r\n          start: `${scales.x(tick) + tickOffset} 0 ${rangesMax.z}`,\r\n          end: `${scales.x(tick) + tickOffset} -0.025 ${rangesMax.z}`,\r\n          color: color\r\n        }}\r\n      />\r\n    ));\r\n\r\n  const axisTicksData = () =>\r\n    tickValues.map((tick, i) => (\r\n      {\r\n        key: `xTicks${i}`,\r\n        line: {\r\n          start: `${scales.x(tick) + tickOffset} 0 ${rangesMax.z}`,\r\n          end: `${scales.x(tick) + tickOffset} -0.025 ${rangesMax.z}`,\r\n          color: color,\r\n          tick: tick,\r\n          scaleTick: scales.x(tick),\r\n          scaleX: scales.x\r\n        }\r\n      }\r\n    ));\r\n\r\n  const axisTickText = () =>\r\n    tickValues.map((tick, i) => {\r\n      let value = tick;\r\n      if (typeof value === 'number' && typeof numberFormat === 'string') {\r\n        value = d3.format(numberFormat)(tick);\r\n      }\r\n\r\n      return (\r\n        <Entity\r\n          key={`xTickText${i}`}\r\n          text={{\r\n            width: 0.6,\r\n            value: value,\r\n            color: color,\r\n            side: 'front',\r\n            anchor: 'align',\r\n            align: 'right'\r\n          }}\r\n          position={`${scales.x(tick) + tickOffset} -0.035 ${rangesMax.z}`}\r\n          rotation='0 0 90'\r\n        />\r\n      );\r\n    });\r\n\r\n\r\n  const axisTickTextData = () =>\r\n    tickValues.map((tick, i) => {\r\n      let value = tick;\r\n      if (typeof value === 'number' && typeof numberFormat === 'string') {\r\n        value = d3.format(numberFormat)(tick);\r\n      }\r\n\r\n      return ({\r\n        key: `xTickText${i}`,\r\n        text: {\r\n          width: 0.6,\r\n          value: value,\r\n          color: color,\r\n          side: 'front',\r\n          anchor: 'align',\r\n          align: 'right'\r\n        },\r\n        position: `${scales.x(tick) + tickOffset} -0.035 ${rangesMax.z}`,\r\n        rotation: '0 0 90'\r\n      });\r\n    });\r\n\r\n  const axisTitle = () => (\r\n    <Entity\r\n      text={{\r\n        width: rangesMax.x,\r\n        value: title,\r\n        color: color,\r\n        side: 'front',\r\n        anchor: 'align',\r\n        align: 'center'\r\n      }}\r\n      position={`${rangesMax.x / 2} ${titlePadding !== null ? -titlePadding : -0.22\r\n        } ${rangesMax.z}`}\r\n      rotation='0 0 0'\r\n    />\r\n  );\r\n\r\n  const axisTitleData = () => (\r\n    {\r\n      text: {\r\n        width: rangesMax.x,\r\n        value: title,\r\n        color: color,\r\n        side: 'front',\r\n        anchor: 'align',\r\n        align: 'center'\r\n      },\r\n      position: `${rangesMax.x / 2} ${titlePadding !== null ? -titlePadding : -0.22\r\n        } ${rangesMax.z}`,\r\n      rotation: '0 0 0',\r\n    }\r\n  );\r\n\r\n  const showLabels =\r\n    labels === false ? labels : defaults.view.encoding.axis.labels;\r\n\r\n  const showTicks = ticks === false ? ticks : defaults.view.encoding.axis.ticks;\r\n\r\n  const axisData = () => (\r\n    {\r\n      ...props,\r\n      axis: 'x',\r\n      start: `0 0 ${rangesMax.z}`,\r\n      end: `${rangesMax.x} 0 ${rangesMax.z}`,\r\n      color: color,\r\n      ticksData: showTicks ? axisTicksData() : null,\r\n      titleData: showTicks ? axisTitleData() : null,\r\n      tickTextData: showTicks ? axisTickTextData() : null\r\n    }\r\n  )\r\n\r\n  chartData[\"xAxis\"] = axisData();\r\n  log.debug(\"OUTPUT\", \"xAxis\", axisData());\r\n  return (\r\n    <Axis\r\n      {...props}\r\n      axis='x'\r\n      start={`0 0 ${rangesMax.z}`}\r\n      end={`${rangesMax.x} 0 ${rangesMax.z}`}\r\n      color={color}\r\n      ticks={showTicks ? axisTicks() : null}\r\n      tickText={showTicks && showLabels ? axisTickText() : null}\r\n      title={axisTitle()}\r\n    />\r\n  );\r\n};\r\n\r\nexport const YAxis = (props) => {\r\n  const {\r\n    scales,\r\n    tickOffset,\r\n    color,\r\n    tickValues,\r\n    rangesMax,\r\n    numberFormat,\r\n    title,\r\n    titlePadding,\r\n    labels,\r\n    ticks\r\n  } = props;\r\n\r\n  const axisTicks = () =>\r\n    tickValues.map((tick, i) => (\r\n      <Entity\r\n        key={`yTicks${i}`}\r\n        line={{\r\n          start: `0 ${scales.y(tick) + tickOffset} 0`,\r\n          end: `-0.025 ${scales.y(tick) + tickOffset} 0`,\r\n          color: color\r\n        }}\r\n      />\r\n    ));\r\n\r\n  const axisTicksData = () =>\r\n    tickValues.map((tick, i) => (\r\n      {\r\n        key: `yTicks${i}`,\r\n        line: {\r\n          start: `0 ${scales.y(tick) + tickOffset} 0`,\r\n          end: `-0.025 ${scales.y(tick) + tickOffset} 0`,\r\n          color: color\r\n        }\r\n      }\r\n    ));\r\n\r\n  const axisTickText = () =>\r\n    tickValues.map((tick, i) => {\r\n      let value = tick;\r\n      if (typeof value === 'number' && typeof numberFormat === 'string') {\r\n        value = d3.format(numberFormat)(tick);\r\n      }\r\n\r\n      return (\r\n        <Entity\r\n          key={`yTickText${i}`}\r\n          text={{\r\n            width: 0.6,\r\n            value: value,\r\n            color: color,\r\n            side: 'front',\r\n            anchor: 'align',\r\n            align: 'right'\r\n          }}\r\n          position={`-0.035 ${scales.y(tick) + tickOffset} 0`}\r\n          rotation='0 0 0'\r\n        />\r\n      );\r\n    });\r\n\r\n  const axisTickTextData = () =>\r\n    tickValues.map((tick, i) => {\r\n      let value = tick;\r\n      if (typeof value === 'number' && typeof numberFormat === 'string') {\r\n        value = d3.format(numberFormat)(tick);\r\n      }\r\n\r\n      return (\r\n        {\r\n          key: `yTickText${i}`,\r\n          text: {\r\n            width: 0.6,\r\n            value: value,\r\n            color: color,\r\n            side: 'front',\r\n            anchor: 'align',\r\n            align: 'right'\r\n          },\r\n          position: `-0.035 ${scales.y(tick) + tickOffset} 0`,\r\n          rotation: '0 0 0'\r\n        }\r\n      );\r\n    });\r\n\r\n  const axisTitle = () => (\r\n    <Entity\r\n      text={{\r\n        width: rangesMax.y,\r\n        value: title,\r\n        color: color,\r\n        side: 'front',\r\n        anchor: 'align',\r\n        align: 'center'\r\n      }}\r\n      position={`${titlePadding !== null ? -titlePadding : -0.22} ${rangesMax.y / 2\r\n        } 0`}\r\n      rotation='0 0 90'\r\n    />\r\n  );\r\n\r\n  const axisTitleData = () => (\r\n    {\r\n      text: {\r\n        width: rangesMax.y,\r\n        value: title,\r\n        color: color,\r\n        side: 'front',\r\n        anchor: 'align',\r\n        align: 'center'\r\n      },\r\n      position: `${titlePadding !== null ? -titlePadding : -0.22} ${rangesMax.y / 2\r\n        } 0`,\r\n      rotation: `0 0 90`\r\n    }\r\n  );\r\n\r\n  const showLabels =\r\n    labels === false ? labels : defaults.view.encoding.axis.labels;\r\n\r\n  const showTicks = ticks === false ? ticks : defaults.view.encoding.axis.ticks;\r\n\r\n  const axisData = () => (\r\n    {\r\n      ...props,\r\n      axis: 'y',\r\n      start: '0 0 0',\r\n      end: `0 ${rangesMax.y} 0`,\r\n      color: color,\r\n      ticksData: showTicks ? axisTicksData() : null,\r\n      tickTextData: showTicks ? axisTickTextData() : null,\r\n      titleData: showTicks ? axisTitleData() : null\r\n    }\r\n  );\r\n\r\n  chartData[\"yAxis\"] = axisData();\r\n  log.debug(\"OUTPUT\", \"yAxis\", axisData());\r\n  return (\r\n    <Axis\r\n      {...props}\r\n      axis='y'\r\n      start='0 0 0'\r\n      end={`0 ${rangesMax.y} 0`}\r\n      color={color}\r\n      ticks={showTicks ? axisTicks() : null}\r\n      tickText={showTicks && showLabels ? axisTickText() : null}\r\n      title={axisTitle()}\r\n    />\r\n  );\r\n};\r\n\r\nexport const ZAxis = (props) => {\r\n  const {\r\n    scales,\r\n    tickOffset,\r\n    color,\r\n    tickValues,\r\n    rangesMax,\r\n    numberFormat,\r\n    title,\r\n    titlePadding,\r\n    labels,\r\n    ticks\r\n  } = props;\r\n\r\n  const axisTicks = () =>\r\n    tickValues.map((tick, i) => (\r\n      <Entity\r\n        key={`zTicks${i}`}\r\n        line={{\r\n          start: `0 0 ${scales.z(tick) + tickOffset}`,\r\n          end: `0 -0.025 ${scales.z(tick) + tickOffset}`,\r\n          color: color\r\n        }}\r\n      />\r\n    ));\r\n\r\n  const axisTicksData = () =>\r\n    tickValues.map((tick, i) => (\r\n      {\r\n        key: `zTicks${i}`,\r\n        line: {\r\n          start: `0 0 ${scales.z(tick) + tickOffset}`,\r\n          end: `0 -0.025 ${scales.z(tick) + tickOffset}`,\r\n          color: color\r\n        },\r\n      }\r\n    ));\r\n\r\n  const axisTickText = () =>\r\n    tickValues.map((tick, i) => {\r\n      let value = tick;\r\n      if (typeof value === 'number' && typeof numberFormat === 'string') {\r\n        value = d3.format(numberFormat)(tick);\r\n      }\r\n\r\n      return (\r\n        <Entity\r\n          key={`zTickText${i}`}\r\n          text={{\r\n            width: 0.6,\r\n            value: value,\r\n            color: color,\r\n            side: 'front',\r\n            anchor: 'align',\r\n            align: 'right'\r\n          }}\r\n          position={`0 -0.035 ${scales.z(tick) + tickOffset}`}\r\n          rotation='0 -90 90'\r\n        />\r\n      );\r\n    });\r\n\r\n  const axisTickTextData = () =>\r\n    tickValues.map((tick, i) => {\r\n      let value = tick;\r\n      if (typeof value === 'number' && typeof numberFormat === 'string') {\r\n        value = d3.format(numberFormat)(tick);\r\n      }\r\n\r\n      return (\r\n        {\r\n          key: `zTickText${i}`,\r\n          text: {\r\n            width: 0.6,\r\n            value: value,\r\n            color: color,\r\n            side: 'front',\r\n            anchor: 'align',\r\n            align: 'right'\r\n          },\r\n          position: `0 -0.035 ${scales.z(tick) + tickOffset}`,\r\n          rotation: '0 -90 90'\r\n        }\r\n      );\r\n    });\r\n\r\n  const axisTitle = () => (\r\n    <Entity\r\n      text={{\r\n        width: rangesMax.z,\r\n        value: title,\r\n        color: color,\r\n        side: 'front',\r\n        anchor: 'align',\r\n        align: 'center'\r\n      }}\r\n      position={`0 ${titlePadding !== null ? -titlePadding : -0.22} ${rangesMax.z / 2\r\n        }`}\r\n      rotation='0 -90 0'\r\n    />\r\n  );\r\n\r\n  const axisTitleData = () => (\r\n    {\r\n      text: {\r\n        width: rangesMax.z,\r\n        value: title,\r\n        color: color,\r\n        side: 'front',\r\n        anchor: 'align',\r\n        align: 'center'\r\n      },\r\n      position: `0 ${titlePadding !== null ? -titlePadding : -0.22} ${rangesMax.z / 2\r\n        }`,\r\n      rotation: '0 -90 0'\r\n    }\r\n  );\r\n\r\n  const showLabels =\r\n    labels === false ? labels : defaults.view.encoding.axis.labels;\r\n\r\n  const showTicks = ticks === false ? ticks : defaults.view.encoding.axis.ticks;\r\n\r\n  const axisData = () => (\r\n    {\r\n      ...props,\r\n      axis: 'z',\r\n      start: '0 0 0',\r\n      end: `0 0 ${rangesMax.z}`,\r\n      color: color,\r\n      ticksData: showTicks ? axisTicksData() : null,\r\n      tickTextData: showTicks ? axisTickTextData() : null,\r\n      titleData: showTicks ? axisTitleData() : null\r\n    }\r\n  );\r\n\r\n  chartData[\"zAxis\"] = axisData();\r\n  log.debug(\"OUTPUT\", \"zAxis\", axisData());\r\n  return (\r\n    <Axis\r\n      {...props}\r\n      axis='z'\r\n      start='0 0 0'\r\n      end={`0 0 ${rangesMax.z}`}\r\n      color={color}\r\n      ticks={showTicks ? axisTicks() : null}\r\n      tickText={showTicks && showLabels ? axisTickText() : null}\r\n      title={axisTitle()}\r\n    />\r\n  );\r\n};\r\n\r\nexport const axes = [XAxis, YAxis, ZAxis];\r\n\r\nexport default axes;\r\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Entity } from 'aframe-react';\n\nimport { XAxis, YAxis, ZAxis } from './axes';\n\nimport { log } from '../../../utils';\n\nimport { defaults } from '../../../grammar/defaults';\nimport { chartData } from '..';\n\nconst Axes = (props) => {\n  log.debug('Axes Rendering');\n\n  const { view, options, scales, rangesMax } = props;\n\n  const generateTitle = () => {\n    let title;\n    let title_data;\n    if (view.title) {\n      title = (\n        <Entity\n          text={{\n            width: rangesMax.x,\n            value: view.title,\n            color: options.chartColor,\n            side: 'front',\n            anchor: 'align',\n            align: 'center'\n          }}\n          position={`${rangesMax.x / 2 || 0} ${rangesMax.y ? rangesMax.y + view.titlePadding : view.titlePadding\n            } 0`}\n        />\n      );\n\n      title_data = {\n        text: {\n          'width': rangesMax.x,\n          'value': view.title,\n          'color': options.chartColor,\n          'side': 'front',\n          'anchor': 'align',\n          'align': 'center'\n        },\n        'position': `${rangesMax.x / 2 || 0} ${rangesMax.y ? rangesMax.y + view.titlePadding : view.titlePadding\n          } 0`\n      }\n    }\n    log.debug(\"OUTPUT\", \"title_data\", title_data);\n    chartData[\"title\"] = title_data;\n    return title;\n  };\n\n  const generateAxes = () => {\n    const axes = [];\n    const axis_data = [];\n\n    ['x', 'y', 'z'].forEach((channel) => {\n      // If this channel is in the view\n      if (view.encoding[channel] && view.encoding[channel]?.axis !== false) {\n        // Set the axis title from encoding axis title or field name\n        let title;\n        if (view.encoding[channel].axis?.title !== undefined) {\n          title = view.encoding[channel].axis.title;\n        } else {\n          title = view.encoding[channel].field;\n        }\n\n        let tickValues;\n        let tickOffset = 0;\n        let tickCount = null;\n\n        // Use scale for ticks for quantitative fields\n        if (view.encoding[channel].type === 'quantitative') {\n          // Tick values from scale\n          tickCount = view.encoding[channel]?.axis?.tickCount || tickCount;\n          if (tickCount !== null) {\n            tickValues = scales[channel].ticks(tickCount);\n          } else {\n            tickValues = scales[channel].ticks();\n          }\n\n          // Use scale domain for ticks for categorical fields\n        } else {\n          tickValues = scales[channel].domain();\n          tickOffset = scales[channel].bandwidth() / 2;\n        }\n\n        // Store each axis\n        // TODO: More orients\n        // TODO: Copy and flip axis label and title 180 degrees for visibility\n        // Faces only currently support:\n        // - x: front, back\n        // - y: front, back\n        // - z : left, right\n\n        let xFace =\n          view.encoding[channel]?.axis?.face ||\n          defaults.view.encoding.axis.face.x;\n\n        xFace = xFace === 'front' ? 0 : -rangesMax.z;\n\n        let yFace =\n          view.encoding[channel]?.axis?.face ||\n          defaults.view.encoding.axis.face.y;\n\n        yFace = yFace === 'front' ? rangesMax.z : 0;\n\n        let zFace =\n          view.encoding[channel]?.axis?.face ||\n          defaults.view.encoding.axis.face.z;\n\n        zFace = zFace === 'left' ? 0 : rangesMax.x;\n\n        switch (channel) {\n          case 'x':\n            axes.push(\n              <XAxis\n                key='xAxis'\n                fieldType={view.encoding[channel].type}\n                numberFormat={view.encoding[channel].numberFormat}\n                tickValues={tickValues}\n                tickOffset={tickOffset}\n                scales={scales}\n                rangesMax={rangesMax}\n                color={options.chartColor}\n                title={title}\n                titlePadding={view.encoding[channel]?.axis?.titlePadding}\n                labels={view.encoding[channel]?.axis?.labels}\n                ticks={view.encoding[channel]?.axis?.ticks}\n                position={`0 0 ${xFace}`}\n              />\n            );\n\n            axis_data.push({\n              'key': 'xAxis',\n              'title': title,\n              'numberFormat': view.encoding[channel].numberFormat,\n              'tickValues': tickValues,\n              'tickOffset': tickOffset,\n              'scales': scales,\n              'rangesMax': rangesMax,\n              'color': options.chartColor,\n              'titlePadding': view.encoding[channel]?.axis?.titlePadding,\n              'labels': view.encoding[channel]?.axis?.labels,\n              'ticks': view.encoding[channel]?.axis?.ticks,\n              'ticksData': view.encoding[channel]?.axis.ticksData,\n              'position': `0 0 ${xFace}`\n            })\n\n            break;\n          case 'y':\n            axes.push(\n              <YAxis\n                key='yAxis'\n                fieldType={view.encoding[channel].type}\n                numberFormat={view.encoding[channel].numberFormat}\n                tickValues={tickValues}\n                tickOffset={tickOffset}\n                scales={scales}\n                rangesMax={rangesMax}\n                color={options.chartColor}\n                title={title}\n                titlePadding={view.encoding[channel]?.axis?.titlePadding}\n                labels={view.encoding[channel]?.axis?.labels}\n                ticks={view.encoding[channel]?.axis?.ticks}\n                position={`0 0 ${yFace}`}\n              />\n            );\n\n            axis_data.push({\n              'key': 'yAxis',\n              'title': title,\n              'numberFormat': view.encoding[channel].numberFormat,\n              'tickValues': tickValues,\n              'tickOffset': tickOffset,\n              'scales': scales,\n              'rangesMax': rangesMax,\n              'color': options.chartColor,\n              'titlePadding': view.encoding[channel]?.axis?.titlePadding,\n              'labels': view.encoding[channel]?.axis?.labels,\n              'ticks': view.encoding[channel]?.axis?.ticks,\n              'position': `0 0 ${yFace}`\n            })\n            break;\n          case 'z':\n            axes.push(\n              <ZAxis\n                key='zAxis'\n                fieldType={view.encoding[channel].type}\n                numberFormat={view.encoding[channel].numberFormat}\n                tickValues={tickValues}\n                tickOffset={tickOffset}\n                scales={scales}\n                rangesMax={rangesMax}\n                color={options.chartColor}\n                title={title}\n                titlePadding={view.encoding[channel]?.axis?.titlePadding}\n                labels={view.encoding[channel]?.axis?.labels}\n                ticks={view.encoding[channel]?.axis?.ticks}\n                position={`${zFace} 0 0`}\n              />\n            );\n\n            axis_data.push({\n              'key': 'zAxis',\n              'title': title,\n              'numberFormat': view.encoding[channel].numberFormat,\n              'tickValues': tickValues,\n              'tickOffset': tickOffset,\n              'scales': scales,\n              'rangesMax': rangesMax,\n              'color': options.chartColor,\n              'titlePadding': view.encoding[channel]?.axis?.titlePadding,\n              'labels': view.encoding[channel]?.axis?.labels,\n              'ticks': view.encoding[channel]?.axis?.ticks,\n              'position': `0 0 ${zFace}`\n            })\n            break;\n          default:\n            break;\n        }\n\n      }\n    });\n\n\n    log.debug('OUTPUT', 'axis_data', axis_data);\n    return axes;\n  };\n\n  return (\n    <Entity>\n      {generateTitle()}\n      {generateAxes()}\n    </Entity>\n  );\n};\n\nAxes.propTypes = {\n  view: PropTypes.object.isRequired,\n  options: PropTypes.object.isRequired,\n  scales: PropTypes.object.isRequired,\n  rangesMax: PropTypes.object.isRequired\n};\n\nexport default React.memo(Axes, (prev, next) => prev.view === next.view);\n","import React, { useContext } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { Entity } from 'aframe-react';\r\n\r\nimport { log } from '../../../utils';\r\n\r\nimport { DispatchContext } from '../../../reducer';\r\nimport { actionTypes } from '../../../actions';\r\n\r\nimport { defaults } from '../../../grammar/defaults';\r\n\r\nconst AxisFilters = (props) => {\r\n  log.debug('Axis Filters Rendering');\r\n  const dispatch = useContext(DispatchContext);\r\n\r\n  const opacity = 1;\r\n\r\n  const { view, options, dataset, scales, domainMap, rangesMax } = props;\r\n\r\n  // Faces\r\n  // TODO: Orients\r\n  // Faces only currently support:\r\n  // - x: front, back\r\n  // - y: front, back\r\n  // - z : left, right\r\n\r\n  let xFace;\r\n  let yFace;\r\n  let zFace;\r\n\r\n  if (view.encoding.x?.axis?.filter === true) {\r\n    xFace = view.encoding.x?.axis?.face || defaults.view.encoding.axis.face.x;\r\n    xFace = xFace === 'front' ? 0 : -rangesMax.z;\r\n  }\r\n\r\n  if (view.encoding.y?.axis?.filter === true) {\r\n    yFace = view.encoding.y?.axis?.face || defaults.view.encoding.axis.face.y;\r\n    yFace = yFace === 'front' ? rangesMax.z : 0;\r\n  }\r\n\r\n  if (view.encoding.z?.axis?.filter === true) {\r\n    zFace = view.encoding.z?.axis?.face || defaults.view.encoding.axis.face.z;\r\n    zFace = zFace === 'left' ? 0 : rangesMax.x;\r\n  }\r\n\r\n  let faces = { xFace, yFace, zFace };\r\n\r\n  const XFilter = (view, scales, opacity, domainMap, faces) => (\r\n    <Entity position={`0 0 ${faces.xFace}`}>\r\n      <Entity\r\n        class='interactive'\r\n        grabbable={{\r\n          suppressY: true,\r\n          suppressZ: true\r\n        }}\r\n        events={{\r\n          'grab-end': (e) => {\r\n            dispatch({\r\n              type: actionTypes.FILTER_DATA,\r\n              payload: {\r\n                value: scales.x.invert(\r\n                  e.detail.target.getAttribute('position').x\r\n                ),\r\n                field: view.encoding.x.field,\r\n                bound: 0,\r\n                type: 'axis'\r\n              }\r\n            });\r\n          }\r\n        }}\r\n        opacity={opacity}\r\n        primitive='a-cone'\r\n        radius-top='0.0'\r\n        radius-bottom='0.01'\r\n        height='0.03'\r\n        color='#FFA493'\r\n        position={`${scales.x(\r\n          domainMap.get(view.encoding.x.field)[0]\r\n        )} -0.015 ${scales.z ? scales.z.range()[1] : 0}`}\r\n        rotation='0 0 0'\r\n      />\r\n      <Entity\r\n        class='interactive'\r\n        grabbable={{\r\n          suppressY: true,\r\n          suppressZ: true\r\n        }}\r\n        events={{\r\n          'grab-end': (e) => {\r\n            dispatch({\r\n              type: actionTypes.FILTER_DATA,\r\n              payload: {\r\n                value: scales.x.invert(\r\n                  e.detail.target.getAttribute('position').x\r\n                ),\r\n                field: view.encoding.x.field,\r\n                bound: 1,\r\n                type: 'axis'\r\n              }\r\n            });\r\n          }\r\n        }}\r\n        opacity={opacity}\r\n        primitive='a-cone'\r\n        radius-top='0.0'\r\n        radius-bottom='0.01'\r\n        height='0.03'\r\n        color='#FFA493'\r\n        position={`${scales.x(\r\n          domainMap.get(view.encoding.x.field)[1]\r\n        )} -0.015 ${scales.z ? scales.z.range()[1] : 0}`}\r\n        rotation='0 0 0'\r\n      />\r\n    </Entity>\r\n  );\r\n\r\n  const YFilter = (view, scales, opacity, domainMap, faces) => (\r\n    <Entity position={`0 0 ${faces.yFace}`}>\r\n      <Entity\r\n        class='interactive'\r\n        grabbable={{\r\n          suppressX: true,\r\n          suppressZ: true\r\n        }}\r\n        events={{\r\n          'grab-end': (e) => {\r\n            dispatch({\r\n              type: actionTypes.FILTER_DATA,\r\n              payload: {\r\n                value: scales.y.invert(\r\n                  e.detail.target.getAttribute('position').y\r\n                ),\r\n                field: view.encoding.y.field,\r\n                bound: 0,\r\n                type: 'axis'\r\n              }\r\n            });\r\n          }\r\n        }}\r\n        opacity={opacity}\r\n        primitive='a-cone'\r\n        radius-top='0.0'\r\n        radius-bottom='0.01'\r\n        height='0.03'\r\n        color='#98FF97'\r\n        position={`-0.015 ${scales.y(\r\n          domainMap.get(view.encoding.y.field)[0]\r\n        )} ${scales.z ? scales.z.range()[0] : 0}`}\r\n        rotation='0 0 -90'\r\n      />\r\n      <Entity\r\n        class='interactive'\r\n        grabbable={{\r\n          suppressX: true,\r\n          suppressZ: true\r\n        }}\r\n        events={{\r\n          'grab-end': (e) => {\r\n            dispatch({\r\n              type: actionTypes.FILTER_DATA,\r\n              payload: {\r\n                value: scales.y.invert(\r\n                  e.detail.target.getAttribute('position').y\r\n                ),\r\n                field: view.encoding.y.field,\r\n                bound: 1,\r\n                type: 'axis'\r\n              }\r\n            });\r\n          }\r\n        }}\r\n        opacity={opacity}\r\n        primitive='a-cone'\r\n        radius-top='0.0'\r\n        radius-bottom='0.01'\r\n        height='0.03'\r\n        color='#98FF97'\r\n        position={`-0.015 ${scales.y(\r\n          domainMap.get(view.encoding.y.field)[1]\r\n        )} ${scales.z ? scales.z.range()[0] : 0}`}\r\n        rotation='0 0 -90'\r\n      />\r\n    </Entity>\r\n  );\r\n\r\n  const ZFilter = (view, scales, opacity, domainMap, faces) => (\r\n    <Entity position={`${faces.zFace} 0 0`}>\r\n      <Entity\r\n        class='interactive'\r\n        grabbable={{\r\n          suppressX: true,\r\n          suppressY: true\r\n        }}\r\n        events={{\r\n          'grab-end': (e) => {\r\n            dispatch({\r\n              type: actionTypes.FILTER_DATA,\r\n              payload: {\r\n                value: scales.z.invert(\r\n                  e.detail.target.getAttribute('position').z\r\n                ),\r\n                field: view.encoding.z.field,\r\n                bound: 0,\r\n                type: 'axis'\r\n              }\r\n            });\r\n          }\r\n        }}\r\n        opacity={opacity}\r\n        primitive='a-cone'\r\n        radius-top='0.0'\r\n        radius-bottom='0.01'\r\n        height='0.03'\r\n        color='#86D7F5'\r\n        position={`-0.015 0 ${scales.z(\r\n          domainMap.get(view.encoding.z.field)[0]\r\n        )}`}\r\n        rotation='0 0 -90'\r\n      />\r\n      <Entity\r\n        class='interactive'\r\n        grabbable={{\r\n          suppressX: true,\r\n          suppressY: true\r\n        }}\r\n        events={{\r\n          'grab-end': (e) => {\r\n            dispatch({\r\n              type: actionTypes.FILTER_DATA,\r\n              payload: {\r\n                value: scales.z.invert(\r\n                  e.detail.target.getAttribute('position').z\r\n                ),\r\n                field: view.encoding.z.field,\r\n                bound: 1,\r\n                type: 'axis'\r\n              }\r\n            });\r\n          }\r\n        }}\r\n        opacity={opacity}\r\n        primitive='a-cone'\r\n        radius-top='0.0'\r\n        radius-bottom='0.01'\r\n        height='0.03'\r\n        color='#86D7F5'\r\n        position={`-0.015 0 ${scales.z(\r\n          domainMap.get(view.encoding.z.field)[1]\r\n        )}`}\r\n        rotation='0 0 -90'\r\n      />\r\n    </Entity>\r\n  );\r\n\r\n  const mutualProps = [view, scales, opacity, domainMap, faces];\r\n\r\n  return (\r\n    <Entity>\r\n      {view.encoding.x?.axis?.filter === true ? XFilter(...mutualProps) : null}\r\n      {view.encoding.y?.axis?.filter === true ? YFilter(...mutualProps) : null}\r\n      {view.encoding.z?.axis?.filter === true ? ZFilter(...mutualProps) : null}\r\n    </Entity>\r\n  );\r\n};\r\n\r\nAxisFilters.propTypes = {\r\n  view: PropTypes.object.isRequired,\r\n  options: PropTypes.object.isRequired,\r\n  dataset: PropTypes.array.isRequired,\r\n  scales: PropTypes.object.isRequired,\r\n  domainMap: PropTypes.object.isRequired\r\n};\r\n\r\nexport default React.memo(\r\n  AxisFilters,\r\n  (prev, next) => prev.domainMap === next.domainMap\r\n);\r\n","import React, { useContext } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { Entity } from 'aframe-react';\r\nimport * as d3 from 'd3';\r\nimport isEqual from 'react-fast-compare';\r\n\r\nimport { defaults } from '../../../grammar/defaults';\r\n\r\nimport { log } from '../../../utils';\r\n\r\nimport { DispatchContext } from '../../../reducer';\r\nimport { actionTypes } from '../../../actions';\r\nimport { chartData } from '..';\r\n\r\nconst Marks = (props) => {\r\n  log.debug('Marks Rendering');\r\n  const { view, dataset, scales, customMarks } = props;\r\n\r\n  const dispatch = useContext(DispatchContext);\r\n\r\n  const markType = view.mark.type;\r\n  const markShape = view.mark.shape;\r\n\r\n  // OUTPUT mark array\r\n  const marks_data = [];\r\n\r\n  // Loop over all rows in the data\r\n  const marks = dataset.map((row, i) => {\r\n    const vriaid = `vria-${row.vriaid}`;\r\n\r\n    // Set up tooltip\r\n    let tooltipContent = '';\r\n    let tooltipHeight = 0.05;\r\n    const lineHeight = 0.021;\r\n    if (view.mark.tooltip !== false && view.mark.tooltip !== undefined) {\r\n      if (view.mark.tooltip.content === 'data') {\r\n        // Show all data in the dataset\r\n        Object.keys(row).forEach((el) => {\r\n          if (el !== 'vriaid') {\r\n            tooltipContent += `${el}: ${row[el]}\\n`;\r\n          }\r\n        });\r\n        tooltipHeight = Object.keys(row).length * lineHeight;\r\n      } else if (view.mark.tooltip.content === 'encoding') {\r\n        // Show just the encodings in this view for this mark\r\n        // Get all fields in this view\r\n        const fields = new Set();\r\n        Object.keys(view.encoding).forEach((channel) => {\r\n          if (view.encoding[channel].field)\r\n            fields.add(view.encoding[channel].field);\r\n        });\r\n        Object.keys(row).forEach((el) => {\r\n          if (el !== 'vriaid' && fields.has(el)) {\r\n            tooltipContent += `${el}: ${row[el]}\\n`;\r\n          }\r\n        });\r\n        tooltipHeight = (fields.size + 1) * lineHeight;\r\n      } else if (Array.isArray(view.mark.tooltip.content)) {\r\n        // If tooltip content is an array, get field names\r\n        Object.keys(row).forEach((el) => {\r\n          if (el !== 'vriaid' && view.mark.tooltip.content.includes(el)) {\r\n            tooltipContent += `${el}: ${row[el]}\\n`;\r\n          }\r\n        });\r\n        tooltipHeight = (view.mark.tooltip.content.length + 1) * lineHeight;\r\n      } else {\r\n        // Single field name\r\n        tooltipContent = `${view.mark.tooltip.content}: ${row[view.mark.tooltip.content]\r\n          }`;\r\n      }\r\n    }\r\n\r\n    const markEvents = {\r\n      mouseenter: (e) => {\r\n        e.target.setAttribute('opacity', 0.5);\r\n\r\n        if (view.mark.tooltip !== false && view.mark.tooltip !== undefined) {\r\n          const tooltip = e.detail.cursorEl.parentEl.querySelector('.tooltip');\r\n          tooltip.setAttribute(\r\n            'height',\r\n            e.target.getAttribute('tooltipHeight')\r\n          );\r\n          tooltip.setAttribute('visible', true);\r\n          tooltip.setAttribute('text', {\r\n            ...tooltip.getAttribute('text'),\r\n            value: e.target.getAttribute('tooltipContent')\r\n          });\r\n        }\r\n      },\r\n      mouseleave: (e) => {\r\n        e.target.setAttribute(\r\n          'opacity',\r\n          e.target.getAttribute('initialOpacity') || 0\r\n        );\r\n        if (view.mark.tooltip !== false && view.mark.tooltip !== undefined) {\r\n          // If there is a single selected mark in the scene, set tooltip, else hide\r\n          if (\r\n            document.querySelectorAll('[vria-only-selected-mark]').length !== 0\r\n          ) {\r\n            document.querySelectorAll('.tooltip').forEach((el) => {\r\n              el.setAttribute('text', {\r\n                value: document\r\n                  .querySelector('[selected]')\r\n                  .getAttribute('tooltipContent')\r\n              });\r\n            });\r\n          } else {\r\n            const tooltip = e.detail.cursorEl.parentEl.querySelector(\r\n              '.tooltip'\r\n            );\r\n            tooltip.setAttribute('visible', false);\r\n          }\r\n        }\r\n        if (\r\n          e.target.getAttribute('selected') &&\r\n          e.target.getAttribute('wireframe')\r\n        ) {\r\n          e.target.setAttribute('opacity', 1);\r\n        }\r\n      },\r\n      click: (e) => {\r\n        if (e.detail !== 0) {\r\n          const showTooltip =\r\n            view.mark.tooltip !== false && view.mark.tooltip !== undefined;\r\n\r\n          dispatch({\r\n            type: actionTypes.MARK_SELECTED,\r\n            payload: {\r\n              id: row.vriaid,\r\n              vriaid,\r\n              cursor: showTooltip\r\n                ? e.detail.cursorEl.parentEl.querySelector('.tooltip')\r\n                : null,\r\n              tooltipHeight: showTooltip\r\n                ? e.target.getAttribute('tooltipHeight')\r\n                : null,\r\n              tooltipContent: showTooltip\r\n                ? e.target.getAttribute('tooltipContent')\r\n                : null\r\n            }\r\n          });\r\n        }\r\n      }\r\n    };\r\n\r\n    // The resulting mark to be displayed\r\n    let mark;\r\n\r\n    // Store all attributes of this mark\r\n    const attributes = {};\r\n\r\n    // Loop over every encoding channel\r\n    Object.keys(view.encoding).forEach((channel) => {\r\n      // Get the field of that channel\r\n      const field = view.encoding[channel].field;\r\n\r\n      // Get the appropriate scale for this channel\r\n      const scale = scales[channel];\r\n\r\n      // Set property in attributes object\r\n      attributes[channel] = scale(row[field]);\r\n    });\r\n\r\n    // Defaults\r\n    if (attributes.opacity === undefined) attributes.opacity = 1;\r\n    if (attributes.color === undefined)\r\n      attributes.color = d3.schemeCategory10[0];\r\n\r\n\r\n\r\n    // Which type to render\r\n    switch (markType) {\r\n      // Scatter based charts\r\n      case 'point': {\r\n        attributes.size = attributes.size || defaults.view.mark.point.size;\r\n        const radius = attributes.size;\r\n\r\n        attributes.width = attributes.width || attributes.size;\r\n        attributes.height = attributes.height || attributes.size;\r\n        attributes.depth = attributes.depth || attributes.size;\r\n\r\n        // This point's offset in the view\r\n        if (typeof attributes.xoffset === 'string') {\r\n          switch (attributes.xoffset) {\r\n            case 'half': {\r\n              attributes.x = attributes.x / 2;\r\n            }\r\n          }\r\n        } else if (attributes.xoffset !== undefined) {\r\n          attributes.x += attributes.xoffset;\r\n        }\r\n        if (typeof attributes.yoffset === 'string') {\r\n          switch (attributes.yoffset) {\r\n            case 'half': {\r\n              attributes.y = attributes.y / 2;\r\n            }\r\n          }\r\n        } else if (attributes.yoffset !== undefined) {\r\n          attributes.y += attributes.yoffset;\r\n        }\r\n        if (attributes.z && typeof attributes.zoffset === 'string') {\r\n          switch (attributes.zoffset) {\r\n            case 'half': {\r\n              attributes.z = attributes.z / 2;\r\n            }\r\n          }\r\n        } else if (attributes.zoffset !== undefined) {\r\n          attributes.z += attributes.zoffset;\r\n        }\r\n\r\n        // This point's position in the view\r\n        attributes.position = `${attributes.x || 0} ${attributes.y || 0} ${attributes.z || 0\r\n          }`;\r\n\r\n        // This point's rotation in the view\r\n        attributes.rotation = `${attributes.xrotation || 0} ${attributes.yrotation || 0\r\n          } ${attributes.zrotation || 0}`;\r\n        console.log(attributes.rotation);\r\n\r\n        // Shape scale\r\n        const shapeScaleMark = attributes.shape ? attributes.shape : null;\r\n\r\n        // OUTPUT: here to get mark data\r\n\r\n        switch (shapeScaleMark || markShape) {\r\n          case 'sphere':\r\n            mark = (\r\n              <Entity\r\n                key={i}\r\n                tooltipContent={tooltipContent}\r\n                tooltipHeight={tooltipHeight}\r\n                primitive='a-sphere'\r\n                className={`interactive vria-mark ${vriaid}`}\r\n                data-mark={JSON.stringify(row)}\r\n                radius='0.5'\r\n                scale={{\r\n                  x: attributes.width || radius,\r\n                  y: attributes.height || radius,\r\n                  z: attributes.depth || radius\r\n                }}\r\n                segments-height='9'\r\n                segments-width='18'\r\n                color={attributes.color}\r\n                initialColor={attributes.color}\r\n                position={attributes.position}\r\n                rotation={attributes.rotation}\r\n                initialOpacity={attributes.opacity}\r\n                opacity={attributes.opacity}\r\n                events={markEvents}\r\n              />);\r\n\r\n            marks_data.push({\r\n              'key': i,\r\n              'tooltipContent': tooltipContent,\r\n              'tooltipHeight': tooltipHeight,\r\n              'primitive': 'a-sphere',\r\n              'className': `interactive vria-mark ${vriaid}`,\r\n              'data-mark': JSON.stringify(row),\r\n              'radius': '0.5',\r\n              'scale': {\r\n                x: attributes.width || radius,\r\n                y: attributes.height || radius,\r\n                z: attributes.depth || radius\r\n              },\r\n              'segments-height': '9',\r\n              'segments-width': '18',\r\n              'color': attributes.color,\r\n              'initialColor': attributes.color,\r\n              'position': attributes.position,\r\n              'rotation': attributes.rotation,\r\n              'initialOpacity': attributes.opacity,\r\n              'opacity': attributes.opacity,\r\n              'events': markEvents\r\n            });\r\n\r\n            break;\r\n          case 'box':\r\n            mark = (\r\n              <Entity\r\n                key={i}\r\n                tooltipContent={tooltipContent}\r\n                tooltipHeight={tooltipHeight}\r\n                primitive='a-box'\r\n                className={`interactive vria-mark ${vriaid}`}\r\n                data-mark={JSON.stringify(row)}\r\n                scale={{\r\n                  x: attributes.width || radius,\r\n                  y: attributes.height || radius,\r\n                  z: attributes.depth || radius\r\n                }}\r\n                width='1'\r\n                height='1'\r\n                depth='1'\r\n                color={attributes.color}\r\n                initialColor={attributes.color}\r\n                position={attributes.position}\r\n                rotation={attributes.rotation}\r\n                initialOpacity={attributes.opacity}\r\n                opacity={attributes.opacity}\r\n                events={markEvents}\r\n              />\r\n            );\r\n\r\n            marks_data.push({\r\n              'key': i,\r\n              'tooltipContent': tooltipContent,\r\n              'tooltipHeight': tooltipHeight,\r\n              'primitive': 'a-box',\r\n              'className': `interactive vria-mark ${vriaid}`,\r\n              'data-mark': JSON.stringify(row),\r\n              'scale': {\r\n                x: attributes.width || radius,\r\n                y: attributes.height || radius,\r\n                z: attributes.depth || radius\r\n              },\r\n              'width': '1',\r\n              'height': '1',\r\n              'depth': '1',\r\n              'color': attributes.color,\r\n              'initialColor': attributes.color,\r\n              'position': attributes.position,\r\n              'rotation': attributes.rotation,\r\n              'initialOpacity': attributes.opacity,\r\n              'opacity': attributes.opacity,\r\n              'events': markEvents\r\n            });\r\n\r\n            break;\r\n          case 'cone':\r\n            mark = (\r\n              <Entity\r\n                key={i}\r\n                tooltipContent={tooltipContent}\r\n                tooltipHeight={tooltipHeight}\r\n                primitive='a-cone'\r\n                className={`interactive vria-mark ${vriaid}`}\r\n                data-mark={JSON.stringify(row)}\r\n                // height={attributes.length || attributes.height || radius * 2}\r\n                height='1'\r\n                scale={{\r\n                  x: attributes.width || radius,\r\n                  y: attributes.height || radius,\r\n                  z: attributes.depth || radius\r\n                }}\r\n                color={attributes.color}\r\n                initialColor={attributes.color}\r\n                position={attributes.position}\r\n                rotation={attributes.rotation}\r\n                segments-height='9'\r\n                segments-radial='18'\r\n                radius-top='0'\r\n                radius-bottom='0.5'\r\n                initialOpacity={attributes.opacity}\r\n                opacity={attributes.opacity}\r\n                events={markEvents}\r\n              />\r\n            );\r\n\r\n            marks_data.push({\r\n              'key': i,\r\n              'tooltipContent': tooltipContent,\r\n              'tooltipHeight': tooltipHeight,\r\n              'primitive': 'a-cone',\r\n              'className': `interactive vria-mark ${vriaid}`,\r\n              'data-mark': JSON.stringify(row),\r\n              'height': '1',\r\n              'scale': {\r\n                x: attributes.width || radius,\r\n                y: attributes.height || radius,\r\n                z: attributes.depth || radius\r\n              },\r\n              'color': attributes.color,\r\n              'initialColor': attributes.color,\r\n              'position': attributes.position,\r\n              'rotation': attributes.rotation,\r\n              'segments-height': '9',\r\n              'segments-radial': '18',\r\n              'radius-top': '0',\r\n              'radius-bottom': '0.5',\r\n              'initialOpacity': attributes.opacity,\r\n              'opacity': attributes.opacity,\r\n              'events': markEvents\r\n            })\r\n\r\n            break;\r\n          case 'tetrahedron':\r\n            mark = (\r\n              <Entity\r\n                key={i}\r\n                tooltipContent={tooltipContent}\r\n                tooltipHeight={tooltipHeight}\r\n                primitive='a-tetrahedron'\r\n                className={`interactive vria-mark ${vriaid}`}\r\n                data-mark={JSON.stringify(row)}\r\n                radius='1'\r\n                scale={{\r\n                  x: attributes.width || radius,\r\n                  y: attributes.height || radius,\r\n                  z: attributes.depth || radius\r\n                }}\r\n                color={attributes.color}\r\n                initialColor={attributes.color}\r\n                position={attributes.position}\r\n                rotation={attributes.rotation}\r\n                initialOpacity={attributes.opacity}\r\n                opacity={attributes.opacity}\r\n                events={markEvents}\r\n              />\r\n            );\r\n\r\n            marks_data.push({\r\n              'key': i,\r\n              'tooltipContent': tooltipContent,\r\n              'tooltipHeight': tooltipHeight,\r\n              'primitive': 'a-tetrahedron',\r\n              'className': `interactive vria-mark ${vriaid}`,\r\n              'data-mark': JSON.stringify(row),\r\n              'radius': '1',\r\n              'scale': {\r\n                x: attributes.width || radius,\r\n                y: attributes.height || radius,\r\n                z: attributes.depth || radius\r\n              },\r\n              'color': attributes.color,\r\n              'initialColor': attributes.color,\r\n              'position': attributes.position,\r\n              'rotation': attributes.rotation,\r\n              'initialOpacity': attributes.opacity,\r\n              'opacity': attributes.opacity,\r\n              'events': markEvents\r\n            })\r\n\r\n            break;\r\n\r\n          case 'torus':\r\n            mark = (\r\n              <Entity\r\n                key={i}\r\n                tooltipContent={tooltipContent}\r\n                tooltipHeight={tooltipHeight}\r\n                primitive='a-torus'\r\n                className={`interactive vria-mark ${vriaid}`}\r\n                data-mark={JSON.stringify(row)}\r\n                radius='0.5'\r\n                radius-tubular='0.05'\r\n                scale={{\r\n                  x: attributes.width || radius,\r\n                  y: attributes.height || radius,\r\n                  z: attributes.depth || radius\r\n                }}\r\n                segments-radial='18'\r\n                segments-tubular='16'\r\n                color={attributes.color}\r\n                initialColor={attributes.color}\r\n                position={attributes.position}\r\n                rotation={attributes.rotation}\r\n                initialOpacity={attributes.opacity}\r\n                opacity={attributes.opacity}\r\n                events={markEvents}\r\n              />\r\n            );\r\n\r\n            marks_data.push({\r\n              'key': i,\r\n              'tooltipContent': tooltipContent,\r\n              'tooltipHeight': tooltipHeight,\r\n              'primitive': 'a-torus',\r\n              'className': `interactive vria-mark ${vriaid}`,\r\n              'data-mark': JSON.stringify(row),\r\n              'radius': '0.5',\r\n              'radius-tubular': '0.05',\r\n              'scale': {\r\n                x: attributes.width || radius,\r\n                y: attributes.height || radius,\r\n                z: attributes.depth || radius\r\n              },\r\n              'segments-radial': '18',\r\n              'segments-tubular': '16',\r\n              'color': attributes.color,\r\n              'initialColor': attributes.color,\r\n              'position': attributes.position,\r\n              'rotation': attributes.rotation,\r\n              'initialOpacity': attributes.opacity,\r\n              'opacity': attributes.opacity,\r\n              'events': markEvents\r\n            })\r\n\r\n            break;\r\n          case 'cylinder':\r\n            mark = (\r\n              <Entity\r\n                key={i}\r\n                tooltipContent={tooltipContent}\r\n                tooltipHeight={tooltipHeight}\r\n                primitive='a-cylinder'\r\n                className={`interactive vria-mark ${vriaid}`}\r\n                data-mark={JSON.stringify(row)}\r\n                rotation={attributes.rotation}\r\n                radius={attributes.width / 2 || 0.05}\r\n                height={attributes.depth !== 0 ? attributes.depth : 0.001}\r\n                color={attributes.color}\r\n                initialColor={attributes.color}\r\n                position={attributes.position}\r\n                initialOpacity={attributes.opacity}\r\n                opacity={attributes.opacity}\r\n                events={markEvents}\r\n              />\r\n            );\r\n\r\n            marks_data.push({\r\n              'key': i,\r\n              'tooltipContent': tooltipContent,\r\n              'tooltipHeight': tooltipHeight,\r\n              'primitive': 'a-cylinder',\r\n              'className': `interactive vria-mark ${vriaid}`,\r\n              'data-mark': JSON.stringify(row),\r\n              'rotation': attributes.rotation,\r\n              'radius': attributes.width / 2 || 0.05,\r\n              'height': attributes.depth !== 0 ? attributes.depth : 0.001,\r\n              'color': attributes.color,\r\n              'initialColor': attributes.color,\r\n              'position': attributes.position,\r\n              'initialOpacity': attributes.opacity,\r\n              'opacity': attributes.opacity,\r\n              'events': markEvents\r\n            })\r\n\r\n            break;\r\n          // Custom Mark\r\n          default: {\r\n            const data = JSON.stringify(row);\r\n            const key = i;\r\n            const className = `interactive vria-mark ${vriaid}`;\r\n            mark = (\r\n              <Entity\r\n                tooltipContent={tooltipContent}\r\n                tooltipHeight={tooltipHeight}\r\n                wireframe\r\n                color='white'\r\n                initialColor='white'\r\n                primitive='a-box'\r\n                opacity='0'\r\n                key={key}\r\n                className={className}\r\n                data-mark={data}\r\n                width={attributes.size}\r\n                height={attributes.size}\r\n                depth={attributes.size}\r\n                rotation={attributes.rotation}\r\n                position={attributes.position}\r\n                events={markEvents}>\r\n                {customMarks[markShape]({ ...attributes, scales, data })}\r\n              </Entity>\r\n            );\r\n            break;\r\n          }\r\n        }\r\n        break;\r\n      }\r\n      // Bar based charts\r\n      case 'bar': {\r\n        // Data field types\r\n        const fTypes = {\r\n          x: view.encoding?.x?.type || null,\r\n          y: view.encoding?.y?.type || null,\r\n          z: view.encoding?.z?.type || null\r\n        };\r\n\r\n        // Quantitative field\r\n        const q = [];\r\n\r\n        // Null fields\r\n        const n = [];\r\n\r\n        // Field counts\r\n        Object.keys(fTypes).forEach((f) => {\r\n          if (fTypes[f] === 'quantitative') {\r\n            q.push(f);\r\n          } else if (fTypes[f] === null) {\r\n            n.push(f);\r\n          }\r\n        });\r\n\r\n        // Valid number of quantitative data fields\r\n        if (q.length === 1) {\r\n          // Number of null fields determines dimensionality\r\n          if (n.length === 2) {\r\n            // 1D chart\r\n            log.error(\r\n              'Chart type \"bar\" expects 2 axis encoding channels (x, y and/or z)'\r\n            );\r\n          } else if (n.length === 1) {\r\n            // 2D chart\r\n          } else {\r\n            // 3D chart\r\n          }\r\n        } else {\r\n          log.error(\r\n            'Chart type \"bar\" expects exactly one quantitative data field'\r\n          );\r\n        }\r\n\r\n        // The quantitative data field/axis\r\n        const quantField = q[0];\r\n\r\n        if (!scales.width && !scales.height && !scales.depth) {\r\n          // Position and dimensions of bars\r\n          let xPos = 0;\r\n          let yPos = 0;\r\n          let zPos = 0;\r\n          let width = 0;\r\n          let height = 0;\r\n          let depth = 0;\r\n\r\n          switch (quantField) {\r\n            case 'x':\r\n              xPos = scales.x ? attributes.x / 2 : 0.001;\r\n              yPos = scales.y ? attributes.y + scales.y.bandwidth() / 2 : 0.001;\r\n              zPos = scales.z\r\n                ? attributes.z + scales.z.bandwidth() / 2 || 0\r\n                : -0.001;\r\n              width = attributes.x || 0.001;\r\n              height = scales.y ? scales.y.bandwidth() : 0.001;\r\n              depth = scales.z ? scales.z.bandwidth() : 0.0001;\r\n              break;\r\n            case 'y':\r\n              xPos = scales.x ? attributes.x + scales.x.bandwidth() / 2 : 0.001;\r\n              yPos = scales.y ? attributes.y / 2 : 0.001;\r\n              zPos = scales.z\r\n                ? attributes.z + scales.z.bandwidth() / 2 || 0\r\n                : -0.001;\r\n              width = scales.x ? scales.x.bandwidth() : 0.001;\r\n              height = attributes.y || 0.001;\r\n              depth = scales.z ? scales.z.bandwidth() : 0.001;\r\n              break;\r\n            case 'z':\r\n              xPos = scales.x ? attributes.x + scales.x.bandwidth() / 2 : 0.001;\r\n              yPos = scales.y\r\n                ? attributes.y + scales.y.bandwidth() / 2 || 0\r\n                : 0.001;\r\n              zPos = scales.z ? attributes.z / 2 : -0.001;\r\n              width = scales.x ? scales.x.bandwidth() : 0.001;\r\n              height = scales.y ? scales.y.bandwidth() : 0.001;\r\n              depth = attributes.z || 0.001;\r\n              break;\r\n            default:\r\n              break;\r\n          }\r\n\r\n          attributes.position = `${xPos} ${yPos} ${zPos}`;\r\n\r\n          switch (markShape) {\r\n            case 'box':\r\n              mark = (\r\n                <Entity\r\n                  key={i}\r\n                  tooltipContent={tooltipContent}\r\n                  tooltipHeight={tooltipHeight}\r\n                  position={attributes.position}\r\n                  primitive='a-box'\r\n                  className={`interactive vria-mark ${vriaid}`}\r\n                  data-mark={JSON.stringify(row)}\r\n                  width={width}\r\n                  height={height}\r\n                  depth={depth}\r\n                  color={attributes.color}\r\n                  initialColor={attributes.color}\r\n                  initialOpacity={attributes.opacity}\r\n                  opacity={attributes.opacity}\r\n                  events={markEvents}\r\n                />\r\n              );\r\n\r\n              marks_data.push({\r\n                'key': i,\r\n                'tooltipContent': tooltipContent,\r\n                'tooltipHeight': tooltipHeight,\r\n                'position': attributes.position,\r\n                'primitive': 'a-box',\r\n                'className': `interactive vria-mark ${vriaid}`,\r\n                'data-mark': JSON.stringify(row),\r\n                'width': width,\r\n                'height': height,\r\n                'depth': depth,\r\n                'color': attributes.color,\r\n                'initialColor': attributes.color,\r\n                'initialOpacity': attributes.opacity,\r\n                'opacity': attributes.opacity,\r\n                'events': markEvents,\r\n              })\r\n\r\n              break;\r\n            case 'plane':\r\n              // TODO: Plane\r\n              break;\r\n            case 'cylinder':\r\n              mark = (\r\n                <Entity\r\n                  key={i}\r\n                  tooltipContent={tooltipContent}\r\n                  tooltipHeight={tooltipHeight}\r\n                  primitive='a-cylinder'\r\n                  className={`interactive vria-mark ${vriaid}`}\r\n                  data-mark={JSON.stringify(row)}\r\n                  rotation='0 0 0'\r\n                  radius={width / 2}\r\n                  height={height}\r\n                  color={attributes.color}\r\n                  initialColor={attributes.color}\r\n                  position={attributes.position}\r\n                  initialOpacity={attributes.opacity}\r\n                  opacity={attributes.opacity}\r\n                  events={markEvents}\r\n                />\r\n              );\r\n\r\n              marks_data.push({\r\n                'key': i,\r\n                'tooltipContent': tooltipContent,\r\n                'tooltipHeight': tooltipHeight,\r\n                'primitive': 'a-cylinder',\r\n                'className': `interactive vria-mark ${vriaid}`,\r\n                'data-mark': JSON.stringify(row),\r\n                'rotation': '0 0 0',\r\n                'radius': width / 2,\r\n                'height': height,\r\n                'color': attributes.color,\r\n                'initialColor': attributes.color,\r\n                'position': attributes.position,\r\n                'initialOpacity': attributes.opacity,\r\n                'opacity': attributes.opacity,\r\n                'events': markEvents\r\n              })\r\n\r\n              break;\r\n            case 'cone':\r\n              mark = (\r\n                <Entity\r\n                  key={i}\r\n                  tooltipContent={tooltipContent}\r\n                  tooltipHeight={tooltipHeight}\r\n                  primitive='a-cone'\r\n                  className={`interactive vria-mark ${vriaid}`}\r\n                  data-mark={JSON.stringify(row)}\r\n                  height={height}\r\n                  color={attributes.color}\r\n                  initialColor={attributes.color}\r\n                  position={attributes.position}\r\n                  rotation={attributes.rotation}\r\n                  segments-height='9'\r\n                  segments-radial='18'\r\n                  radius-top='0'\r\n                  radius-bottom={d3.min([\r\n                    scales.x.bandwidth() / 2,\r\n                    scales.z.bandwidth() / 2\r\n                  ])}\r\n                  initialOpacity={attributes.opacity}\r\n                  opacity={attributes.opacity}\r\n                  events={markEvents}\r\n                />\r\n              );\r\n\r\n              marks_data.push({\r\n                'key': i,\r\n                'tooltipContent': tooltipContent,\r\n                'tooltipHeight': tooltipHeight,\r\n                'primitive': 'a-cone',\r\n                'className': `interactive vria-mark ${vriaid}`,\r\n                'data-mark': JSON.stringify(row),\r\n                'height': height,\r\n                'color': attributes.color,\r\n                'initialColor': attributes.color,\r\n                'position': attributes.position,\r\n                'rotation': attributes.rotation,\r\n                'segments-height': '9',\r\n                'segments-radial': '18',\r\n                'radius-top': '0',\r\n                'radius-bottom': d3.min([\r\n                  scales.x.bandwidth() / 2,\r\n                  scales.z.bandwidth() / 2\r\n                ]),\r\n                'initialOpacity': attributes.opacity,\r\n                'opacity': attributes.opacity,\r\n                'events': markEvents,\r\n              })\r\n\r\n              break;\r\n            // Custom Mark\r\n            default: {\r\n              const data = JSON.stringify(row);\r\n              const key = i;\r\n              const className = `interactive vria-mark ${vriaid}`;\r\n              console.log('custommarks', customMarks);\r\n              mark = (\r\n                <Entity\r\n                  tooltipContent={tooltipContent}\r\n                  tooltipHeight={tooltipHeight}\r\n                  wireframe\r\n                  color='white'\r\n                  initialColor='white'\r\n                  primitive='a-box'\r\n                  opacity='0'\r\n                  key={key}\r\n                  className={className}\r\n                  width={width}\r\n                  height={height}\r\n                  depth={depth}\r\n                  rotation={attributes.rotation}\r\n                  position={attributes.position}\r\n                  events={markEvents}>\r\n                  {customMarks[markShape]({\r\n                    ...attributes,\r\n                    scales,\r\n                    data,\r\n                    width,\r\n                    height,\r\n                    depth\r\n                  })}\r\n                </Entity>\r\n              );\r\n              break;\r\n            }\r\n          }\r\n        }\r\n        break;\r\n      }\r\n      default:\r\n        break;\r\n    }\r\n\r\n\r\n    return mark;\r\n  });\r\n\r\n\r\n  chartData[\"marks\"] = marks_data;\r\n  chartData[\"markShape\"] = markShape;\r\n  chartData[\"markType\"] = markType;\r\n  log.debug(\"OUTPUT\", \"marks\", marks);\r\n  log.debug(\"OUTPUT\", \"markShape\", markShape);\r\n  log.debug(\"OUTPUT\", \"markType\", markType);\r\n  return <Entity className='marks'>{marks}</Entity>;\r\n};\r\n\r\nMarks.propTypes = {\r\n  view: PropTypes.object.isRequired,\r\n  customMarks: PropTypes.object,\r\n  dataset: PropTypes.array.isRequired,\r\n  scales: PropTypes.object.isRequired\r\n};\r\n\r\nexport default React.memo(Marks, (prevProps, nextProps) => {\r\n  return (\r\n    isEqual(prevProps.view, nextProps.view) &&\r\n    isEqual(prevProps.parsedDataset, nextProps.parsedDataset)\r\n  );\r\n});\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { Entity } from 'aframe-react';\r\n\r\nimport { defaults } from '../../../grammar/defaults';\r\nimport { log } from '../../../utils';\r\n\r\nimport Legend from '../Legend';\r\nimport Axes from '../Axes';\r\nimport AxisFilters from '../AxisFilters';\r\nimport Marks from '../Marks';\r\nimport { chartData } from '..';\r\n\r\n\r\nconst View = (props) => {\r\n  const { view, scales, index } = props;\r\n  const position = `${view.x} ${view.y + defaults.options.userHeight} ${view.z\r\n    }`;\r\n  const rotation = `${view.xrotation} ${view.yrotation} ${view.zrotation}`;\r\n  const { width, height, depth } = view;\r\n\r\n  // Range maximums\r\n  const rangesMax = {\r\n    x: scales.x ? scales.x.range()[1] : 0,\r\n    y: scales.y ? scales.y.range()[1] : 0,\r\n    z: scales.z ? scales.z.range()[1] : 0\r\n  };\r\n\r\n  // Legends\r\n  const legends = Object.keys(view.encoding)\r\n    .filter((c) => view.encoding[c].legend)\r\n    .map((channel, i) => (\r\n      <Legend\r\n        key={`v${index}l${i}${channel}`}\r\n        {...props}\r\n        index={i}\r\n        channel={channel}\r\n        rangesMax={rangesMax}\r\n      />\r\n    ));\r\n\r\n  const markProps = {\r\n    view: props.view,\r\n    customMarks: props.customMarks,\r\n    dataset: props.dataset,\r\n    parsedDataset: props.parsedDataset,\r\n    scales: props.scales,\r\n    options: props.options\r\n  };\r\n\r\n\r\n  log.debug(\"OUTPUT\", \"chartData\", chartData);\r\n  return (\r\n    <Entity\r\n      className={`vria-view-${index}`}\r\n      position={position}\r\n      rotation={rotation}\r\n      width={width}\r\n      height={height}\r\n      depth={depth}>\r\n      {legends}\r\n      <Axes {...props} rangesMax={rangesMax} />\r\n      <AxisFilters {...props} rangesMax={rangesMax} />\r\n      <Marks {...markProps} />\r\n    </Entity>\r\n  );\r\n\r\n};\r\n\r\nView.propTypes = {\r\n  view: PropTypes.object.isRequired,\r\n  options: PropTypes.object.isRequired,\r\n  dataset: PropTypes.array.isRequired,\r\n  parsedDataset: PropTypes.array.isRequired,\r\n  scales: PropTypes.object.isRequired,\r\n  domainMap: PropTypes.object.isRequired\r\n};\r\n\r\nexport default View;\r\n","export { default as View } from './View';\r\nexport { default as Legend } from './Legend';\r\nexport { default as Axes } from './Axes';\r\nexport { default as AxisFilters } from './AxisFilters';\r\nexport { default as Marks } from './Marks';\r\n\r\nconst chartData = { key: \"chartData\" };\r\nexport { chartData };","import React from 'react';\r\nimport { Entity } from 'aframe-react';\r\n\r\n/* global AFRAME */\r\n\r\nconst Camera = (props) => {\r\n  // Desktop\r\n  const standardCamera = (\r\n    <Entity\r\n      primitive='a-camera'\r\n      wasd-controls-enabled\r\n      position='0 1.6 0'\r\n      capture-mouse\r\n      raycaster='objects: .interactive; far: 5'\r\n      cursor='rayOrigin: mouse'\r\n      super-hands={{\r\n        colliderEvent: 'raycaster-intersection',\r\n        colliderEventProperty: 'els',\r\n        colliderEndEvent: 'raycaster-intersection-cleared',\r\n        colliderEndEventProperty: 'clearedEls'\r\n      }}>\r\n      <Entity\r\n        primitive='a-plane'\r\n        id='tooltip'\r\n        className='tooltip'\r\n        visible='false'\r\n        position='0 -0.15 -0.4'\r\n        color='#333'\r\n        opacity='0.8'\r\n        width='auto'\r\n        height='auto'\r\n        text={{\r\n          value: 'Tooltip',\r\n          color: '#FFF',\r\n          xOffset: -0.18,\r\n          anchor: 'left',\r\n          align: 'left',\r\n          lineHeight: 50,\r\n          width: 0.4\r\n        }}\r\n      />\r\n    </Entity>\r\n  );\r\n\r\n  // VR\r\n  const vrCamera = (\r\n    <Entity\r\n      primitive='a-camera'\r\n      wasd-controls-enabled\r\n      position='0 1.6 0'\r\n      capture-mouse\r\n      raycaster='objects: .interactive; far: 5'\r\n      cursor='rayOrigin: mouse'\r\n      super-hands={{\r\n        colliderEvent: 'raycaster-intersection',\r\n        colliderEventProperty: 'els',\r\n        colliderEndEvent: 'raycaster-intersection-cleared',\r\n        colliderEndEventProperty: 'clearedEls'\r\n      }}\r\n    />\r\n  );\r\n\r\n  // Mobile camera\r\n  const mobileCamera = (\r\n    <Entity\r\n      primitive='a-camera'\r\n      wasd-controls-enabled\r\n      position='0 1.6 0'\r\n      capture-mouse>\r\n      <Entity\r\n        cursor={{\r\n          fuse: true,\r\n          fuseTimeout: 1250\r\n        }}\r\n        geometry={{\r\n          primitive: 'ring',\r\n          radiusInner: 0.01,\r\n          radiusOuter: 0.015\r\n        }}\r\n        material={{\r\n          color: props.options.baseColor,\r\n          shader: 'flat'\r\n        }}\r\n        fuse='true'\r\n        fuseTimeout='1250'\r\n        position='0 0 -0.6'\r\n        raycaster='objects: .interactive; far: 5;'\r\n        super-hands={{\r\n          colliderEvent: 'raycaster-intersection',\r\n          colliderEventProperty: 'els',\r\n          colliderEndEvent: 'raycaster-intersection-cleared',\r\n          colliderEndEventProperty: 'clearedEls'\r\n        }}\r\n        animation__fusing='property: scale; startEvents: fusing; easing: easeInCubic; dur: 1250; from: 1 1 1; to: 0.2 0.2 0.2'\r\n        animation__click='property: scale; startEvents: click; easing: easeInCubic; dur: 100; from: 0.2 0.2 0.2; to: 1 1 1'\r\n        animation__mouseleave='property: scale; startEvents: mouseleave; easing: easeInCubic; dur: 400; to: 1 1 1'\r\n      />\r\n      <Entity\r\n        primitive='a-plane'\r\n        id='tooltip'\r\n        className='tooltip tooltip-mobile'\r\n        visible='false'\r\n        position='0 -0.15 -0.4'\r\n        color='#333'\r\n        opacity='0.8'\r\n        width='auto'\r\n        height='auto'\r\n        scale='0.5 0.5 0.5'\r\n        text={{\r\n          value: 'Tooltip',\r\n          color: '#FFF',\r\n          xOffset: -0.18,\r\n          anchor: 'left',\r\n          align: 'left',\r\n          lineHeight: 50,\r\n          width: 0.4\r\n        }}\r\n      />\r\n    </Entity>\r\n  );\r\n\r\n  // Camera to use\r\n  let camera;\r\n\r\n  if (AFRAME.utils.device.isMobile()) {\r\n    camera = mobileCamera;\r\n  } else if (AFRAME.utils.device.checkHeadsetConnected()) {\r\n    camera = vrCamera;\r\n  } else {\r\n    camera = standardCamera;\r\n  }\r\n\r\n  return camera;\r\n};\r\n\r\nexport default React.memo(\r\n  Camera,\r\n  (prev, next) => prev.options.baseColor === next.options.baseColor\r\n);\r\n","import React, { Fragment } from 'react';\r\nimport { Entity } from 'aframe-react';\r\n\r\n/* global AFRAME */\r\n\r\nconst Controllers = ({ handedness }) => {\r\n  if (\r\n    AFRAME.utils.device.checkHeadsetConnected() &&\r\n    !AFRAME.utils.device.isMobile() &&\r\n    handedness !== 'none'\r\n  ) {\r\n    return (\r\n      <Fragment>\r\n        {handedness === 'both' || handedness === 'left' ? (\r\n          <Entity>\r\n            <Entity\r\n              laser-controls='hand: left;model: false'\r\n              className='controller controller-left'\r\n              raycaster='showLine: true; far: 2; objects: .interactive'\r\n              super-hands={{\r\n                colliderEvent: 'raycaster-intersection',\r\n                colliderEventProperty: 'els',\r\n                colliderEndEvent: 'raycaster-intersection-cleared',\r\n                colliderEndEventProperty: 'clearedEls'\r\n              }}>\r\n              <Entity\r\n                scale='0.5 0.5 0.5'\r\n                primitive='a-plane'\r\n                color='#333'\r\n                opacity='0.8'\r\n                width='auto'\r\n                height='auto'\r\n                text={{\r\n                  value: 'Tooltip',\r\n                  color: '#FFF',\r\n                  xOffset: -0.18,\r\n                  anchor: 'left',\r\n                  align: 'left',\r\n                  lineHeight: 50,\r\n                  width: 0.4\r\n                }}\r\n                className='tooltip tooltip-left'\r\n                id='tooltip'\r\n                visible='false'\r\n                position='0 0.05 -0.2'\r\n                rotation='-20 0 0'\r\n              />\r\n              <Entity\r\n                primitive='a-box'\r\n                width='0.01'\r\n                height='0.01'\r\n                depth='0.1'\r\n                color='#EF2D2D'\r\n              />\r\n            </Entity>\r\n          </Entity>\r\n        ) : null}\r\n        {handedness === 'both' || handedness === 'right' ? (\r\n          <Entity>\r\n            <Entity\r\n              laser-controls='hand: right; model: false'\r\n              className='controller controller-right'\r\n              raycaster='showLine: true; far: 2; objects: .interactive'\r\n              super-hands={{\r\n                colliderEvent: 'raycaster-intersection',\r\n                colliderEventProperty: 'els',\r\n                colliderEndEvent: 'raycaster-intersection-cleared',\r\n                colliderEndEventProperty: 'clearedEls'\r\n              }}>\r\n              <Entity\r\n                scale='0.5 0.5 0.5'\r\n                primitive='a-plane'\r\n                color='#333'\r\n                opacity='0.8'\r\n                width='auto'\r\n                height='auto'\r\n                text={{\r\n                  value: 'Tooltip',\r\n                  color: '#FFF',\r\n                  xOffset: -0.18,\r\n                  anchor: 'left',\r\n                  align: 'left',\r\n                  lineHeight: 50,\r\n                  width: 0.4\r\n                }}\r\n                className='tooltip tooltip-right'\r\n                id='tooltip'\r\n                visible='false'\r\n                position='0 0.05 -0.2'\r\n                rotation='-20 0 0'\r\n              />\r\n              <Entity\r\n                primitive='a-box'\r\n                width='0.01'\r\n                height='0.01'\r\n                depth='0.1'\r\n                color='#EF2D2D'\r\n              />\r\n            </Entity>\r\n          </Entity>\r\n        ) : null}\r\n      </Fragment>\r\n    );\r\n  } else {\r\n    return null;\r\n  }\r\n};\r\n\r\nexport default Controllers;\r\n","/* global AFRAME */\r\n\r\nconst setSceneAttributes = (el) => {\r\n  setTimeout(() => {\r\n    el.sceneEl.setAttribute('touch-to-click-converter');\r\n\r\n    const vrDisplayConnected = AFRAME.utils.device.checkHeadsetConnected();\r\n\r\n    if (!vrDisplayConnected) {\r\n      el.sceneEl.setAttribute('rayOrigin', 'mouse');\r\n    }\r\n  }, 0);\r\n};\r\n\r\nexport default setSceneAttributes;\r\n","import React, { useReducer, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { Entity } from 'aframe-react';\n\nimport './lib/super-hands/super-hands';\n\nimport { actionTypes } from './actions';\nimport { reducer, initialState, DispatchContext } from './reducer';\nimport { compileVisConfig } from './grammar';\nimport { log } from './utils';\n\nimport { View } from './components/core';\nimport { Camera, Controllers, setSceneAttributes } from './components/scene';\n\nimport { defaults } from './grammar/defaults';\n\n// Named exports\nexport { default as schema } from './grammar/schema';\nexport { default as validateVisConfig } from './grammar/validateVisConfig';\nexport { chartData } from './components/core/index';\n\n/**\n * @name VRIA\n * @description A Web-Based Framework for Creating Immersive Analytics Experiences\n */\nconst VRIA = ({\n  config,\n  options,\n  setSelection,\n  onSelection,\n  onConfigParsed,\n  setFilters,\n  onFilter,\n  additionalFilters,\n  customMarks,\n  ...rest\n}) => {\n  const [state, dispatch] = useReducer(reducer, {\n    ...initialState,\n    onConfigParsed,\n    onSelection,\n    onFilter,\n    additionalFilters,\n    options: {\n      ...defaults.options,\n      ...options\n    }\n  });\n\n  // Set options prop\n  useEffect(() => {\n    dispatch({ type: actionTypes.SET_OPTIONS, payload: options });\n  }, [options]);\n\n  // Set additional filters prop\n  useEffect(() => {\n    dispatch({\n      type: actionTypes.SET_ADDITIONAL_FILTERS,\n      payload: additionalFilters\n    });\n  }, [additionalFilters]);\n\n  // User defined selection prop (used for synchronising selections between clients)\n  useEffect(() => {\n    if (\n      setSelection !== undefined &&\n      setSelection !== null &&\n      typeof setSelection === 'object'\n    ) {\n      dispatch({ type: actionTypes.SET_SELECTION, payload: setSelection });\n    }\n  }, [setSelection]);\n\n  // User defined filter prop (used for synchronising filters between clients)\n  // Can also be used to set filters from custom interaction components\n  useEffect(() => {\n    if (\n      setFilters !== undefined &&\n      setFilters !== null &&\n      typeof setFilters === 'object'\n    ) {\n      dispatch({ type: actionTypes.SET_FILTERS, payload: setFilters });\n    }\n  }, [setFilters]);\n\n  // Selection of marks\n  useEffect(() => {\n    // Trigger selections callback\n    if (typeof state.onSelection === 'function') {\n      state.onSelection(state.selection);\n    }\n  }, [state.selection]);\n\n  // Filtering of marks\n  useEffect(() => {\n    // Trigger filters callback\n    if (typeof state.onFilter === 'function') {\n      state.onFilter(state.domainMap);\n    }\n  }, [state.domainMap]);\n\n  // CDM\n  useEffect(() => {\n    log.mode();\n  }, []);\n\n  // Compile vis-config\n  useEffect(() => {\n    try {\n      compileVisConfig(config, additionalFilters).then((res) => {\n        // Send compiled config back before transforming\n        if (typeof state.onConfigParsed === 'function') {\n          state.onConfigParsed(res);\n        }\n\n        // Add unique ID to processed dataset for VRIA to reference later\n        res.dataset = res.dataset.map((row, i) => {\n          row.vriaid = i;\n          return row;\n        });\n        // Store\n        dispatch({ type: actionTypes.VIS_CONFIG_COMPILED, payload: res });\n        log.debug('compiledConfig', res);\n      });\n    } catch (err) {\n      log.error(err);\n    }\n  }, [config]);\n\n  return (\n    <DispatchContext.Provider value={dispatch}>\n      <Entity {...rest}>\n        <Entity _ref={setSceneAttributes} />\n        <Camera options={state.options} />\n        <Controllers handedness={state.options.handedness} />\n        {state.filteredDataset\n          ? state.compiledConfig.views.map((view, i) => (\n              <Entity\n                key={`v${i}`}\n                position={rest.position}\n                rotation={rest.rotation}>\n                <View\n                  index={i}\n                  view={view}\n                  options={state.options}\n                  dataset={state.filteredDataset}\n                  parsedDataset={state.parsedDataset}\n                  scales={state.scales[i]}\n                  domainMap={state.domainMap}\n                  selection={state.selection}\n                  customMarks={customMarks}\n                />\n              </Entity>\n            ))\n          : null}\n      </Entity>\n    </DispatchContext.Provider>\n  );\n};\n\nVRIA.propTypes = {\n  config: PropTypes.object.isRequired,\n  options: PropTypes.object,\n  setSelection: PropTypes.object,\n  onSelection: PropTypes.func,\n  onConfigParsed: PropTypes.func,\n  setFilters: PropTypes.object,\n  onFilter: PropTypes.func,\n  additionalFilters: PropTypes.array,\n  customMarks: PropTypes.object\n};\n\nexport default React.memo(VRIA);\n"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","module","AFRAME","registerComponent","schema","colliderEvent","default","colliderEventProperty","colliderEndEvent","colliderEndEventProperty","grabStartButtons","grabEndButtons","stretchStartButtons","stretchEndButtons","dragDropStartButtons","dragDropEndButtons","interval","multiple","init","HOVER_EVENT","UNHOVER_EVENT","GRAB_EVENT","UNGRAB_EVENT","STRETCH_EVENT","UNSTRETCH_EVENT","DRAG_EVENT","UNDRAG_EVENT","DRAGOVER_EVENT","UNDRAGOVER_EVENT","DRAGDROP_EVENT","otherSuperHand","gehDragged","Set","gehClicking","hoverEls","hoverElsIntersections","prevCheckTime","state","Map","dragging","unHover","bind","unWatch","onHit","onGrabStartButton","onGrabEndButton","onStretchStartButton","onStretchEndButton","onDragDropStartButton","onDragDropEndButton","system","registerMe","update","oldData","unRegisterListeners","registerListeners","remove","unregisterMe","get","_unHover","tick","sorter","b","aDist","distance","bDist","time","data","orderChanged","sort","object","el","hover","evt","carried","dispatchMouseEventAll","findTarget","hand","buttonEvent","set","clickables","filter","h","has","grabbed","endEvt","dispatchMouseEvent","clear","emitCancelable","promoteHoveredEl","delete","stretched","dragged","forEach","ddEvt","dropped","on","dropTarget","processHitEl","hitEl","intersection","dist","sects","hitElIndex","indexOf","hoverNeedsUpdate","splice","push","size","detail","Array","isArray","sect","intersections","hvrevt","hoverEl","hovered","clearedEls","skipNextHover","unHovered","_unWatch","target","hoverIndex","addEventListener","Object","keys","removeEventListener","name","bubbles","cancelable","window","CustomEvent","dispatchEvent","relatedTarget","mEvt","MouseEvent","filterUsed","alsoReverse","els","evType","elIndex","eligibleEls","buttonCore","utils","extendDeep","onclick","type","CLICKED_STATE","CLICK_EVENT","UNCLICK_EVENT","clickers","start","end","defaultPrevented","startButtonOk","addState","preventDefault","handIndex","endButtonOk","removeState","inherit","console","warn","HOVERED_STATE","DRAGGED_STATE","hoverStart","dragStart","hoverEnd","dragEnd","dragDrop","dragStartBound","dragEndBound","elementMatches","selector","matches","msMatchesSelector","webkitMatchesSelector","accepts","autoUpdate","acceptEvent","rejectEvent","hoverStartBound","hoverEndBound","dragDropBound","mutateAcceptsBound","mutateAccepts","acceptableEntities","observer","MutationObserver","observerOpts","childList","subtree","prototype","slice","sceneEl","querySelectorAll","observe","disconnect","mutations","query","mutation","addedNodes","added","entityAcceptable","entity","item","emit","physicsCore","buttonsCore","base","maxGrabbers","NaN","invert","suppressX","suppressY","suppressZ","GRABBED_STATE","grabbers","constraints","deltaPositionIsValid","grabDistance","undefined","grabDirection","x","y","z","grabOffset","destPosition","deltaPosition","THREE","Vector3","targetPosition","physicsInit","lostGrabber","physicsUpdate","xFactor","yFactor","zFactor","q","Quaternion","v","entityPosition","grabber","copy","applyQuaternion","object3D","getWorldQuaternion","setLength","add","getWorldPosition","sub","getAttribute","setAttribute","physicsRemove","grabAvailable","Number","isFinite","physicsStart","resetGrabber","physicsEnd","objPos","grabPos","raycaster","distanceTo","direction","origin","physicsIsConstrained","hoverers","buttonIsValid","buttonList","startButtons","endButtons","usePhysics","physicsClear","body","newConId","Math","random","toString","substr","constraintId","removeAttribute","values","world","removeConstraint","physicsIsGrabbing","physicsUpdateRate","STRETCHED_STATE","stretchers","scale","handPos","otherHandPos","oldDat","updateBodies","throttleTick","_updateBodies","timeDelta","currentStretch","deltaStretch","previousStretch","pow","previousPhysicsStretch","multiplyScalar","includes","stretcherIndex","childNodes","stretchBody","physicsShape","offset","shapes","halfExtents","updateConvexPolyhedronRepresentation","radius","updateBoundingSphereRadius","shapeWarned","shapeOffsets","updateBoundingRadius","registerSystem","superHands","comp","index","applyFilters","dataset","domainMap","filteredDataset","marks","document","classList","row","filtersSatisfied","field","vriaid","visConfigCompiled","payload","compiledConfig","parsedDataset","initialDomainMap","cloneDeep","scales","debug","msg","rest","process","env","NODE_ENV","log","error","mode","filterData","value","bound","filteredDomain","newDomainMap","setCallbacks","appCallback","markSelected","selection","dataMap","setMarkData","selectedRow","id","options","multiSelect","next","key","selectColor","showTooltip","tooltip","cursor","tooltipHeight","tooltipContent","setSelection","clearSelection","hasOwnProperty","setFilters","setAdditionalFilters","additionalFilters","setOptions","coreActions","VIS_CONFIG_COMPILED","FILTER_DATA","SET_CALLBACKS","MARK_SELECTED","SET_SELECTION","SET_FILTERS","SET_ADDITIONAL_FILTERS","SET_OPTIONS","reducer","actionTypes","actions","DispatchContext","React","createContext","_moment","moment","parseDataset","config","views","uniqueFields","encodingMap","view","encoding","channel","SUPPORTED_FILE_TYPES","FILE_TYPE","url","split","pop","toLowerCase","transformedDataset","d3","_transformRow","err","then","d","map","Promise","resolve","parseFloat","replace","timeUnit","dfTimeUnit","defaults","timeUnits","year","quarter","month","date","week","day","dayofyear","hours","minutes","seconds","milliseconds","Date","format","validateVisConfig","ajv","Ajv","useDefaults","jsonPointers","validate","compile","valid","errorsText","errors","compileVisConfig","validated","title","allScales","markType","mark","markShape","shape","bar","point","markTooltip","ranges","_getRanges","range","scheme","color","nice","zero","paddingInner","paddingOuter","axis","titlePadding","face","orient","ticks","tickCount","labels","legend","gradient","symbol","xrotation","yrotation","zrotation","domains","_getDomains","_getScales","domain","domainsWithFields","channelFields","width","height","depth","rotation","interpolator","padding","GradientLegend","legendTitle","posrot","xpos","ypos","zpos","xrot","yrot","zrot","background","chartColor","minValue","numberFormat","min","maxValue","max","label","SymbolLegend","customMarks","dispatch","useContext","legendWidth","legendHeight","legendYPos","opacity","isChecked","topOffset","step","checked","checkbox","mouseenter","mouseleave","click","Legend","props","rangesMax","xoffsetLeft","xoffsetRight","propTypes","PropTypes","isRequired","array","memo","prev","Axis","AxisLine","position","tickText","string","XAxis","tickOffset","tickValues","axisTicks","axisTicksData","line","scaleTick","scaleX","axisTickText","side","anchor","align","axisTickTextData","text","axisTitle","axisTitleData","showLabels","showTicks","axisData","ticksData","titleData","tickTextData","chartData","YAxis","ZAxis","Axes","generateTitle","title_data","generateAxes","axes","axis_data","bandwidth","xFace","yFace","zFace","AxisFilters","faces","XFilter","YFilter","ZFilter","mutualProps","Marks","marks_data","lineHeight","content","fields","markEvents","cursorEl","parentEl","querySelector","attributes","xoffset","yoffset","zoffset","shapeScaleMark","JSON","stringify","className","fTypes","quantField","xPos","yPos","zPos","prevProps","nextProps","isEqual","View","userHeight","legends","markProps","Camera","standardCamera","xOffset","vrCamera","mobileCamera","fuse","fuseTimeout","primitive","radiusInner","radiusOuter","baseColor","shader","camera","device","isMobile","checkHeadsetConnected","Controllers","handedness","setSceneAttributes","setTimeout","vrDisplayConnected","VRIA","onSelection","onConfigParsed","onFilter","useReducer","initialState","useEffect","res","func"],"mappings":"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"}